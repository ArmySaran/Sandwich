<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ü•™ ‡∏£‡πâ‡∏≤‡∏ô Sandwich ‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏° - ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏ã‡∏ô‡∏î‡πå‡∏ß‡∏¥‡∏ä</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Supabase client library -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <style>
        /* Modern Design System Variables */
        :root {
            /* Color Palette - Modern Gradient System */
            --primary-50: #f0f8ff;
            --primary-100: #e1f0fe;
            --primary-200: #bae1fc;
            --primary-300: #7cc8f9;
            --primary-400: #36abf3;
            --primary-500: #0c8ce9;
            --primary-600: #0070c7;
            --primary-700: #0159a2;
            --primary-800: #064c86;
            --primary-900: #0a406f;

            /* Secondary Colors - Warm Accent */
            --secondary-50: #fff7ed;
            --secondary-100: #ffedd5;
            --secondary-200: #fed7aa;
            --secondary-300: #fdba74;
            --secondary-400: #fb923c;
            --secondary-500: #f97316;
            --secondary-600: #ea580c;
            --secondary-700: #c2410c;
            --secondary-800: #9a3412;
            --secondary-900: #7c2d12;

            /* Neutral Colors - Sophisticated Grays */
            --gray-50: #f8fafc;
            --gray-100: #f1f5f9;
            --gray-200: #e2e8f0;
            --gray-300: #cbd5e1;
            --gray-400: #94a3b8;
            --gray-500: #64748b;
            --gray-600: #475569;
            --gray-700: #334155;
            --gray-800: #1e293b;
            --gray-900: #0f172a;

            /* Status Colors */
            --success-50: #f0fdf4;
            --success-500: #22c55e;
            --success-600: #16a34a;
            --warning-50: #fffbeb;
            --warning-500: #f59e0b;
            --warning-600: #d97706;
            --error-50: #fef2f2;
            --error-500: #ef4444;
            --error-600: #dc2626;

            /* Semantic Color Mapping */
            --background: var(--gray-50);
            --surface: #ffffff;
            --surface-elevated: #ffffff;
            --surface-glass: rgba(255, 255, 255, 0.8);
            --surface-overlay: rgba(15, 23, 42, 0.8);

            --text-primary: var(--gray-900);
            --text-secondary: var(--gray-600);
            --text-tertiary: var(--gray-400);
            --text-inverse: #ffffff;

            --border-subtle: var(--gray-200);
            --border-default: var(--gray-300);
            --border-strong: var(--gray-400);

            --primary: var(--primary-500);
            --primary-hover: var(--primary-600);
            --primary-active: var(--primary-700);
            --primary-subtle: var(--primary-50);

            --secondary: var(--secondary-500);
            --secondary-hover: var(--secondary-600);

            /* Typography Scale - Improved */
            --text-xs: 0.75rem;      /* 12px */
            --text-sm: 0.875rem;     /* 14px */
            --text-base: 1rem;       /* 16px */
            --text-lg: 1.125rem;     /* 18px */
            --text-xl: 1.25rem;      /* 20px */
            --text-2xl: 1.5rem;      /* 24px */
            --text-3xl: 1.875rem;    /* 30px */
            --text-4xl: 2.25rem;     /* 36px */
            --text-5xl: 3rem;        /* 48px */

            /* Font Weights */
            --font-light: 300;
            --font-normal: 400;
            --font-medium: 500;
            --font-semibold: 600;
            --font-bold: 700;
            --font-extrabold: 800;

            /* Spacing System (Refined 4px grid) */
            --space-0: 0;
            --space-1: 0.25rem;      /* 4px */
            --space-2: 0.5rem;       /* 8px */
            --space-3: 0.75rem;      /* 12px */
            --space-4: 1rem;         /* 16px */
            --space-5: 1.25rem;      /* 20px */
            --space-6: 1.5rem;       /* 24px */
            --space-7: 1.75rem;      /* 28px */
            --space-8: 2rem;         /* 32px */
            --space-9: 2.25rem;      /* 36px */
            --space-10: 2.5rem;      /* 40px */
            --space-12: 3rem;        /* 48px */
            --space-14: 3.5rem;      /* 56px */
            --space-16: 4rem;        /* 64px */
            --space-20: 5rem;        /* 80px */

            /* Border Radius - Modern Scale */
            --radius-none: 0;
            --radius-sm: 0.25rem;    /* 4px */
            --radius-base: 0.375rem; /* 6px */
            --radius-md: 0.5rem;     /* 8px */
            --radius-lg: 0.75rem;    /* 12px */
            --radius-xl: 1rem;       /* 16px */
            --radius-2xl: 1.5rem;    /* 24px */
            --radius-full: 9999px;

            /* Shadows - Refined */
            --shadow-xs: 0 1px 2px 0 rgba(15, 23, 42, 0.04);
            --shadow-sm: 0 1px 3px 0 rgba(15, 23, 42, 0.1), 0 1px 2px 0 rgba(15, 23, 42, 0.06);
            --shadow-md: 0 4px 6px -1px rgba(15, 23, 42, 0.1), 0 2px 4px -1px rgba(15, 23, 42, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(15, 23, 42, 0.1), 0 4px 6px -2px rgba(15, 23, 42, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(15, 23, 42, 0.1), 0 10px 10px -5px rgba(15, 23, 42, 0.04);
            --shadow-2xl: 0 25px 50px -12px rgba(15, 23, 42, 0.25);
            --shadow-glow: 0 0 20px rgba(12, 140, 233, 0.3);
            --shadow-colored: 0 8px 25px -8px rgba(12, 140, 233, 0.3);

            /* Gradients */
            --gradient-primary: linear-gradient(135deg, var(--primary-500), var(--primary-600));
            --gradient-secondary: linear-gradient(135deg, var(--secondary-500), var(--secondary-600));
            --gradient-surface: linear-gradient(145deg, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.7));
            --gradient-glass: linear-gradient(145deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));

            /* Animation & Transitions */
            --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-base: 200ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 300ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-bounce: 500ms cubic-bezier(0.68, -0.55, 0.265, 1.55);

            /* Touch Targets & Interactions - Mobile First */
            --touch-target-min: 44px;
            --touch-target-comfortable: 56px;
            --touch-target-large: 64px;

            /* Mobile-First Spacing System */
            --space-mobile-xs: 4px;
            --space-mobile-sm: 8px;
            --space-mobile-md: 12px;
            --space-mobile-lg: 16px;
            --space-mobile-xl: 20px;
            --space-mobile-2xl: 24px;
            --space-mobile-3xl: 32px;

            /* Mobile Typography Scale */
            --text-mobile-xs: 12px;
            --text-mobile-sm: 14px;
            --text-mobile-base: 16px;
            --text-mobile-lg: 18px;
            --text-mobile-xl: 20px;
            --text-mobile-2xl: 24px;
            --text-mobile-3xl: 30px;

            /* Mobile Layout Breakpoints */
            --mobile-sm: 360px;
            --mobile-md: 390px;
            --mobile-lg: 430px;
            --tablet: 768px;
            --desktop: 1024px;
        }

        /* Modern Reset & Base Styles */
        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            height: 100%;
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            background: var(--background);
            min-height: 100vh;
            min-height: 100dvh; /* Dynamic viewport height for mobile */
            color: var(--text-primary);
            line-height: 1.6;
            font-size: var(--text-mobile-base);
            font-weight: var(--font-normal);
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
            /* Mobile optimizations */
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        /* Modern background with geometric pattern */
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background:
                radial-gradient(circle at 20% 80%, rgba(12, 140, 233, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(249, 115, 22, 0.06) 0%, transparent 50%),
                linear-gradient(135deg, var(--gray-50) 0%, rgba(248, 250, 252, 0.8) 100%);
            pointer-events: none;
            z-index: -1;
        }

        /* Modern scrollbar styling */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: var(--gray-100);
            border-radius: var(--radius-full);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--gray-300);
            border-radius: var(--radius-full);
            transition: var(--transition-base);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--gray-400);
        }

        /* Focus styles */
        :focus {
            outline: 2px solid var(--primary-500);
            outline-offset: 2px;
        }

        :focus:not(:focus-visible) {
            outline: none;
        }

        /* Selection styles */
        ::selection {
            background: var(--primary-200);
            color: var(--primary-800);
        }

        /* Layout Components */
        .app-container {
            max-width: 100vw;
            min-height: 100vh;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        /* Typography Utilities */
        .text-xs { font-size: var(--text-xs); }
        .text-sm { font-size: var(--text-sm); }
        .text-base { font-size: var(--text-base); }
        .text-lg { font-size: var(--text-lg); }
        .text-xl { font-size: var(--text-xl); }
        .text-2xl { font-size: var(--text-2xl); }
        .text-3xl { font-size: var(--text-3xl); }

        .font-normal { font-weight: var(--font-normal); }
        .font-medium { font-weight: var(--font-medium); }
        .font-semibold { font-weight: var(--font-semibold); }
        .font-bold { font-weight: var(--font-bold); }
        .font-extrabold { font-weight: var(--font-extrabold); }

        .text-primary { color: var(--text-primary); }
        .text-secondary { color: var(--text-secondary); }
        .text-tertiary { color: var(--text-tertiary); }

        /* Mobile-First Header Design */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: var(--surface-elevated);
            backdrop-filter: blur(20px);
            padding: var(--space-mobile-md) var(--space-mobile-lg);
            z-index: 1000;
            border-bottom: 1px solid var(--border-light);
            box-shadow: var(--shadow-sm);
            min-height: var(--touch-target-comfortable);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 100%;
        }

        .header-title {
            font-size: var(--text-mobile-lg);
            font-weight: var(--font-bold);
            color: var(--text-primary);
            margin: 0;
            display: flex;
            align-items: center;
            gap: var(--space-mobile-sm);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: calc(100vw - 100px);
        }

        .header-actions {
            display: flex;
            gap: var(--space-mobile-xs);
            align-items: center;
        }

        /* Desktop header adjustments */
        @media (min-width: 430px) {
            .header {
                padding: var(--space-3) var(--space-4);
                min-height: 60px;
            }

            .header-title {
                font-size: var(--text-lg);
                gap: var(--space-2);
                max-width: calc(100vw - 120px);
            }

            .header-actions {
                gap: var(--space-2);
            }
        }

        /* Professional Button System */
        .btn {
            /* Base button styles */
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-2);
            padding: var(--space-3) var(--space-4);
            border: none;
            border-radius: var(--radius-lg);
            font-family: inherit;
            font-weight: var(--font-medium);
            font-size: var(--text-sm);
            line-height: 1;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            min-height: var(--touch-target-min);
            position: relative;
            outline: none;
            user-select: none;
            -webkit-user-select: none;
        }

        .btn:focus-visible {
            outline: 2px solid var(--primary-500);
            outline-offset: 2px;
        }

        /* Button Variants */
        .btn-primary {
            background: var(--gradient-primary);
            color: var(--text-inverse);
            box-shadow: var(--shadow-md);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, var(--primary-600), var(--primary-500));
            box-shadow: var(--shadow-lg);
            transform: translateY(-1px);
        }

        .btn-primary:active {
            transform: translateY(0);
            box-shadow: var(--shadow-sm);
        }

        .btn-secondary {
            background: var(--surface-elevated);
            color: var(--primary-500);
            border: 1px solid var(--border-medium);
            box-shadow: var(--shadow-sm);
        }

        .btn-secondary:hover {
            background: var(--primary-50);
            border-color: var(--primary-500);
            box-shadow: var(--shadow-md);
            transform: translateY(-1px);
        }

        .btn-ghost {
            background: transparent;
            color: var(--text-secondary);
            border: 1px solid transparent;
        }

        .btn-ghost:hover {
            background: var(--primary-50);
            color: var(--primary-600);
        }

        /* Mobile-First Button Sizes */
        .btn-sm {
            padding: var(--space-mobile-md) var(--space-mobile-lg);
            font-size: var(--text-mobile-sm);
            min-height: var(--touch-target-min);
        }

        .btn-md {
            padding: var(--space-mobile-lg) var(--space-mobile-xl);
            font-size: var(--text-mobile-base);
            min-height: var(--touch-target-comfortable);
        }

        .btn-lg {
            padding: var(--space-mobile-xl) var(--space-mobile-2xl);
            font-size: var(--text-mobile-lg);
            min-height: var(--touch-target-large);
        }

        /* Mobile-Optimized Icon Buttons */
        .btn-icon {
            padding: var(--space-mobile-lg);
            aspect-ratio: 1;
            min-width: var(--touch-target-comfortable);
            min-height: var(--touch-target-comfortable);
        }

        .btn-icon-sm {
            padding: var(--space-mobile-md);
            min-width: var(--touch-target-min);
            min-height: var(--touch-target-min);
            font-size: var(--text-mobile-base);
        }

        /* Desktop button adjustments */
        @media (min-width: 768px) {
            .btn-sm {
                padding: var(--space-2) var(--space-3);
                font-size: var(--text-xs);
                min-height: 36px;
            }

            .btn-md {
                padding: var(--space-3) var(--space-4);
                font-size: var(--text-sm);
            }

            .btn-lg {
                padding: var(--space-4) var(--space-6);
                font-size: var(--text-base);
            }

            .btn-icon {
                padding: var(--space-3);
                min-width: var(--touch-target-min);
                min-height: var(--touch-target-min);
            }

            .btn-icon-sm {
                padding: var(--space-2);
                min-width: 36px;
                font-size: var(--text-sm);
            }
        }

        /* Mobile Touch Enhancements */
        .btn {
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }

        .btn:active {
            transform: scale(0.98);
        }

        @media (hover: hover) {
            .btn:active {
                transform: translateY(0) scale(0.98);
            }
        }

        /* Button States */
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            pointer-events: none;
        }

        .btn-loading {
            color: transparent;
        }

        .btn-loading::after {
            content: "";
            position: absolute;
            width: 16px;
            height: 16px;
            border: 2px solid currentColor;
            border-radius: 50%;
            border-top-color: transparent;
            animation: button-loading 0.8s linear infinite;
        }

        @keyframes button-loading {
            to { transform: rotate(360deg); }
        }

        /* Professional Card System */
        .card {
            background: var(--surface-elevated);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-xl);
            padding: var(--space-6);
            box-shadow: var(--shadow-sm);
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
            border-color: var(--border-medium);
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-4);
        }

        .card-title {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin: 0;
        }

        .card-subtitle {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            margin: 0;
        }

        .card-content {
            color: var(--text-primary);
        }

        .card-footer {
            margin-top: var(--space-4);
            padding-top: var(--space-4);
            border-top: 1px solid var(--border-light);
        }

        /* Stat Cards */
        .stat-card {
            background: linear-gradient(135deg, var(--surface-elevated), var(--surface-secondary));
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-xl);
            padding: var(--space-5);
            position: relative;
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .stat-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(135deg, var(--primary-purple), var(--primary-purple-light));
            border-radius: var(--radius-xl) var(--radius-xl) 0 0;
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
            border-color: var(--border-medium);
        }

        .stat-card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-3);
        }

        .stat-card-icon {
            width: 40px;
            height: 40px;
            background: var(--secondary-purple);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--text-lg);
        }

        .stat-card-value {
            font-size: var(--text-2xl);
            font-weight: var(--font-bold);
            color: var(--text-primary);
            margin: 0;
            line-height: 1.2;
        }

        .stat-card-label {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            margin: 0;
            font-weight: var(--font-medium);
        }

        .stat-card-change {
            font-size: var(--text-xs);
            font-weight: var(--font-medium);
            padding: var(--space-1) var(--space-2);
            border-radius: var(--radius-sm);
            display: inline-flex;
            align-items: center;
            gap: var(--space-1);
            margin-top: var(--space-2);
        }

        .stat-card-change.positive {
            background: rgba(16, 185, 129, 0.1);
            color: var(--accent-green);
        }

        .stat-card-change.negative {
            background: rgba(239, 68, 68, 0.1);
            color: var(--accent-red);
        }

        /* Mobile-First Layout & Spacing */
        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 0 var(--space-mobile-lg);
            width: 100%;
        }

        /* Mobile container adjustments */
        @media (min-width: 430px) {
            .container {
                padding: 0 var(--space-5);
            }
        }

        @media (min-width: 768px) {
            .container {
                padding: 0 var(--space-6);
                max-width: 1200px;
            }
        }

        @media (min-width: 1024px) {
            .container {
                padding: 0 var(--space-8);
            }
        }

        .flex {
            display: flex;
        }

        .flex-col {
            flex-direction: column;
        }

        .items-center {
            align-items: center;
        }

        .justify-center {
            justify-content: center;
        }

        .justify-between {
            justify-content: space-between;
        }

        .gap-2 { gap: var(--space-2); }
        .gap-3 { gap: var(--space-3); }
        .gap-4 { gap: var(--space-4); }
        .gap-6 { gap: var(--space-6); }

        .p-2 { padding: var(--space-2); }
        .p-3 { padding: var(--space-3); }
        .p-4 { padding: var(--space-4); }
        .p-6 { padding: var(--space-6); }

        .mt-2 { margin-top: var(--space-2); }
        .mt-4 { margin-top: var(--space-4); }
        .mb-4 { margin-bottom: var(--space-4); }
        .mb-6 { margin-bottom: var(--space-6); }

        /* Grid System */
        .grid {
            display: grid;
        }

        .grid-cols-1 {
            grid-template-columns: repeat(1, 1fr);
        }

        .grid-cols-2 {
            grid-template-columns: repeat(2, 1fr);
        }

        .grid-cols-3 {
            grid-template-columns: repeat(3, 1fr);
        }

        .grid-cols-4 {
            grid-template-columns: repeat(4, 1fr);
        }

        /* Mobile-First Main Content Layout */
        .main-content {
            flex: 1;
            padding-top: calc(var(--touch-target-comfortable) + var(--space-mobile-md)); /* Mobile header height + spacing */
            padding-bottom: calc(var(--touch-target-large) + var(--space-mobile-lg)); /* Mobile bottom nav + spacing */
            min-height: calc(100dvh - 140px);
        }

        @media (min-width: 430px) {
            .main-content {
                padding-top: 76px; /* Header height + spacing */
                padding-bottom: 80px; /* Bottom nav height + spacing */
                min-height: calc(100vh - 156px);
            }
        }

        .screen {
            display: none;
            padding: var(--space-mobile-lg);
            max-width: 100%;
            margin: 0 auto;
        }

        @media (min-width: 430px) {
            .screen {
                padding: var(--space-4);
            }
        }

        @media (min-width: 768px) {
            .screen {
                padding: var(--space-6);
            }
        }

        .screen.active {
            display: block;
        }

        /* Mobile-First Typography */
        .section-title {
            font-size: var(--text-mobile-xl);
            font-weight: var(--font-bold);
            color: var(--text-primary);
            margin: 0 0 var(--space-mobile-xl) 0;
            line-height: 1.3;
        }

        @media (min-width: 430px) {
            .section-title {
                font-size: var(--text-xl);
                margin: 0 0 var(--space-6) 0;
                line-height: 1.4;
            }
        }

        /* Professional Form Components */
        .form-group {
            margin-bottom: var(--space-4);
            position: relative;
        }

        .form-label {
            display: block;
            font-size: var(--text-mobile-sm);
            font-weight: var(--font-medium);
            color: var(--text-primary);
            margin-bottom: var(--space-mobile-sm);
            transition: all 0.2s ease;
            line-height: 1.4;
        }

        @media (min-width: 430px) {
            .form-label {
                font-size: var(--text-sm);
                margin-bottom: var(--space-2);
            }
        }

        /* Mobile-First Form Components */
        .form-input {
            width: 100%;
            padding: var(--space-mobile-lg) var(--space-mobile-xl);
            border: 1px solid var(--border-medium);
            border-radius: var(--radius-lg);
            font-size: var(--text-mobile-base);
            line-height: 1.5;
            background: var(--surface-primary);
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            min-height: var(--touch-target-comfortable);
            touch-action: manipulation;
            -webkit-appearance: none;
            appearance: none;
        }

        @media (min-width: 430px) {
            .form-input {
                padding: var(--space-3) var(--space-4);
                font-size: var(--text-base);
                min-height: var(--touch-target-min);
            }
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-500);
            box-shadow: 0 0 0 3px var(--primary-100);
            transform: translateY(-1px);
        }

        .form-input:hover {
            border-color: var(--border-strong);
        }

        .form-input::placeholder {
            color: var(--text-tertiary);
        }

        .form-select {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%23475569' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
            background-position: right var(--space-3) center;
            background-repeat: no-repeat;
            background-size: 16px;
            padding-right: var(--space-10);
            appearance: none;
        }

        .form-select:focus {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%233b82f6' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
        }

        /* Mobile-Optimized Floating Labels */
        .form-floating {
            position: relative;
        }

        .form-floating .form-input {
            padding: var(--space-mobile-2xl) var(--space-mobile-xl) var(--space-mobile-lg) var(--space-mobile-xl);
        }

        .form-floating .form-label {
            position: absolute;
            top: 50%;
            left: var(--space-mobile-xl);
            transform: translateY(-50%);
            font-size: var(--text-mobile-base);
            color: var(--text-tertiary);
            pointer-events: none;
            transition: all 0.2s ease;
            margin-bottom: 0;
        }

        .form-floating .form-input:focus + .form-label,
        .form-floating .form-input:not(:placeholder-shown) + .form-label {
            top: var(--space-mobile-lg);
            font-size: var(--text-mobile-xs);
            font-weight: var(--font-medium);
            color: var(--primary-500);
            transform: translateY(0);
        }

        /* Desktop floating label adjustments */
        @media (min-width: 430px) {
            .form-floating .form-input {
                padding: var(--space-4) var(--space-4) var(--space-3) var(--space-4);
            }

            .form-floating .form-label {
                left: var(--space-4);
                font-size: var(--text-base);
            }

            .form-floating .form-input:focus + .form-label,
            .form-floating .form-input:not(:placeholder-shown) + .form-label {
                top: var(--space-3);
                font-size: var(--text-xs);
            }
        }

        .form-error {
            color: var(--accent-red);
            font-size: var(--text-sm);
            margin-top: var(--space-2);
            display: flex;
            align-items: center;
            gap: var(--space-1);
        }

        .form-help {
            color: var(--text-secondary);
            font-size: var(--text-sm);
            margin-top: var(--space-2);
        }

        /* Input Variants */
        .form-input-success {
            border-color: var(--accent-green);
            box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.1);
        }

        .form-input-error {
            border-color: var(--accent-red);
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
        }

        /* Professional Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--surface-elevated);
            backdrop-filter: blur(20px);
            border-top: 1px solid var(--border-light);
            padding: var(--space-2) var(--space-4) env(safe-area-inset-bottom);
            z-index: 1000;
            box-shadow: var(--shadow-lg);
        }

        /* Modern Navigation - Floating Tab Bar */
        .nav-items {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-3);
            background: var(--surface);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-2xl);
            box-shadow: var(--shadow-lg);
            backdrop-filter: blur(20px);
            max-width: fit-content;
            margin: 0 auto;
        }

        .nav-item {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-1);
            padding: var(--space-3) var(--space-4);
            border-radius: var(--radius-xl);
            transition: all var(--transition-base);
            min-width: 68px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: var(--text-xs);
            font-weight: var(--font-medium);
            background: transparent;
            border: none;
            cursor: pointer;
        }

        .nav-item:hover {
            color: var(--primary-600);
            background: var(--primary-50);
            transform: translateY(-1px);
        }

        .nav-item.active {
            color: var(--surface);
            background: var(--gradient-primary);
            box-shadow: var(--shadow-colored);
            transform: translateY(-2px);
        }

        .nav-item.active::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: var(--gradient-primary);
            border-radius: var(--radius-xl);
            opacity: 0.3;
            z-index: -1;
            animation: pulse-glow 2s ease-in-out infinite;
        }

        @keyframes pulse-glow {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.05); }
        }

        .nav-icon {
            width: 22px;
            height: 22px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: var(--transition-base);
            /* Ensure emoji display */
            font-family: 'Apple Color Emoji', 'Segoe UI Emoji', 'Noto Color Emoji', 'Segoe UI Symbol', 'Android Emoji', 'EmojiSymbols', emoji;
        }

        /* Fallback CSS icons if emojis fail */
        .nav-icon {
            position: relative;
        }

        /* Dashboard icon fallback */
        .nav-item:nth-child(1) .nav-icon:empty::before {
            content: "‚åÇ";
            font-size: 18px;
            line-height: 1;
        }

        /* POS icon fallback */
        .nav-item:nth-child(2) .nav-icon:empty::before {
            content: "‚óã";
            font-size: 18px;
            line-height: 1;
        }

        /* Inventory icon fallback */
        .nav-item:nth-child(3) .nav-icon:empty::before {
            content: "‚ñ°";
            font-size: 18px;
            line-height: 1;
        }

        /* Reports icon fallback */
        .nav-item:nth-child(4) .nav-icon:empty::before {
            content: "‚â°";
            font-size: 18px;
            line-height: 1;
        }

        /* Settings icon fallback */
        .nav-item:nth-child(5) .nav-icon:empty::before {
            content: "‚öô";
            font-size: 18px;
            line-height: 1;
        }

        .nav-item.active .nav-icon {
            transform: scale(1.1);
        }

        .nav-label {
            font-size: var(--text-xs);
            line-height: 1;
            font-weight: var(--font-medium);
            letter-spacing: 0.025em;
        }

        /* Mobile-First Navigation Optimizations */
        @media (max-width: 430px) {
            .bottom-nav {
                padding: var(--space-mobile-sm) var(--space-mobile-md) env(safe-area-inset-bottom);
            }

            .nav-items {
                gap: var(--space-mobile-xs);
                padding: var(--space-mobile-sm);
                width: 100%;
                max-width: none;
                justify-content: space-around;
            }

            .nav-item {
                min-width: var(--touch-target-comfortable);
                padding: var(--space-mobile-md) var(--space-mobile-sm);
                min-height: var(--touch-target-comfortable);
            }

            .nav-icon {
                width: 24px;
                height: 24px;
                font-size: var(--text-mobile-lg);
            }

            .nav-label {
                font-size: var(--text-mobile-xs);
                line-height: 1.2;
            }
        }

        /* Tablet navigation adjustments */
        @media (min-width: 431px) and (max-width: 768px) {
            .nav-items {
                gap: var(--space-3);
                padding: var(--space-3);
            }

            .nav-item {
                min-width: 70px;
                padding: var(--space-3) var(--space-4);
            }

            .nav-icon {
                width: 22px;
                height: 22px;
                font-size: 16px;
            }
        }

        /* Mobile-First POS Interface */
        .pos-layout {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--space-mobile-lg);
            min-height: calc(100dvh - 160px);
            padding: var(--space-mobile-lg);
        }

        @media (min-width: 430px) {
            .pos-layout {
                gap: var(--space-5);
                padding: var(--space-5);
                min-height: calc(100vh - 170px);
            }
        }

        @media (min-width: 768px) {
            .pos-layout {
                grid-template-columns: 1fr 400px;
                gap: var(--space-6);
                padding: var(--space-6);
                min-height: calc(100vh - 180px);
            }
        }

        @media (min-width: 1024px) {
            .pos-layout {
                grid-template-columns: 1fr 420px;
                gap: var(--space-8);
                padding: var(--space-8);
            }
        }

        /* Mobile-First Menu Grid */
        .menu-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--space-mobile-lg);
            padding: var(--space-mobile-md);
            max-height: calc(100dvh - 200px);
            overflow-y: auto;
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
        }

        @media (min-width: 430px) {
            .menu-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                gap: var(--space-4);
                padding: var(--space-4);
            }
        }

        @media (min-width: 600px) {
            .menu-grid {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
                gap: var(--space-5);
            }
        }

        @media (min-width: 768px) {
            .menu-grid {
                gap: var(--space-6);
                max-height: calc(100vh - 220px);
            }
        }

        /* Mobile-Optimized Menu Items */
        .menu-item {
            background: var(--surface);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-xl);
            padding: var(--space-mobile-lg);
            transition: all var(--transition-base);
            box-shadow: var(--shadow-sm);
            position: relative;
            overflow: hidden;
            cursor: pointer;
            min-height: var(--touch-target-large);
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }

        .menu-item:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
            border-color: var(--primary-300);
        }

        .menu-item:active {
            transform: translateY(0);
            box-shadow: var(--shadow-sm);
        }

        @media (min-width: 430px) {
            .menu-item {
                padding: var(--space-5);
            }

            .menu-item:hover {
                transform: translateY(-2px);
                border-color: var(--primary-500);
            }
        }

        @media (min-width: 768px) {
            .menu-item {
                padding: var(--space-6);
            }
        }

        .menu-item-image {
            width: 100%;
            height: 120px;
            background: var(--secondary-purple);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin-bottom: var(--space-3);
        }

        .menu-item-name {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin-bottom: var(--space-2);
        }

        .menu-item-price {
            font-size: var(--text-xl);
            font-weight: var(--font-bold);
            color: var(--primary-purple);
        }

        .cart-panel {
            background: var(--surface-elevated);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-xl);
            padding: var(--space-6);
            height: fit-content;
            max-height: calc(100vh - 200px);
            overflow-y: auto;
            position: sticky;
            top: var(--space-4);
        }

        .cart-item {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-3);
            border-bottom: 1px solid var(--border-light);
        }

        .cart-item:last-child {
            border-bottom: none;
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-name {
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--text-primary);
            margin-bottom: var(--space-1);
        }

        .cart-item-price {
            font-size: var(--text-sm);
            color: var(--text-secondary);
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .quantity-btn {
            width: 32px;
            height: 32px;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border-medium);
            background: var(--surface-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .quantity-btn:hover {
            border-color: var(--primary-purple);
            background: var(--secondary-purple);
        }

        .checkout-section {
            margin-top: var(--space-6);
            padding-top: var(--space-6);
            border-top: 1px solid var(--border-light);
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-4);
        }

        .total-label {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
        }

        .total-amount {
            font-size: var(--text-xl);
            font-weight: var(--font-bold);
            color: var(--primary-purple);
        }

        /* Enhanced Dashboard Styles */
        /* Modern Dashboard Layout */
        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--space-6);
            margin-bottom: var(--space-8);
        }

        .dashboard-card {
            position: relative;
            background: var(--surface);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-2xl);
            padding: var(--space-8);
            transition: all var(--transition-base);
            box-shadow: var(--shadow-sm);
            backdrop-filter: blur(10px);
            overflow: hidden;
        }

        .dashboard-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
            border-radius: var(--radius-2xl) var(--radius-2xl) 0 0;
        }

        .dashboard-card::after {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, var(--primary-100) 0%, transparent 70%);
            opacity: 0;
            transition: var(--transition-slow);
            pointer-events: none;
        }

        .dashboard-card:hover {
            transform: translateY(-6px);
            box-shadow: var(--shadow-xl);
            border-color: var(--border-default);
        }

        .dashboard-card:hover::after {
            opacity: 0.3;
        }

        .dashboard-card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-4);
        }

        .dashboard-card h3 {
            font-size: var(--text-mobile-xs);
            font-weight: var(--font-semibold);
            color: var(--text-secondary);
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            line-height: 1.2;
        }

        .dashboard-card-icon {
            width: 36px;
            height: 36px;
            background: var(--gradient-primary);
            border-radius: var(--radius-xl);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: var(--text-mobile-base);
            box-shadow: var(--shadow-colored);
        }

        .dashboard-card .value {
            font-size: var(--text-mobile-3xl);
            font-weight: var(--font-bold);
            color: var(--text-primary);
            margin: var(--space-mobile-md) 0;
            line-height: 1.1;
        }

        /* Desktop dashboard adjustments */
        @media (min-width: 430px) {
            .dashboard-card h3 {
                font-size: var(--text-sm);
            }

            .dashboard-card-icon {
                width: 40px;
                height: 40px;
                font-size: 18px;
            }

            .dashboard-card .value {
                font-size: var(--text-4xl);
                margin: var(--space-3) 0;
                line-height: 1;
            }
        }

        .dashboard-card-footer {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: var(--space-4);
        }

        .dashboard-card .change {
            font-size: var(--text-sm);
            font-weight: var(--font-semibold);
            padding: var(--space-2) var(--space-3);
            border-radius: var(--radius-full);
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
            backdrop-filter: blur(10px);
        }

        .dashboard-card .change.positive {
            background: rgba(34, 197, 94, 0.15);
            color: var(--success-600);
            border: 1px solid rgba(34, 197, 94, 0.2);
        }

        .dashboard-card .change.negative {
            background: rgba(239, 68, 68, 0.15);
            color: var(--error-600);
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        .dashboard-card .trend-icon {
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Modern Action Grid */
        .action-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: var(--space-6);
            margin-bottom: var(--space-8);
        }

        .action-btn {
            position: relative;
            background: var(--gradient-primary);
            color: var(--text-inverse);
            border: none;
            border-radius: var(--radius-xl);
            padding: var(--space-4);
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            min-height: var(--touch-target-comfortable);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-2);
            box-shadow: var(--shadow-md);
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            background: linear-gradient(135deg, var(--primary-600), var(--primary-500));
        }

        .action-btn:active {
            transform: translateY(0);
            box-shadow: var(--shadow-sm);
        }

        .action-btn-icon {
            font-size: 1.5rem;
            margin-bottom: var(--space-1);
        }

        /* Responsive Design System */
        @media (max-width: 480px) {
            .header-title {
                font-size: var(--text-base);
            }

            .dashboard-stats {
                grid-template-columns: 1fr;
                gap: var(--space-3);
            }

            .action-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: var(--space-3);
            }

            .menu-grid {
                grid-template-columns: 1fr;
                gap: var(--space-3);
            }

            .pos-layout {
                grid-template-columns: 1fr;
            }

            .container {
                padding: 0 var(--space-3);
            }
        }

        @media (min-width: 481px) and (max-width: 768px) {
            .dashboard-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .action-grid {
                grid-template-columns: repeat(3, 1fr);
            }

            .menu-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 769px) {
            .dashboard-stats {
                grid-template-columns: repeat(4, 1fr);
            }

            .action-grid {
                grid-template-columns: repeat(4, 1fr);
            }

            .menu-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        /* Enhanced Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--surface-overlay);
            backdrop-filter: blur(16px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: var(--space-4);
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modal.active {
            display: flex;
            opacity: 1;
        }

        .modal.active .modal-content {
            transform: scale(1);
            opacity: 1;
        }

        /* Mobile-Optimized Modal Content */
        .modal-content {
            background: var(--surface-elevated);
            border-radius: var(--radius-2xl);
            padding: var(--space-mobile-2xl);
            max-width: 500px;
            width: calc(100% - var(--space-mobile-2xl));
            max-height: 90dvh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            box-shadow: var(--shadow-2xl);
            border: 1px solid var(--border-light);
            position: relative;
            transform: scale(0.95);
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-mobile-xl);
            padding-bottom: var(--space-mobile-lg);
            border-bottom: 1px solid var(--border-light);
        }

        .modal-title {
            font-size: var(--text-mobile-lg);
            font-weight: var(--font-bold);
            color: var(--text-primary);
            margin: 0;
            line-height: 1.3;
        }

        /* Desktop modal adjustments */
        @media (min-width: 430px) {
            .modal-content {
                padding: var(--space-6);
                width: 100%;
                max-height: 90vh;
            }

            .modal-header {
                margin-bottom: var(--space-6);
                padding-bottom: var(--space-4);
            }

            .modal-title {
                font-size: var(--text-xl);
                line-height: 1.4;
            }
        }

        .modal-close {
            background: none;
            border: none;
            font-size: var(--text-xl);
            cursor: pointer;
            color: var(--text-secondary);
            padding: var(--space-2);
            border-radius: var(--radius-lg);
            transition: all 0.2s ease;
            width: var(--touch-target-min);
            height: var(--touch-target-min);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            background: var(--primary-50);
            color: var(--primary-600);
            transform: rotate(90deg);
        }

        /* Enhanced List Styles */
        .list-container {
            background: var(--surface-elevated);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-xl);
            overflow: hidden;
            margin-bottom: var(--space-4);
            box-shadow: var(--shadow-sm);
        }

        .list-header {
            background: var(--primary-50);
            padding: var(--space-4);
            border-bottom: 1px solid var(--border-light);
        }

        .list-title {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--primary-600);
            margin: 0;
        }

        .list-item {
            padding: var(--space-4);
            border-bottom: 1px solid var(--border-light);
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .list-item:last-child {
            border-bottom: none;
        }

        .list-item:hover {
            background: var(--primary-25);
        }

        .list-item:hover {
            background: var(--secondary-purple);
        }

        .list-item-title {
            font-size: var(--text-base);
            font-weight: var(--font-medium);
            color: var(--text-primary);
            margin: 0 0 var(--space-1) 0;
        }

        .list-item-subtitle {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            margin: 0;
        }

        .list-item-value {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--primary-purple);
        }

        /* Professional Alert Styles */
        .alert {
            padding: var(--space-4);
            border-radius: var(--radius-lg);
            margin-bottom: var(--space-4);
            border: 1px solid;
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }

        .alert-info {
            background: rgba(6, 182, 212, 0.1);
            border-color: var(--accent-cyan);
            color: var(--accent-cyan);
        }

        .alert-warning {
            background: rgba(245, 158, 11, 0.1);
            border-color: var(--accent-orange);
            color: var(--accent-orange);
        }

        .alert-error {
            background: rgba(239, 68, 68, 0.1);
            border-color: var(--accent-red);
            color: var(--accent-red);
        }

        .alert-success {
            background: rgba(16, 185, 129, 0.1);
            border-color: var(--accent-green);
            color: var(--accent-green);
        }

        /* Loading States */
        .loading {
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
        }

        .spinner {
            width: 16px;
            height: 16px;
            border: 2px solid var(--border-light);
            border-top-color: var(--primary-purple);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Dashboard Cards */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 20px;
        }

        .dashboard-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 20px 15px;
            text-align: center;
            border: 1px solid rgba(139, 92, 246, 0.1);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(139, 92, 246, 0.08);
        }

        .dashboard-card:active {
            transform: scale(0.98);
        }

        .dashboard-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(139, 92, 246, 0.12);
            border-color: rgba(139, 92, 246, 0.2);
        }

        .dashboard-card.sales {
            background: linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%);
            color: white;
        }

        .dashboard-card.sales::before {
            content: "üí∞";
            position: absolute;
            top: 10px;
            left: 15px;
            font-size: 20px;
            opacity: 0.8;
        }

        .dashboard-card.inventory {
            background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);
            color: white;
        }

        .dashboard-card.inventory::before {
            content: "üì¶";
            position: absolute;
            top: 10px;
            left: 15px;
            font-size: 20px;
            opacity: 0.8;
        }

        .dashboard-card.alerts {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
        }

        .dashboard-card.alerts::before {
            content: "‚ö†Ô∏è";
            position: absolute;
            top: 10px;
            left: 15px;
            font-size: 20px;
            opacity: 0.8;
        }

        .dashboard-card.expenses {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }

        .dashboard-card.expenses::before {
            content: "üí≥";
            position: absolute;
            top: 10px;
            left: 15px;
            font-size: 20px;
            opacity: 0.8;
        }

        .card-value {
            font-size: 24px;
            font-weight: 800;
            margin-bottom: 5px;
            line-height: 1;
        }

        .card-label {
            font-size: 12px;
            opacity: 0.9;
            font-weight: 500;
        }

        .card-trend {
            position: absolute;
            top: 8px;
            right: 8px;
            font-size: 18px;
        }

        /* Alert Badge */
        .alert-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #ff4757;
            color: white;
            border-radius: 12px;
            padding: 4px 8px;
            font-size: 11px;
            font-weight: 600;
            min-width: 20px;
            /* animation moved to unified definition later (gentle-pulse) */
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        /* Quick Actions */
        .quick-actions {
            margin-bottom: 25px;
        }

        .section-title {
            font-size: 16px;
            font-weight: 700;
            color: #6b46c1;
            margin-bottom: 12px;
            text-shadow: none;
        }

        .actions-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }

        .action-btn {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(139, 92, 246, 0.1);
            border-radius: 16px;
            padding: 20px 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 80px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 6px;
            box-shadow: 0 4px 16px rgba(139, 92, 246, 0.06);
        }

        .action-btn:active {
            transform: scale(0.95);
            background: rgba(255, 255, 255, 1);
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(139, 92, 246, 0.12);
            border-color: rgba(139, 92, 246, 0.2);
        }

        .action-icon {
            font-size: 24px;
            margin-bottom: 4px;
            filter: drop-shadow(0 2px 4px rgba(139, 92, 246, 0.1));
        }

        .action-label {
            font-size: 10px;
            font-weight: 600;
            color: #4c1d95;
            text-align: center;
            line-height: 1.2;
        }

        .action-btn.pos-action .action-icon {
            color: #8b5cf6;
        }

        .action-btn.inventory-action .action-icon {
            color: #06b6d4;
        }

        .action-btn.expense-action .action-icon {
            color: #10b981;
        }

        .action-btn.analysis-action .action-icon {
            color: #f59e0b;
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(139, 92, 246, 0.1);
            padding: 8px 0;
            z-index: 1000;
            box-shadow: 0 -2px 20px rgba(139, 92, 246, 0.08);
        }

        .nav-items {
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            cursor: pointer;
            padding: 8px;
            border-radius: 12px;
            transition: all 0.3s ease;
            flex: 1;
            max-width: 80px;
            position: relative;
        }

        .nav-item.active {
            background: rgba(139, 92, 246, 0.1);
            color: #8b5cf6;
        }

        .nav-item.active::after {
            content: "";
            position: absolute;
            top: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 24px;
            height: 3px;
            background: linear-gradient(135deg, #8b5cf6, #a855f7);
            border-radius: 0 0 3px 3px;
        }

        .nav-item:active {
            transform: scale(0.95);
        }

        .nav-icon {
            font-size: 20px;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
        }

        .nav-label {
            font-size: 10px;
            font-weight: 600;
        }

        /* POS Screen */
        .pos-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .menu-section {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 10px;
            max-height: 50vh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .menu-item {
            background: linear-gradient(135deg, #ff9a8b 0%, #fd746c 100%);
            border: none;
            border-radius: 12px;
            padding: 15px 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
            text-align: center;
            min-height: 90px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            touch-action: manipulation;
        }

        .menu-item:active {
            transform: scale(0.95);
        }

        .menu-item h3 {
            font-size: 13px;
            margin-bottom: 5px;
            font-weight: 600;
            line-height: 1.2;
        }

        .menu-item .price {
            font-size: 14px;
            font-weight: 700;
        }

        .cart-section {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            max-height: 40vh;
            display: flex;
            flex-direction: column;
        }

        .cart-header {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 10px;
            text-align: center;
            color: #333;
        }

        .cart-items {
            flex: 1;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            margin-bottom: 15px;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin-bottom: 8px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 10px;
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-name {
            font-size: 14px;
            font-weight: 600;
            color: #333;
        }

        .cart-item-price {
            font-size: 12px;
            color: #666;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .qty-btn {
            background: #667eea;
            border: none;
            border-radius: 8px;
            color: white;
            width: 30px;
            height: 30px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .qty-btn:active {
            transform: scale(0.9);
        }

        .quantity {
            font-size: 14px;
            font-weight: 600;
            min-width: 20px;
            text-align: center;
        }

        .cart-total {
            font-size: 16px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 15px;
            padding: 12px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 10px;
            color: #333;
        }

        .checkout-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            border-radius: 12px;
            padding: 15px;
            color: white;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .checkout-btn:active {
            transform: scale(0.98);
        }

        .checkout-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Form Styles */
        .form-container {
            background: var(--surface-elevated);
            backdrop-filter: blur(16px);
            border-radius: var(--radius-2xl);
            padding: var(--space-6);
            border: 1px solid var(--border-light);
            margin-bottom: var(--space-6);
            box-shadow: var(--shadow-lg);
        }

        .form-group {
            margin-bottom: var(--space-4);
        }

        .form-group label {
            display: block;
            margin-bottom: var(--space-2);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            font-size: var(--text-sm);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: var(--space-3);
            border: 1px solid var(--border-medium);
            border-radius: var(--radius-lg);
            font-size: var(--text-base);
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            background: var(--surface-primary);
            backdrop-filter: blur(8px);
            appearance: none;
            -webkit-appearance: none;
            min-height: var(--touch-target-min);
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-500);
            box-shadow: 0 0 0 3px var(--primary-100);
            transform: translateY(-1px);
        }

        /* Receipt Upload Styles */
        .receipt-upload-area {
            position: relative;
            border: 2px dashed #e8ecf4;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            background: rgba(255, 255, 255, 0.5);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .receipt-upload-area:hover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
        }

        .receipt-upload-area input[type="file"] {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }

        .upload-display {
            pointer-events: none;
        }

        .upload-icon {
            font-size: 32px;
            margin-bottom: 10px;
            opacity: 0.7;
        }

        .upload-text {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .upload-info {
            font-size: 12px;
            color: #666;
        }

        .receipt-preview {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            border: 2px solid #e8ecf4;
        }

        .receipt-preview img {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 8px;
            border: 1px solid #ddd;
        }

        .receipt-info {
            flex: 1;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .receipt-info span {
            font-size: 14px;
            color: #333;
            font-weight: 500;
        }

        .remove-receipt {
            background: #ff4757;
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .remove-receipt:hover {
            background: #ff3742;
        }

        /* Missing media query restored for small device layout adjustments */

        .btn::before {
            content: "";
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn:hover {
            box-shadow: 0 6px 24px rgba(139, 92, 246, 0.35);
            background: linear-gradient(135deg, #7c3aed, #9333ea);
            transform: translateY(-1px);
        }

        .btn-small {
            padding: 8px 12px;
            font-size: 12px;
            min-height: 36px;
        }

        .btn-success {
            background: linear-gradient(135deg, #10b981, #059669);
            box-shadow: 0 4px 16px rgba(16, 185, 129, 0.25);
        }

        .btn-success:hover {
            box-shadow: 0 6px 24px rgba(16, 185, 129, 0.35);
            background: linear-gradient(135deg, #047857, #065f46);
        }

        .btn-warning {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            box-shadow: 0 4px 16px rgba(245, 158, 11, 0.25);
        }

        .btn-warning:hover {
            box-shadow: 0 6px 24px rgba(245, 158, 11, 0.35);
            background: linear-gradient(135deg, #d97706, #b45309);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            box-shadow: 0 4px 16px rgba(239, 68, 68, 0.25);
        }

        .btn-danger:hover {
            box-shadow: 0 6px 24px rgba(239, 68, 68, 0.35);
            background: linear-gradient(135deg, #dc2626, #b91c1c);
        }

        /* List Styles */
        .list-container {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            margin-bottom: 15px;
        }

        .list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .list-title {
            font-size: 16px;
            font-weight: 700;
            color: #333;
        }

        .list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            margin-bottom: 8px;
            background: rgba(102, 126, 234, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .list-item-info {
            flex: 1;
        }

        .list-item-title {
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
        }

        .list-item-subtitle {
            font-size: 12px;
            color: #666;
        }

        .list-item-actions {
            display: flex;
            gap: 6px;
        }

        /* Alert Styles */
        .alert {
            padding: 12px 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            font-size: 14px;
            font-weight: 500;
        }

        .alert-critical {
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            color: white;
            animation: pulse 2s infinite;
        }

        .alert-warning {
            background: linear-gradient(135deg, #fa709a, #fee140);
            color: white;
        }

        .alert-info {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            color: white;
        }

        /* Loading States */
        .loading {
            text-align: center;
            padding: 40px 20px;
            color: #666;
            font-size: 14px;
        }

        .loading::after {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid #667eea;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Success/Error Messages */
        .message {
            position: fixed;
            top: 80px;
            left: 20px;
            right: 20px;
            padding: 15px;
            border-radius: 12px;
            font-weight: 600;
            z-index: 2000;
            animation: slideDown 0.3s ease;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .message.success {
            background: linear-gradient(135deg, rgba(67, 233, 123, 0.9), rgba(56, 249, 215, 0.9));
            color: white;
            border-left: 4px solid #43e97b;
        }

        .message.success::before {
            content: "‚úÖ";
            font-size: 18px;
        }

        .message.error {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.9), rgba(254, 202, 87, 0.9));
            color: white;
            border-left: 4px solid #ff6b6b;
        }

        .message.error::before {
            content: "‚ö†Ô∏è";
            font-size: 18px;
        }

        .message.info {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.9), rgba(168, 85, 247, 0.9));
            color: white;
            border-left: 4px solid #8b5cf6;
        }

        .message.info::before {
            content: "‚ÑπÔ∏è";
            font-size: 18px;
        }

        @keyframes slideDown {
            from {
                transform: translateY(-100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 15px 10px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.3);
            min-height: 80px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .stat-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(135deg, #8b5cf6, #a855f7);
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
        }

        .stat-card h3 {
            font-size: 18px;
            font-weight: 700;
            color: #333;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .stat-card h3::before {
            font-size: 16px;
        }

        .stat-card h3[data-stat="customers"]::before {
            content: "üë•";
        }

        .stat-card h3[data-stat="orders"]::before {
            content: "üìã";
        }

        .stat-card h3[data-stat="avg-order"]::before {
            content: "üí∞";
        }

        .stat-card h3[data-stat="profit"]::before {
            content: "üìà";
        }

        .stat-card p {
            font-size: 11px;
            color: #666;
            font-weight: 500;
        }

        /* Enhanced Analytics Styles */
        .analytics-section {
            margin-top: var(--space-6);
            display: flex;
            flex-direction: column;
            gap: var(--space-6);
        }

        .chart-container {
            background: var(--surface-primary);
            border-radius: var(--radius-xl);
            padding: var(--space-6);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-light);
        }

        .chart-title {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin: 0 0 var(--space-4) 0;
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .chart-wrapper {
            position: relative;
            height: 300px;
            width: 100%;
        }

        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--space-4);
        }

        .half-width .chart-wrapper {
            height: 250px;
        }

        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--space-4);
        }

        .insight-card {
            background: linear-gradient(135deg, var(--surface-primary) 0%, var(--surface-secondary) 100%);
            border-radius: var(--radius-lg);
            padding: var(--space-4);
            border: 1px solid var(--border-light);
            display: flex;
            align-items: flex-start;
            gap: var(--space-3);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .insight-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-purple);
        }

        .insight-icon {
            font-size: var(--text-2xl);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 48px;
            height: 48px;
            background: var(--secondary-purple);
            border-radius: var(--radius-lg);
            flex-shrink: 0;
        }

        .insight-content h4 {
            font-size: var(--text-sm);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin: 0 0 var(--space-1) 0;
        }

        .insight-content p {
            font-size: var(--text-xs);
            color: var(--text-secondary);
            margin: 0;
            line-height: 1.4;
        }

        /* Smart Notifications System */
        .toast-container {
            position: fixed;
            top: 80px;
            right: 20px;
            z-index: 9999;
            pointer-events: none;
        }

        .toast {
            background: var(--surface-primary);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-xl);
            border-left: 4px solid var(--primary-purple);
            padding: var(--space-4);
            margin-bottom: var(--space-3);
            max-width: 320px;
            transform: translateX(100%);
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            pointer-events: auto;
        }

        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }

        .toast.success {
            border-left-color: var(--accent-green);
        }

        .toast.warning {
            border-left-color: var(--accent-orange);
        }

        .toast.error {
            border-left-color: var(--accent-red);
        }

        .toast.info {
            border-left-color: var(--accent-cyan);
        }

        .toast-header {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            margin-bottom: var(--space-2);
        }

        .toast-icon {
            font-size: var(--text-lg);
        }

        .toast-title {
            font-weight: var(--font-semibold);
            font-size: var(--text-sm);
            color: var(--text-primary);
            margin: 0;
        }

        .toast-message {
            font-size: var(--text-xs);
            color: var(--text-secondary);
            line-height: 1.4;
            margin: 0;
        }

        .toast-close {
            background: none;
            border: none;
            color: var(--text-tertiary);
            cursor: pointer;
            padding: 2px;
            margin-left: auto;
            border-radius: var(--radius-sm);
            font-size: var(--text-sm);
        }

        .toast-close:hover {
            background: var(--secondary-purple);
            color: var(--text-primary);
        }

        /* Alert Badge */
        .alert-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--accent-red);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: var(--font-bold);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .notification-center {
            position: fixed;
            top: 0;
            right: -400px;
            width: 380px;
            height: 100vh;
            background: var(--surface-primary);
            box-shadow: var(--shadow-xl);
            border-left: 1px solid var(--border-light);
            z-index: 9998;
            transition: right 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
        }

        .notification-center.open {
            right: 0;
        }

        .notification-header {
            padding: var(--space-4);
            border-bottom: 1px solid var(--border-light);
            display: flex;
            justify-content: between;
            align-items: center;
        }

        .notification-list {
            flex: 1;
            overflow-y: auto;
            padding: var(--space-2);
        }

        .notification-item {
            padding: var(--space-3);
            margin-bottom: var(--space-2);
            background: var(--surface-secondary);
            border-radius: var(--radius-lg);
            border-left: 3px solid var(--primary-purple);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .notification-item:hover {
            transform: translateX(4px);
            box-shadow: var(--shadow-md);
        }

        .notification-item.unread {
            background: var(--secondary-purple);
        }

        /* Chart Responsiveness */
        @media (max-width: 768px) {
            .analytics-grid {
                grid-template-columns: 1fr;
            }

            .chart-wrapper {
                height: 250px;
            }

            .half-width .chart-wrapper {
                height: 200px;
            }

            .insights-grid {
                grid-template-columns: 1fr;
            }

            .toast-container {
                right: 10px;
                top: 70px;
            }

            .toast {
                max-width: calc(100vw - 20px);
            }

            .notification-center {
                width: 100vw;
                right: -100vw;
            }

            .filters-grid {
                grid-template-columns: 1fr;
                gap: var(--space-3);
            }

            .date-range {
                flex-direction: column;
                gap: var(--space-2);
            }
        }

        /* Advanced Filters Styles */
        .filters-section {
            background: var(--surface-primary);
            border-radius: var(--radius-xl);
            padding: var(--space-4);
            margin-bottom: var(--space-6);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-light);
        }

        .filters-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-4);
        }

        .filters-header h3 {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin: 0;
        }

        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-4);
            align-items: end;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: var(--space-2);
        }

        .filter-group label {
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--text-secondary);
        }

        .filter-group input,
        .filter-group select {
            padding: var(--space-3);
            border: 1px solid var(--border-medium);
            border-radius: var(--radius-lg);
            font-size: var(--text-sm);
            transition: all 0.2s ease;
            background: var(--surface-primary);
        }

        .filter-group input:focus,
        .filter-group select:focus {
            outline: none;
            border-color: var(--primary-purple);
            box-shadow: 0 0 0 3px var(--secondary-purple);
        }

        .date-range {
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .date-range span {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            white-space: nowrap;
        }

        .date-range input {
            flex: 1;
            margin: 0;
        }

        /* Responsive Adjustments */
        @media (max-width: 360px) {
            .header h1 {
                font-size: 14px;
            }
        }

        /* Floating Animation */
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-6px); }
        }

        .dashboard-card.sales {
            animation: float 6s ease-in-out infinite;
            animation-delay: 0s;
        }

        .dashboard-card.inventory {
            animation: float 6s ease-in-out infinite;
            animation-delay: 1s;
        }

        .dashboard-card.alerts {
            animation: float 6s ease-in-out infinite;
            animation-delay: 2s;
        }

        .dashboard-card.expenses {
            animation: float 6s ease-in-out infinite;
            animation-delay: 3s;
        }

        /* Shimmer Loading Effect */
        @keyframes shimmer {
            0% { background-position: -468px 0; }
            100% { background-position: 468px 0; }
        }

        .loading-shimmer {
            background: linear-gradient(90deg, transparent, rgba(139, 92, 246, 0.1), transparent);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }

        /* Pulse Animation for Important Elements */
        @keyframes gentle-pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .alert-badge {
            animation: gentle-pulse 2s infinite;
        }
        /* Missing media query restored for small device layout adjustments */
        @media (max-width: 480px) {
            .main-content { padding: 10px; }
            .dashboard-grid { gap: 8px; }
            .dashboard-card { padding: 15px 10px; }
            .card-value { font-size: 20px; }
            .actions-grid { grid-template-columns: repeat(4, 1fr); gap: 8px; }
            .action-btn { padding: 15px 5px; min-height: 70px; }
            .action-icon { font-size: 20px; }
            .action-label { font-size: 9px; }
        }

        /* Safe area support for notched phones */
        @supports (padding: max(0px)) {
            .header {
                padding-top: max(12px, env(safe-area-inset-top));
            }

            .bottom-nav {
                padding-bottom: max(8px, env(safe-area-inset-bottom));
            }
        }

        /* Enhanced POS Features */
        .cost-info-panel {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            border-radius: 16px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);
        }

        .cost-summary {
            display: flex;
            flex-direction: column;
            gap: 4px;
            font-size: 12px;
            font-weight: 600;
        }

        .quick-expense-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            padding: 8px 12px;
            color: white;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .quick-expense-btn::before {
            content: "üí≥";
            margin-right: 6px;
            font-size: 14px;
        }

        .quick-expense-btn:active {
            transform: scale(0.95);
            background: rgba(255, 255, 255, 0.3);
        }

        .quick-expense-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .menu-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .cost-analysis-btn {
            background: linear-gradient(135deg, #43e97b, #38f9d7);
            border: none;
            border-radius: 8px;
            padding: 6px 10px;
            color: white;
            font-size: 11px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .cost-analysis-btn:active {
            transform: scale(0.95);
        }

        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .profit-indicator {
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .profit-indicator.low {
            filter: hue-rotate(0deg); /* Red */
        }

        .profit-indicator.medium {
            filter: hue-rotate(60deg); /* Yellow */
        }

        .profit-indicator.high {
            filter: hue-rotate(120deg); /* Green */
        }

        .cart-totals {
            margin-bottom: 15px;
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            margin-bottom: 5px;
            background: rgba(102, 126, 234, 0.05);
            border-radius: 8px;
            font-size: 14px;
        }

        .profit-row {
            background: rgba(67, 233, 123, 0.1);
            border: 1px solid rgba(67, 233, 123, 0.2);
            font-weight: 700;
            color: #2d7d32;
        }

        .profit-row.negative {
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid rgba(255, 107, 107, 0.2);
            color: #d32f2f;
        }

        /* Enhanced Menu Items with Cost Info */
        .menu-item {
            position: relative;
            overflow: visible;
        }

        .menu-item .cost-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border-radius: 8px;
            padding: 2px 6px;
            font-size: 9px;
            font-weight: 600;
            line-height: 1;
        }

        .menu-item .profit-badge {
            position: absolute;
            bottom: -5px;
            left: -5px;
            background: linear-gradient(135deg, #43e97b, #38f9d7);
            color: white;
            border-radius: 8px;
            padding: 2px 6px;
            font-size: 9px;
            font-weight: 600;
            line-height: 1;
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            width: 100%;
            max-width: 400px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .modal-content.cost-modal {
            max-width: 500px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
        }

        .modal-header h3 {
            margin: 0;
            color: #333;
            font-size: 18px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .modal-header h3::before {
            content: "‚ú®";
            font-size: 20px;
        }

        .close-btn {
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            font-size: 18px;
            color: #666;
            cursor: pointer;
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 1);
            color: #ff4757;
            transform: scale(1.1);
        }

        .modal form {
            padding: 20px;
        }

        .modal-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .btn-cancel {
            flex: 1;
            background: linear-gradient(135deg, #e0e0e0, #f5f5f5);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            padding: 12px;
            color: #666;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn-cancel:hover {
            background: linear-gradient(135deg, #f5f5f5, #ffffff);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .btn-save {
            flex: 1;
            background: linear-gradient(135deg, #8b5cf6, #a855f7);
            border: none;
            border-radius: 12px;
            padding: 12px;
            color: white;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 16px rgba(139, 92, 246, 0.25);
        }

        .btn-save:hover {
            background: linear-gradient(135deg, #7c3aed, #9333ea);
            transform: translateY(-1px);
            box-shadow: 0 6px 24px rgba(139, 92, 246, 0.35);
        }

        .btn-save::before {
            content: "üíæ";
            margin-right: 6px;
        }

        .cost-analysis-content {
            padding: 20px;
            max-height: 400px;
            overflow-y: auto;
        }

        .cost-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            margin-bottom: 8px;
            background: rgba(102, 126, 234, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .cost-item-info h4 {
            margin: 0 0 4px 0;
            font-size: 14px;
            font-weight: 600;
            color: #333;
        }

        .cost-item-info p {
            margin: 0;
            font-size: 12px;
            color: #666;
        }

        .cost-item-values {
            text-align: right;
        }

        .cost-item-values .cost {
            font-size: 12px;
            color: #666;
        }

        .cost-item-values .profit {
            font-size: 14px;
            font-weight: 700;
            color: #43e97b;
        }

        .cost-item-values .profit.low {
            color: #ff6b6b;
        }

        .cost-item-values .profit.medium {
            color: #feca57;
        }

        /* Improved Mobile Touch Targets */
        .qty-btn {
            min-width: 40px;
            min-height: 40px;
            font-size: 18px;
        }

        .checkout-btn {
            min-height: 50px;
            font-size: 16px;
            position: relative;
        }

        #checkout-profit {
            position: absolute;
            top: 2px;
            right: 15px;
            font-size: 11px;
            opacity: 0.8;
        }

        /* Quick Actions Enhancement */
        .action-btn.expense-action {
            background: linear-gradient(135deg, #fa709a, #fee140);
        }

        .action-btn.cost-action {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
        }

        /* Responsive Improvements */
        @media (max-width: 390px) {
            .cost-summary {
                font-size: 11px;
            }

            .quick-expense-btn {
                font-size: 11px;
                padding: 6px 8px;
            }

            .modal-content {
                margin: 10px;
                max-height: 85vh;
            }

            .total-row {
                font-size: 13px;
                padding: 6px 10px;
            }
        }

        @media (max-width: 360px) {
            .cost-info-panel {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }

            .menu-header {
                flex-direction: column;
                gap: 10px;
                align-items: stretch;
            }

            .cost-analysis-btn {
                width: 100%;
                padding: 8px;
            }
        }

        /* ===============================================
           MOBILE-FIRST ENHANCED FEATURES
           =============================================== */

        /* Mobile Pull-to-Refresh Indicator */
        .pull-to-refresh {
            position: absolute;
            top: -60px;
            left: 50%;
            transform: translateX(-50%);
            color: var(--primary-500);
            font-size: var(--text-sm);
            text-align: center;
            transition: all 0.3s ease;
            opacity: 0;
        }

        .pull-to-refresh.active {
            opacity: 1;
            top: -40px;
        }

        /* Enhanced Mobile Scrollbars */
        .mobile-scroll::-webkit-scrollbar {
            width: 3px;
        }

        .mobile-scroll::-webkit-scrollbar-track {
            background: transparent;
        }

        .mobile-scroll::-webkit-scrollbar-thumb {
            background: var(--primary-300);
            border-radius: var(--radius-full);
        }

        /* Mobile-Specific Animations */
        @keyframes mobile-bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .mobile-bounce {
            animation: mobile-bounce 0.6s ease-in-out;
        }

        /* Mobile Safe Area Support */
        .safe-area-top {
            padding-top: env(safe-area-inset-top);
        }

        .safe-area-bottom {
            padding-bottom: env(safe-area-inset-bottom);
        }

        .safe-area-left {
            padding-left: env(safe-area-inset-left);
        }

        .safe-area-right {
            padding-right: env(safe-area-inset-right);
        }

        /* Mobile Haptic Feedback Simulation */
        .haptic-light {
            animation: haptic-pulse 0.1s ease;
        }

        .haptic-medium {
            animation: haptic-pulse 0.15s ease;
        }

        .haptic-heavy {
            animation: haptic-pulse 0.2s ease;
        }

        @keyframes haptic-pulse {
            0% { transform: scale(1); }
            50% { transform: scale(0.97); }
            100% { transform: scale(1); }
        }

        /* Mobile Loading States */
        .mobile-loading {
            position: relative;
            overflow: hidden;
        }

        .mobile-loading::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: mobile-shimmer 1.5s infinite;
        }

        @keyframes mobile-shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        /* Swipe Gesture Indicators */
        .swipe-indicator {
            position: relative;
            overflow: hidden;
        }

        .swipe-indicator::after {
            content: '';
            position: absolute;
            right: var(--space-mobile-md);
            top: 50%;
            width: 20px;
            height: 2px;
            background: var(--primary-300);
            transform: translateY(-50%);
            border-radius: var(--radius-full);
        }

        .swipe-indicator::before {
            content: '';
            position: absolute;
            right: var(--space-mobile-lg);
            top: 50%;
            width: 0;
            height: 0;
            border-left: 6px solid var(--primary-300);
            border-top: 3px solid transparent;
            border-bottom: 3px solid transparent;
            transform: translateY(-50%);
        }

        /* Mobile-Only Utilities */
        @media (max-width: 767px) {
            .desktop-only {
                display: none !important;
            }

            .mobile-center {
                text-align: center !important;
            }

            .mobile-full-width {
                width: 100% !important;
            }

            .mobile-stack {
                flex-direction: column !important;
            }

            .mobile-hidden {
                display: none !important;
            }
        }

        @media (min-width: 768px) {
            .mobile-only {
                display: none !important;
            }
        }

        /* Enhanced Focus States for Mobile */
        @media (max-width: 767px) {
            .btn:focus-visible,
            .form-input:focus,
            .nav-item:focus {
                outline: 3px solid var(--primary-500);
                outline-offset: 2px;
            }
        }
    </style>

    <!-- Configuration and Database Scripts -->
    <script src="js/config.js"></script>
    <script src="js/database.js"></script>
</head>
<body>
    <!-- Toast Notification Container -->
    <div class="toast-container" id="toast-container"></div>

    <!-- Notification Center -->
    <div class="notification-center" id="notification-center">
        <div class="notification-header">
            <h3>üîî ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h3>
            <button class="btn btn-ghost btn-icon" onclick="toggleNotificationCenter()">√ó</button>
        </div>
        <div class="notification-list" id="notification-list"></div>
    </div>

    <div class="app-container">
        <!-- Professional Header -->
    <header class="header" role="banner" aria-label="Main application header">
            <div class="header-content">
                <h1 class="header-title">ü•™ ‡∏£‡πâ‡∏≤‡∏ô Sandwich ‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏°</h1>
                <div class="header-actions">
                    <button class="btn btn-icon btn-icon-sm btn-ghost" onclick="refreshDashboard()" title="‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä" aria-label="‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
                            <path d="M21 3v5h-5"/>
                            <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
                            <path d="M3 21v-5h5"/>
                        </svg>
                    </button>
                    <button class="btn btn-icon btn-icon-sm btn-ghost" onclick="toggleNotificationCenter()" title="‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô" aria-label="‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô" style="position: relative;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/>
                            <path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/>
                        </svg>
                        <span id="notification-badge" class="alert-badge" style="display: none;">0</span>
                    </button>
                    <button class="btn btn-icon btn-icon-sm btn-ghost" onclick="toggleMenu()" title="‡πÄ‡∏°‡∏ô‡∏π" aria-label="‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏°‡∏ô‡∏π">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="4" y1="6" x2="20" y2="6"/>
                            <line x1="4" y1="12" x2="20" y2="12"/>
                            <line x1="4" y1="18" x2="20" y2="18"/>
                        </svg>
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
    <div class="main-content" role="main">
            <!-- Utility Slide-in Menu -->
            <aside id="utility-menu" aria-label="Utility Menu" style="position:fixed;top:70px;right:-260px;width:250px;height:calc(100vh - 70px);background:rgba(255,255,255,0.96);backdrop-filter:blur(18px);border-left:1px solid rgba(139,92,246,0.15);box-shadow:-4px 0 18px -4px rgba(139,92,246,0.15);transition:right .35s cubic-bezier(.4,0,.2,1);z-index:1500;display:flex;flex-direction:column;">
                <div style="padding:14px 16px;border-bottom:1px solid rgba(139,92,246,0.15);display:flex;justify-content:space-between;align-items:center;">
                    <strong style="font-size:14px;color:#4c1d95;display:flex;align-items:center;gap:6px;">‚öôÔ∏è ‡πÄ‡∏°‡∏ô‡∏π</strong>
                    <button aria-label="‡∏õ‡∏¥‡∏î‡πÄ‡∏°‡∏ô‡∏π" onclick="toggleMenu()" style="background:transparent;border:none;font-size:18px;cursor:pointer;color:#6b21a8;">√ó</button>
                </div>
                <nav style="flex:1;overflow-y:auto;padding:10px 8px;" aria-label="Utility Actions">
                    <button class="btn btn-small" style="width:100%;margin-bottom:8px;" onclick="showQuickExpenseModal()">‚ûï ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏£‡πá‡∏ß</button>
                    <button class="btn btn-small" style="width:100%;margin-bottom:8px;" onclick="showCostAnalysis()">üìä ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô</button>
                    <button class="btn btn-small" style="width:100%;margin-bottom:8px;" onclick="showPriceRecommendations()">üí° ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏£‡∏≤‡∏Ñ‡∏≤</button>
                    <button class="btn btn-small" style="width:100%;margin-bottom:8px;" onclick="calculateDailyProfit()">üßÆ ‡∏Å‡∏≥‡πÑ‡∏£‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</button>
                    <button class="btn btn-small" style="width:100%;margin-bottom:8px;" onclick="generateReorderReport()">üì¶ ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</button>
                    <button class="btn btn-small" style="width:100%;margin-bottom:8px;" onclick="refreshDashboard()">üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</button>
                    <div style="margin:10px 4px 6px;font-size:11px;color:#6b7280;">‡∏£‡∏∞‡∏ö‡∏ö</div>
                    <button class="btn btn-small btn-warning" style="width:100%;margin-bottom:8px;" onclick="loadInventoryAlerts()">‚ö†Ô∏è ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏ï‡πä‡∏≠‡∏Å</button>
                </nav>
                <div style="padding:10px 12px;border-top:1px solid rgba(139,92,246,0.15);font-size:11px;color:#6b7280;line-height:1.4;">
                    <div>‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô: <span id="app-version">1.0.0-refactor</span></div>
                    <div style="opacity:.8;">¬© 2025 Sandwich ‡∏Å‡∏•‡∏°</div>
                </div>
            </aside>
            <!-- Dashboard Screen -->
            <div id="dashboard-screen" class="screen active">
                <!-- Advanced Filters -->
                <div class="filters-section">
                    <div class="filters-header">
                        <h3>üîç ‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
                        <button class="btn btn-ghost btn-small" onclick="resetFilters()">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
                    </div>
                    <div class="filters-grid">
                        <div class="filter-group">
                            <label>‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
                            <div class="date-range">
                                <input type="date" id="startDate" onchange="applyFilters()" />
                                <span>‡∏ñ‡∏∂‡∏á</span>
                                <input type="date" id="endDate" onchange="applyFilters()" />
                            </div>
                        </div>
                        <div class="filter-group">
                            <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</label>
                            <select id="dataType" onchange="applyFilters()">
                                <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                                <option value="sales">‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢</option>
                                <option value="expenses">‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</option>
                                <option value="inventory">‡∏™‡∏ï‡πä‡∏≠‡∏Å</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</label>
                            <input type="text" id="searchInput" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏°‡∏ô‡∏π, ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤..." onkeyup="applyFilters()" />
                        </div>
                        <div class="filter-group">
                            <button class="btn btn-primary btn-small" onclick="generateFilteredReport()">üìä ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
                        </div>
                    </div>
                </div>

                <!-- Dashboard Cards -->
                <div class="dashboard-grid">
                    <div class="dashboard-card sales" onclick="switchScreen('sales-screen')">
                        <div class="card-trend">üìà</div>
                        <div class="card-value" id="today-sales">0</div>
                        <div class="card-label">‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
                    </div>
                    <div class="dashboard-card inventory" onclick="switchScreen('inventory-screen')">
                        <div class="card-trend">üì¶</div>
                        <div class="card-value" id="inventory-status">OK</div>
                        <div class="card-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏ï‡πä‡∏≠‡∏Å</div>
                        <div class="alert-badge" id="inventory-alerts" style="display: none;">0</div>
                    </div>
                    <div class="dashboard-card alerts" onclick="showAlerts()">
                        <div class="card-trend">‚ö†Ô∏è</div>
                        <div class="card-value" id="alerts-count">0</div>
                        <div class="card-label">‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</div>
                    </div>
                    <div class="dashboard-card expenses" onclick="switchScreen('expenses-screen')">
                        <div class="card-trend">üí∞</div>
                        <div class="card-value" id="month-expenses">0</div>
                        <div class="card-label">‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="quick-actions">
                    <h3 class="section-title">‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏î‡πà‡∏ß‡∏ô</h3>
                    <div class="actions-grid">
                        <button class="action-btn" onclick="switchScreen('pos-screen')">
                            <div class="action-icon">üõí</div>
                            <div class="action-label">‡∏Ç‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</div>
                        </button>
                        <button class="action-btn expense-action" onclick="showQuickExpenseModal()">
                            <div class="action-icon">ÔøΩ</div>
                            <div class="action-label">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á</div>
                        </button>
                        <button class="action-btn cost-action" onclick="showCostAnalysis()">
                            <div class="action-icon">ÔøΩ</div>
                            <div class="action-label">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô</div>
                        </button>
                        <button class="action-btn" onclick="calculateDailyProfit()">
                            <div class="action-icon">ÔøΩ</div>
                            <div class="action-label">‡∏Å‡∏≥‡πÑ‡∏£‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
                        </button>
                        <button class="action-btn" onclick="switchScreen('inventory-screen')">
                            <div class="action-icon">üìã</div>
                            <div class="action-label">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏ï‡πä‡∏≠‡∏Å</div>
                        </button>
                        <button class="action-btn" onclick="showPriceRecommendations()">
                            <div class="action-icon">üí≤</div>
                            <div class="action-label">‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏£‡∏≤‡∏Ñ‡∏≤</div>
                        </button>
                        <button class="action-btn" onclick="addDailyOperation()">
                            <div class="action-icon">ÔøΩ</div>
                            <div class="action-label">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</div>
                        </button>
                        <button class="action-btn" onclick="generateReorderReport()">
                            <div class="action-icon">üõçÔ∏è</div>
                            <div class="action-label">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠</div>
                        </button>
                    </div>
                </div>

                <!-- Today's Summary -->
                <div class="form-container">
                    <h3 class="section-title" style="color: #333; text-shadow: none; margin-bottom: 15px;">‡∏™‡∏£‡∏∏‡∏õ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3 id="today-customers" data-stat="customers">0</h3>
                            <p>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="today-orders" data-stat="orders">0</h3>
                            <p>‡∏≠‡∏≠‡∏£‡πå‡πÄ‡∏î‡∏≠‡∏£‡πå</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="avg-order" data-stat="avg-order">0</h3>
                            <p>‡∏≠‡∏≠‡∏£‡πå‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="profit-margin" data-stat="profit">0%</h3>
                            <p>‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏ô</p>
                        </div>
                    </div>
                </div>

                <!-- Enhanced Analytics Section -->
                <div class="analytics-section">
                    <!-- Sales Trend Chart -->
                    <div class="chart-container">
                        <h3 class="chart-title">üìà ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ 7 ‡∏ß‡∏±‡∏ô‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á</h3>
                        <div class="chart-wrapper">
                            <canvas id="salesTrendChart"></canvas>
                        </div>
                    </div>

                    <!-- Analytics Grid -->
                    <div class="analytics-grid">
                        <!-- Top Products Chart -->
                        <div class="chart-container half-width">
                            <h3 class="chart-title">üèÜ ‡πÄ‡∏°‡∏ô‡∏π‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°</h3>
                            <div class="chart-wrapper">
                                <canvas id="topProductsChart"></canvas>
                            </div>
                        </div>

                        <!-- Profit Analysis -->
                        <div class="chart-container half-width">
                            <h3 class="chart-title">üí∞ ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Å‡∏≥‡πÑ‡∏£</h3>
                            <div class="chart-wrapper">
                                <canvas id="profitAnalysisChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Business Intelligence Cards -->
                    <div class="insights-grid">
                        <div class="insight-card">
                            <div class="insight-icon">üöÄ</div>
                            <div class="insight-content">
                                <h4>‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï</h4>
                                <p id="growth-insight">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì...</p>
                            </div>
                        </div>
                        <div class="insight-card">
                            <div class="insight-icon">‚≠ê</div>
                            <div class="insight-content">
                                <h4>‡πÄ‡∏°‡∏ô‡∏π‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</h4>
                                <p id="recommendation-insight">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå...</p>
                            </div>
                        </div>
                        <div class="insight-card">
                            <div class="insight-icon">üìä</div>
                            <div class="insight-content">
                                <h4>‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û</h4>
                                <p id="performance-insight">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô...</p>
                            </div>
                        </div>
                        <div class="insight-card">
                            <div class="insight-icon">üí°</div>
                            <div class="insight-content">
                                <h4>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</h4>
                                <p id="tip-insight">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- POS Screen -->
            <div id="pos-screen" class="screen">
                <div class="pos-container">
                    <!-- Quick Cost Info Panel -->
                    <div class="cost-info-panel">
                        <div class="cost-summary">
                            <span id="cart-cost">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô: 0‡∏ø</span>
                            <span id="cart-profit">‡∏Å‡∏≥‡πÑ‡∏£: 0‡∏ø</span>
                            <span id="profit-margin">%‡∏Å‡∏≥‡πÑ‡∏£: 0%</span>
                        </div>
                        <button class="quick-expense-btn" onclick="showQuickExpenseModal()">
                            üí∞ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á
                        </button>
                    </div>

                    <div class="menu-section">
                        <div class="menu-header">
                            <h3 class="section-title" style="color: #333; text-shadow: none;">‡πÄ‡∏°‡∏ô‡∏π‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
                            <button class="cost-analysis-btn" onclick="showCostAnalysis()">üìä ‡∏î‡∏π‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô</button>
                        </div>
                        <div class="menu-grid" id="menu-grid">
                            <!-- Menu items will be loaded here -->
                        </div>
                    </div>

                    <div class="cart-section">
                        <h3 class="cart-header">
                            ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
                            <span class="profit-indicator" id="profit-indicator">üíö</span>
                        </h3>
                        <div class="cart-items" id="cart-items">
                            <!-- Cart items will be displayed here -->
                        </div>
                        <div class="cart-totals">
                            <div class="total-row">
                                <span>‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏£‡∏ß‡∏°:</span>
                                <span id="total-cost">0 ‡∏ö‡∏≤‡∏ó</span>
                            </div>
                            <div class="total-row">
                                <span>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢:</span>
                                <span id="cart-total">0 ‡∏ö‡∏≤‡∏ó</span>
                            </div>
                            <div class="total-row profit-row">
                                <span>‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥:</span>
                                <span id="total-profit">0 ‡∏ö‡∏≤‡∏ó</span>
                            </div>
                        </div>
                        <button class="checkout-btn" id="checkout-btn" onclick="checkout()">
                            ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô <span id="checkout-profit"></span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Quick Expense Modal -->
            <div id="quick-expense-modal" class="modal" style="display: none;" role="dialog" aria-modal="true" aria-labelledby="quick-expense-title">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 id="quick-expense-title">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡∏î‡πà‡∏ß‡∏ô</h3>
                        <button class="close-btn" onclick="closeQuickExpenseModal()">√ó</button>
                    </div>
                    <form id="quick-expense-form">
                        <div class="form-group">
                            <label>‡∏£‡πâ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠:</label>
                            <select id="store-select" required>
                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡πâ‡∏≤‡∏ô</option>
                                <option value="‡πÇ‡∏•‡∏ï‡∏±‡∏™">‡πÇ‡∏•‡∏ï‡∏±‡∏™</option>
                                <option value="7-Eleven">7-Eleven</option>
                                <option value="‡πÅ‡∏°‡πá‡∏Ñ‡πÇ‡∏Ñ‡∏£">‡πÅ‡∏°‡πá‡∏Ñ‡πÇ‡∏Ñ‡∏£</option>
                                <option value="‡πÄ‡∏ó‡∏™‡πÇ‡∏Å‡πâ">‡πÄ‡∏ó‡∏™‡πÇ‡∏Å‡πâ</option>
                                <option value="‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏™‡πà‡∏á">‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏™‡πà‡∏á</option>
                                <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠:</label>
                            <input type="text" id="expense-items" placeholder="‡πÄ‡∏ä‡πà‡∏ô: ‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á ‡πÅ‡∏Æ‡∏° ‡∏ä‡∏µ‡∏™" required>
                        </div>
                        <div class="form-group">
                            <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó):</label>
                            <input type="number" id="expense-amount" placeholder="0" required>
                        </div>
                        <div class="form-group">
                            <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:</label>
                            <select id="expense-type" required>
                                <option value="‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö">‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö</option>
                                <option value="‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°</option>
                                <option value="‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå">‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</option>
                                <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>‡πÅ‡∏ô‡∏ö‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à:</label>
                            <div class="receipt-upload-area">
                                <input type="file" id="receipt-file" accept="image/*,application/pdf" onchange="handleReceiptUpload(this)">
                                <div class="upload-display">
                                    <div class="upload-icon">üì∏</div>
                                    <div class="upload-text">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏£‡∏∑‡∏≠‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ</div>
                                    <div class="upload-info">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö JPG, PNG, PDF</div>
                                </div>
                                <div id="receipt-preview" class="receipt-preview" style="display: none;">
                                    <img id="receipt-image" src="" alt="Receipt preview">
                                    <div class="receipt-info">
                                        <span id="receipt-filename"></span>
                                        <button type="button" onclick="removeReceipt()" class="remove-receipt">√ó</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</label>
                            <textarea id="expense-notes" placeholder="‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..." rows="2"></textarea>
                        </div>
                        <div class="modal-actions">
                            <button type="button" class="btn-cancel" onclick="closeQuickExpenseModal()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                            <button type="submit" class="btn-save">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Cost Analysis Modal -->
            <div id="cost-analysis-modal" class="modal" style="display: none;" role="dialog" aria-modal="true" aria-labelledby="cost-analysis-title">
                <div class="modal-content cost-modal">
                    <div class="modal-header">
                        <h3 id="cost-analysis-title">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡πÄ‡∏°‡∏ô‡∏π</h3>
                        <button class="close-btn" onclick="closeCostAnalysisModal()">√ó</button>
                    </div>
                    <div class="cost-analysis-content" id="cost-analysis-content">
                        <!-- Cost analysis data will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Sales Screen -->
            <div id="sales-screen" class="screen">
                <div class="list-container">
                    <div class="list-header">
                        <h3 class="list-title">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</h3>
                        <button class="btn btn-small" onclick="refreshSalesReport()">‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</button>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3 id="sales-today" data-stat="sales">0</h3>
                            <p>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="sales-week" data-stat="sales">0</h3>
                            <p>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="sales-month" data-stat="sales">0</h3>
                            <p>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="avg-daily" data-stat="avg-order">0</h3>
                            <p>‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô</p>
                        </div>
                    </div>
                    <div id="sales-details-list" class="list-container">
                        <div class="list-header">
                            <h4>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h4>
                        </div>
                        <div id="recent-sales">
                            <!-- Recent sales will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Expenses Screen -->
            <div id="expenses-screen" class="screen">
                <div class="list-container">
                    <div class="list-header">
                        <h3 class="list-title">‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢ & ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</h3>
                        <button class="btn btn-small" onclick="showQuickExpenseModal()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</button>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3 id="expenses-today" data-stat="expenses">0</h3>
                            <p>‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="expenses-week" data-stat="expenses">0</h3>
                            <p>‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="expenses-month" data-stat="expenses">0</h3>
                            <p>‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="net-profit" data-stat="profit">0</h3>
                            <p>‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</p>
                        </div>
                    </div>
                    <div id="expense-details-list" class="list-container">
                        <div class="list-header">
                            <h4>‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h4>
                        </div>
                        <div id="recent-expenses">
                            <!-- Recent expenses will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Inventory Screen -->
            <div id="inventory-screen" class="screen">
                <div class="list-container">
                    <div class="list-header">
                        <h3 class="list-title">‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ï‡πä‡∏≠‡∏Å</h3>
                        <button class="btn btn-small" onclick="refreshInventory()">‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</button>
                    </div>
                    <div id="inventory-alerts-list">
                        <!-- Inventory alerts will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Reports Screen -->
            <div id="reports-screen" class="screen">
                <div class="list-container">
                    <div class="list-header">
                        <h3 class="list-title">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</h3>
                        <button class="btn btn-small" onclick="generateAllReports()">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
                    </div>
                    <div class="actions-grid" style="grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 20px;">
                        <button class="action-btn" onclick="showCostAnalysis()">
                            <div class="action-icon">üìä</div>
                            <div class="action-label">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô</div>
                        </button>
                        <button class="action-btn" onclick="generateReorderReport()">
                            <div class="action-icon">üì¶</div>
                            <div class="action-label">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</div>
                        </button>
                        <button class="action-btn" onclick="showPriceRecommendations()">
                            <div class="action-icon">üí°</div>
                            <div class="action-label">‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏£‡∏≤‡∏Ñ‡∏≤</div>
                        </button>
                        <button class="action-btn" onclick="calculateDailyProfit()">
                            <div class="action-icon">üßÆ</div>
                            <div class="action-label">‡∏Å‡∏≥‡πÑ‡∏£‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
                        </button>
                    </div>
                    <div id="reports-content">
                        <div class="alert alert-info">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏î‡∏π‡∏à‡∏≤‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô</div>
                    </div>
                </div>
            </div>

            <!-- Settings Screen -->
            <div id="settings-screen" class="screen">
                <div class="list-container">
                    <div class="list-header">
                        <h3 class="list-title">‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</h3>
                    </div>
                    <div class="form-container">
                        <div class="form-group">
                            <label>‡∏ä‡∏∑‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô:</label>
                            <input type="text" id="shop-name" value="ü•™ ‡∏£‡πâ‡∏≤‡∏ô Sandwich ‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏°" readonly>
                        </div>
                        <div class="form-group">
                            <label>‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏≠‡∏õ:</label>
                            <input type="text" id="app-version-display" value="1.0.0-refactor" readonly>
                        </div>
                        <div class="form-group">
                            <label>‡∏ò‡∏µ‡∏°‡∏™‡∏µ:</label>
                            <select id="theme-selector" onchange="changeTheme(this.value)">
                                <option value="purple">‡∏°‡πà‡∏ß‡∏á (‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô)</option>
                                <option value="blue">‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô</option>
                                <option value="green">‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏ï‡πä‡∏≠‡∏Å:</label>
                            <input type="number" id="stock-threshold" value="5" min="1" max="50">
                            <small>‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ (‡∏´‡∏ô‡πà‡∏ß‡∏¢)</small>
                        </div>
                        <div class="modal-actions">
                            <button class="btn-save" onclick="saveSettings()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
                            <button class="btn-cancel" onclick="resetSettings()">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
                        </div>
                    </div>
                    <div class="list-container" style="margin-top: 20px;">
                        <div class="list-header">
                            <h4>‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÅ‡∏≠‡∏õ</h4>
                        </div>
                        <div style="padding: 15px; color: #666; font-size: 14px; line-height: 1.6;">
                            <p><strong>ü•™ ‡∏£‡πâ‡∏≤‡∏ô Sandwich ‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏°</strong></p>
                            <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏ã‡∏ô‡∏î‡πå‡∏ß‡∏¥‡∏ä‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏£‡∏ö‡∏ß‡∏á‡∏à‡∏£</p>
                            <p>‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô: 1.0.0-refactor</p>
                            <p>¬© 2025 Sandwich ‡∏Å‡∏•‡∏° - ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢ ‚ù§Ô∏è</p>
                            <p>‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô: support@sandwich‡∏Å‡∏•‡∏°.com</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Navigation -->
    <div class="bottom-nav" role="navigation" aria-label="Primary">
            <div class="nav-items">
                <div class="nav-item active" onclick="switchScreen('dashboard-screen')">
                    <div class="nav-icon">üè†</div>
                    <div class="nav-label">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</div>
                </div>
                <div class="nav-item" onclick="switchScreen('pos-screen')">
                    <div class="nav-icon">üõí</div>
                    <div class="nav-label">‡∏Ç‡∏≤‡∏¢</div>
                </div>
                <div class="nav-item" onclick="switchScreen('inventory-screen')">
                    <div class="nav-icon">üì¶</div>
                    <div class="nav-label">‡∏™‡∏ï‡πä‡∏≠‡∏Å</div>
                </div>
                <div class="nav-item" onclick="switchScreen('reports-screen')">
                    <div class="nav-icon">üìä</div>
                    <div class="nav-label">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</div>
                </div>
                <div class="nav-item" onclick="switchScreen('settings-screen')">
                    <div class="nav-icon">‚öôÔ∏è</div>
                    <div class="nav-label">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</div>
                </div>
            </div>
        </div>

    <script>
        // IMMEDIATE FUNCTION DEFINITIONS FOR CRITICAL OPERATIONS
        // These must be available immediately when page loads

        window.switchScreen = function(screenId) {
            console.log('Switching to screen:', screenId);

            try {
                // Hide all screens
                document.querySelectorAll('.screen').forEach(screen => {
                    screen.classList.remove('active');
                });

                // Show target screen
                const targetScreen = document.getElementById(screenId);
                if (targetScreen) {
                    targetScreen.classList.add('active');
                    console.log('Screen activated:', screenId);
                } else {
                    console.error('Screen not found:', screenId);
                    return;
                }

                // Update navigation
                document.querySelectorAll('.nav-item').forEach(nav => {
                    nav.classList.remove('active');
                });

                // Find and activate corresponding nav item
                const navMap = {
                    'dashboard-screen': 0,
                    'pos-screen': 1,
                    'inventory-screen': 2,
                    'reports-screen': 3,
                    'settings-screen': 4
                };

                const navIndex = navMap[screenId];
                if (navIndex !== undefined) {
                    const navItems = document.querySelectorAll('.nav-item');
                    if (navItems[navIndex]) {
                        navItems[navIndex].classList.add('active');
                        console.log('Navigation updated for index:', navIndex);
                    }
                }

                // Load screen-specific data if functions are available
                if (typeof refreshDashboard === 'function' && screenId === 'dashboard-screen') {
                    refreshDashboard();
                } else if (typeof loadMenuItems === 'function' && screenId === 'pos-screen') {
                    loadMenuItems();
                }

            } catch (error) {
                console.error('Error switching screen:', error);
            }
        };

        // Other critical immediate functions
        window.showQuickExpenseModal = function() {
            const modal = document.getElementById('quick-expense-modal');
            if (modal) modal.classList.add('active');
            console.log('Quick expense modal shown');
        };

        window.closeQuickExpenseModal = function() {
            const modal = document.getElementById('quick-expense-modal');
            if (modal) modal.classList.remove('active');
            console.log('Quick expense modal closed');
        };

        window.showCostAnalysis = function() {
            const modal = document.getElementById('cost-analysis-modal');
            if (modal) modal.classList.add('active');
            console.log('Cost analysis modal shown');
        };

        window.closeCostAnalysisModal = function() {
            const modal = document.getElementById('cost-analysis-modal');
            if (modal) modal.classList.remove('active');
            console.log('Cost analysis modal closed');
        };

        window.checkout = function() {
            console.log('Checkout initiated');
            alert('‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏≠‡∏≤‡∏ó‡πå ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£...');
        };

        window.refreshDashboard = function() {
            console.log('Dashboard refreshed');
        };

        window.toggleMenu = function() {
            console.log('Menu toggled');
        };

        window.showAlerts = function() {
            console.log('Showing alerts');
            alert('üö® ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: ‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥');
        };

        window.generateFilteredReport = function() {
            console.log('Generating filtered report');
            alert('üìä ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô... ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà');
        };

        // Mobile Manager POS System - JavaScript

        // Global variables
        let currentCart = [];

        // DEBUG: Test if functions are working
        console.log('=== POS SYSTEM DEBUG ===');
        console.log('switchScreen function available:', typeof window.switchScreen);

        // Test DOM ready state
        if (document.readyState === 'loading') {
            console.log('DOM is still loading...');
        } else if (document.readyState === 'interactive') {
            console.log('DOM is interactive');
        } else if (document.readyState === 'complete') {
            console.log('DOM is fully loaded');
        }

        // Test if navigation elements exist
        document.addEventListener('DOMContentLoaded', function() {
            console.log('=== DOM READY TEST ===');
            const navItems = document.querySelectorAll('.nav-item');
            console.log('Navigation items found:', navItems.length);

            const screens = document.querySelectorAll('.screen');
            console.log('Screen elements found:', screens.length);

            navItems.forEach((item, index) => {
                console.log(`Nav item ${index}:`, item.onclick ? 'Has onclick' : 'No onclick');
            });

            // Ensure dashboard is active by default
            setTimeout(() => {
                console.log('Setting default screen to dashboard...');
                window.switchScreen('dashboard-screen');
            }, 100);
        });
        let menuItems = [];
        let dashboardData = {};
        let inventoryAlerts = [];
        let costAnalysisData = {};

        // Immediate function exposure for Apps Script compatibility
        // This ensures functions are available for onclick handlers immediately
        const exposeToWindow = function() {
            const functionsToExpose = [
                'switchScreen', 'refreshDashboard', 'showPriceRecommendations',
                'addDailyOperation', 'generateReorderReport', 'calculateDailyProfit',
                'toggleMenu', 'checkout', 'changeQuantity', 'showQuickExpenseModal',
                'closeQuickExpenseModal', 'removeReceipt', 'showCostAnalysis',
                'closeCostAnalysisModal', 'refreshInventory', 'showAlerts',
                'refreshSalesReport', 'loadExpensesScreen', 'generateAllReports',
                'changeTheme', 'saveSettings', 'resetSettings', 'loadSettings'
            ];

            // Create placeholder functions that will be replaced when the real functions are defined
            functionsToExpose.forEach(name => {
                if (!window[name]) {
                    window[name] = function(...args) {
                        // If real function exists, call it
                        if (window[name + '_real']) {
                            return window[name + '_real'](...args);
                        }
                        console.warn(`Function ${name} called before definition`);
                    };
                }
            });
        };
        exposeToWindow();

        // Enhanced utility functions
        function showMessage(message, type = 'success') {
            // Use new toast system instead of old message
            showToast('üì¢ ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô', message, type);
        }

        function formatCurrency(amount) {
            return new Intl.NumberFormat('th-TH', {
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        }

        // Smart Notification System
        let notifications = [];
        let toastCounter = 0;

        function showToast(title, message, type = 'info', duration = 5000) {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            const toastId = `toast-${++toastCounter}`;

            const icons = {
                success: '‚úÖ',
                error: '‚ùå',
                warning: '‚ö†Ô∏è',
                info: '‚ÑπÔ∏è'
            };

            toast.id = toastId;
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <div class="toast-header">
                    <span class="toast-icon">${icons[type] || icons.info}</span>
                    <h4 class="toast-title">${title}</h4>
                    <button class="toast-close" onclick="closeToast('${toastId}')">&times;</button>
                </div>
                <p class="toast-message">${message}</p>
            `;

            container.appendChild(toast);

            // Trigger animation
            setTimeout(() => toast.classList.add('show'), 100);

            // Auto close
            if (duration > 0) {
                setTimeout(() => closeToast(toastId), duration);
            }

            // Add to notification center
            addNotification(title, message, type);

            return toastId;
        }

        function closeToast(toastId) {
            const toast = document.getElementById(toastId);
            if (toast) {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }
        }

        function addNotification(title, message, type) {
            const notification = {
                id: Date.now(),
                title,
                message,
                type,
                timestamp: new Date(),
                read: false
            };

            notifications.unshift(notification);
            updateNotificationCenter();
        }

        function updateNotificationCenter() {
            const list = document.getElementById('notification-list');
            if (!list) return;

            list.innerHTML = notifications.map(notif => `
                <div class="notification-item ${!notif.read ? 'unread' : ''}" onclick="markAsRead(${notif.id})">
                    <div class="notification-header">
                        <strong>${notif.title}</strong>
                        <small>${notif.timestamp.toLocaleTimeString('th-TH')}</small>
                    </div>
                    <p>${notif.message}</p>
                </div>
            `).join('');

            // Update notification badge
            const unreadCount = notifications.filter(n => !n.read).length;
            const badge = document.getElementById('notification-badge');
            if (badge) {
                if (unreadCount > 0) {
                    badge.style.display = 'flex';
                    badge.textContent = unreadCount > 99 ? '99+' : unreadCount;
                } else {
                    badge.style.display = 'none';
                }
            }
        }

        function markAsRead(notifId) {
            const notif = notifications.find(n => n.id === notifId);
            if (notif) notif.read = true;
            updateNotificationCenter();
        }

        function toggleNotificationCenter() {
            const center = document.getElementById('notification-center');
            center.classList.toggle('open');
        }

        // Smart Business Alerts
        function checkBusinessAlerts() {
            const data = dashboardData || {};

            // Low sales alert
            const todaySales = data.sales?.todaySales || 0;
            if (todaySales < 1000 && new Date().getHours() > 14) {
                showToast('üìâ ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ï‡πà‡∏≥', '‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ ‡∏•‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô', 'warning', 8000);
            }

            // High profit day
            if (todaySales > 3000) {
                showToast('üéâ ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ!', '‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ‡∏°‡∏≤‡∏Å! ‡πÄ‡∏Å‡πá‡∏ö‡∏™‡∏π‡∏ï‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÑ‡∏ß‡πâ', 'success');
            }

            // Inventory alerts
            const alertsCount = data.inventory?.summary?.total || 0;
            if (alertsCount > 5) {
                showToast('üì¶ ‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏´‡∏°‡∏î', `‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ${alertsCount} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏¥‡∏°‡∏™‡∏ï‡πä‡∏≠‡∏Å`, 'warning');
            }

            // Peak hour reminder
            const hour = new Date().getHours();
            if (hour === 11) {
                showToast('‚è∞ ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≠‡∏á', '‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°! ‡∏ä‡πà‡∏ß‡∏á 11:00-14:00 ‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏™‡∏π‡∏á', 'info');
            }
        }

        // Advanced Analytics Alerts
        function analyzeBusinessPerformance() {
            const data = dashboardData || {};
            const analytics = data.sales?.analytics || {};

            // Growth analysis
            const growthRate = analytics.growthRate || 0;
            if (growthRate > 25) {
                showToast('üöÄ ‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï', `‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï ${growthRate}%! ‡∏Ñ‡∏ß‡∏£‡∏Ç‡∏¢‡∏≤‡∏¢‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏£‡πâ‡∏≤‡∏ô`, 'success', 10000);
            } else if (growthRate < -10) {
                showToast('üìä ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå', '‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏•‡∏î‡∏•‡∏á ‡∏Ñ‡∏ß‡∏£‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏°‡∏ô‡∏π', 'warning', 10000);
            }

            // Profit margin analysis
            const profitMargin = analytics.profitMargin || 0;
            if (profitMargin < 30) {
                showToast('üí∞ ‡∏Å‡∏≥‡πÑ‡∏£‡∏ï‡πà‡∏≥', '‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 30% ‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏Ñ‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô', 'warning');
            }

            // Menu performance
            const topProducts = data.sales?.topProducts || [];
            if (topProducts.length > 0) {
                const topProduct = topProducts[0];
                showToast('‚≠ê ‡πÄ‡∏°‡∏ô‡∏π‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°', `${topProduct.name} ‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î! ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏ï‡πä‡∏≠‡∏Å‡πÅ‡∏•‡∏∞‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ó`, 'info');
            }
        }

        // Advanced Filtering and Search
        let currentFilters = {
            startDate: null,
            endDate: null,
            dataType: 'all',
            searchTerm: ''
        };

        function applyFilters() {
            const startDate = document.getElementById('startDate')?.value;
            const endDate = document.getElementById('endDate')?.value;
            const dataType = document.getElementById('dataType')?.value;
            const searchTerm = document.getElementById('searchInput')?.value;

            currentFilters = {
                startDate: startDate || null,
                endDate: endDate || null,
                dataType: dataType || 'all',
                searchTerm: searchTerm || ''
            };

            // Update charts with filtered data
            updateDashboardCharts();

            showToast('üîç ‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á', '‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï', 'info', 3000);
        }

        function resetFilters() {
            document.getElementById('startDate').value = '';
            document.getElementById('endDate').value = '';
            document.getElementById('dataType').value = 'all';
            document.getElementById('searchInput').value = '';

            currentFilters = {
                startDate: null,
                endDate: null,
                dataType: 'all',
                searchTerm: ''
            };

            updateDashboardCharts();
            showToast('üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï', '‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡∏ñ‡∏π‡∏Å‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÅ‡∏•‡πâ‡∏ß', 'info', 3000);
        }

        function generateFilteredReport() {
            const filters = currentFilters;
            let reportData = '';

            reportData += `# ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥ ‡∏£‡πâ‡∏≤‡∏ô Sandwich ‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏°\n\n`;
            reportData += `üìÖ **‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:** ${filters.startDate || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'} - ${filters.endDate || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}\n`;
            reportData += `üìä **‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:** ${getDataTypeLabel(filters.dataType)}\n`;
            reportData += `üîç **‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤:** ${filters.searchTerm || '‡πÑ‡∏°‡πà‡∏°‡∏µ'}\n\n`;

            // Sales summary
            const data = dashboardData || {};
            if (filters.dataType === 'all' || filters.dataType === 'sales') {
                reportData += `## üìà ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢\n`;
                reportData += `- ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ: ${formatCurrency(data.sales?.todaySales || 0)} ‡∏ö‡∏≤‡∏ó\n`;
                reportData += `- ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏≠‡∏£‡πå‡πÄ‡∏î‡∏≠‡∏£‡πå: ${data.sales?.recentSales?.length || 0} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£\n`;
                reportData += `- ‡∏≠‡∏≠‡∏£‡πå‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢: ${formatCurrency(data.sales?.analytics?.averageOrderValue || 0)} ‡∏ö‡∏≤‡∏ó\n\n`;
            }

            // Top products
            if (data.sales?.topProducts?.length > 0) {
                reportData += `## üèÜ ‡πÄ‡∏°‡∏ô‡∏π‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°\n`;
                data.sales.topProducts.slice(0, 5).forEach((product, i) => {
                    reportData += `${i + 1}. ${product.name}: ${product.count} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£\n`;
                });
                reportData += '\n';
            }

            // Expenses summary
            if (filters.dataType === 'all' || filters.dataType === 'expenses') {
                reportData += `## üí∞ ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢\n`;
                reportData += `- ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ: ${formatCurrency(data.expenses?.totalExpenses || 0)} ‡∏ö‡∏≤‡∏ó\n\n`;
            }

            // Inventory alerts
            if (filters.dataType === 'all' || filters.dataType === 'inventory') {
                const alertsCount = data.inventory?.summary?.total || 0;
                reportData += `## üì¶ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏ï‡πä‡∏≠‡∏Å\n`;
                reportData += `- ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏¥‡∏°: ${alertsCount} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£\n\n`;
            }

            // Business insights
            reportData += `## üí° ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å\n`;
            const analytics = data.sales?.analytics || {};
            reportData += `- ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï: ${analytics.growthRate || 0}%\n`;
            reportData += `- ‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏ô: ${Math.round(analytics.profitMargin || 0)}%\n\n`;

            reportData += `---\n`;
            reportData += `üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢‡∏£‡∏∞‡∏ö‡∏ö ‡∏£‡πâ‡∏≤‡∏ô Sandwich ‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏°\n`;
            reportData += `üïê ${new Date().toLocaleString('th-TH')}\n`;

            // Create and download report
            downloadReport(reportData, `‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô-${new Date().toISOString().split('T')[0]}.md`);

            showToast('üìã ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô', '‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î...', 'success');
        }

        function getDataTypeLabel(type) {
            const labels = {
                'all': '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î',
                'sales': '‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢',
                'expenses': '‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢',
                'inventory': '‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤'
            };
            return labels[type] || '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤ÿ®';
        }

        function downloadReport(content, filename) {
            const blob = new Blob([content], { type: 'text/markdown;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }

        // Initialize filters with default values
        function initializeFilters() {
            const today = new Date();
            const weekAgo = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000);

            const startDateInput = document.getElementById('startDate');
            const endDateInput = document.getElementById('endDate');

            if (startDateInput && endDateInput) {
                startDateInput.value = weekAgo.toISOString().split('T')[0];
                endDateInput.value = today.toISOString().split('T')[0];

                // Apply initial filters
                setTimeout(applyFilters, 1000);
            }
        }

        // Calculate real-time cost and profit for cart items
        function calculateCartCostProfit() {
            let totalCost = 0;
            let totalSales = 0;

            currentCart.forEach(item => {
                const itemCost = getCostForMenuItem(item.id) * item.quantity;
                const itemSales = item.price * item.quantity;

                totalCost += itemCost;
                totalSales += itemSales;
            });

            const totalProfit = totalSales - totalCost;
            const profitMargin = totalSales > 0 ? (totalProfit / totalSales) * 100 : 0;

            return {
                totalCost,
                totalSales,
                totalProfit,
                profitMargin
            };
        }

        // Get cost for a specific menu item
        function getCostForMenuItem(menuId) {
            // This would normally fetch from the cost analysis data
            // For now, return estimated cost (can be enhanced with real data)
            const estimatedCosts = {
                'MENU005': 25, // ‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå‡∏Ñ‡∏•‡∏≤‡∏™‡∏™‡∏¥‡∏Å
                'MENU006': 35, // ‡∏î‡∏±‡∏ö‡πÄ‡∏ö‡∏¥‡πâ‡∏•‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå
                'MENU010': 40, // ‡πÅ‡∏Æ‡∏°‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå
                'MENU011': 45, // ‡πÄ‡∏ö‡∏Ñ‡∏≠‡∏ô‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå
                'MENU024': 8,  // ‡∏Å‡∏≤‡πÅ‡∏ü‡∏£‡πâ‡∏≠‡∏ô
                'MENU025': 10, // ‡∏Å‡∏≤‡πÅ‡∏ü‡πÄ‡∏¢‡πá‡∏ô
                'MENU001': 15, // ‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏õ‡∏¥‡πâ‡∏á‡πÄ‡∏ô‡∏¢‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á
                'MENU002': 18, // ‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏õ‡∏¥‡πâ‡∏á‡πÅ‡∏¢‡∏°‡∏™‡∏ï‡∏£‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà
                'MENU013': 50, // ‡∏ó‡∏π‡∏ô‡πà‡∏≤‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå
                'MENU012': 35, // ‡πÑ‡∏Å‡πà‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå
                'MENU015': 60  // ‡∏™‡∏∏‡∏û‡∏£‡∏µ‡∏°‡πÇ‡∏ó‡∏™‡∏ï‡πå
            };
            return estimatedCosts[menuId] || 20; // Default cost
        }

        // Update cost info panel
        function updateCostInfoPanel() {
            const costProfit = calculateCartCostProfit();

            document.getElementById('cart-cost').textContent = `‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô: ${formatCurrency(costProfit.totalCost)}‡∏ø`;
            document.getElementById('cart-profit').textContent = `‡∏Å‡∏≥‡πÑ‡∏£: ${formatCurrency(costProfit.totalProfit)}‡∏ø`;
            document.getElementById('profit-margin').textContent = `%‡∏Å‡∏≥‡πÑ‡∏£: ${Math.round(costProfit.profitMargin)}%`;

            // Update profit indicator
            const indicator = document.getElementById('profit-indicator');
            if (costProfit.profitMargin < 30) {
                indicator.className = 'profit-indicator low';
                indicator.textContent = 'üî¥';
            } else if (costProfit.profitMargin < 50) {
                indicator.className = 'profit-indicator medium';
                indicator.textContent = 'üü°';
            } else {
                indicator.className = 'profit-indicator high';
                indicator.textContent = 'üíö';
            }
        }

        function loadScreenData(screenId) {
            switch(screenId) {
                case 'dashboard-screen':
                    refreshDashboard();
                    break;
                case 'pos-screen':
                    loadMenuItems();
                    break;
                case 'inventory-screen':
                    loadInventoryAlerts();
                    break;
                case 'sales-screen':
                    refreshSalesReport();
                    break;
                case 'expenses-screen':
                    loadExpensesScreen();
                    break;
                case 'settings-screen':
                    loadSettings();
                    break;
            }
        }

        // Initialize database connection
        function initializeDatabase() {
            if (typeof DatabaseManager !== 'undefined' && typeof db !== 'undefined') {
                console.log('‚úÖ Database already initialized from database.js');
                return true;
            } else if (typeof DatabaseManager !== 'undefined') {
                console.log('‚úÖ Database initialized');
                return true;
            } else {
                console.error('‚ùå DatabaseManager not loaded');
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ', 'error');
                return false;
            }
        }

        // API functions using Supabase with DatabaseManager
        async function apiCall(action, params = {}, options = {}) {
            const { timeoutMs = 12000, silent = false } = options;

            if (!db) {
                if (!silent) showMessage('‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°', 'error');
                throw new Error('Database not initialized');
            }

            try {
                let result;

                // Map actions to DatabaseManager methods
                switch (action) {
                    case 'getDashboardData':
                        result = await db.getDashboardData();
                        break;
                    case 'addSale':
                        result = await db.addSale(params);
                        break;
                    case 'addExpense':
                        result = await db.addExpense(params);
                        break;
                    case 'updateInventory':
                        result = await db.updateInventory(params);
                        break;
                    case 'getRecentSales':
                        result = await db.getRecentSales(params);
                        break;
                    case 'getInventoryAlerts':
                        result = await db.getInventoryAlerts();
                        break;
                    case 'addDailyOperation':
                        result = await db.addDailyOperation(params);
                        break;
                    case 'generateReorderReport':
                        result = await db.generateReorderReport();
                        break;
                    default:
                        throw new Error(`Unknown action: ${action}`);
                }

                return { success: true, data: result };

            } catch (error) {
                console.error(`API call failed for action ${action}:`, error);
                if (!silent) showMessage(error.message || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', 'error');
                throw error;
            }
        }

        // Dashboard functions
        async function refreshDashboard() {
            try {
                const response = await apiCall('getDashboardData');
                if (response.success) {
                    dashboardData = response.data;
                    updateDashboardUI();

                    // Run smart business analysis
                    setTimeout(() => {
                        checkBusinessAlerts();
                        analyzeBusinessPerformance();
                    }, 1000);
                }
            } catch (error) {
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ', 'error');
            }
        }
    // ensure global
    window.refreshDashboard = refreshDashboard;

        function updateDashboardUI() {
            const data = dashboardData || {};
            // Collect values first (avoid layout thrash)
            const todaySales = formatCurrency(data.sales?.todaySales || 0);
            const monthExpenses = formatCurrency(data.expenses?.totalExpenses || 0);
            const alertsCount = data.inventory?.summary?.total || 0;
            const inventoryStatus = alertsCount > 0 ? '‚ö†Ô∏è' : 'OK';
            const analytics = data.sales?.analytics || {};
            const totalCustomers = formatCurrency(analytics.totalCustomers || 0);
            const totalOrders = formatCurrency(data.sales?.recentSales?.length || 0);
            const avgOrder = formatCurrency(analytics.averageOrderValue || 0);
            const profitMargin = Math.round(analytics.profitMargin || 0) + '%';

            // Batch DOM writes in a single animation frame
            requestAnimationFrame(() => {
                const ids = [
                    ['today-sales', todaySales],
                    ['month-expenses', monthExpenses],
                    ['alerts-count', alertsCount],
                    ['inventory-status', inventoryStatus],
                    ['today-customers', totalCustomers],
                    ['today-orders', totalOrders],
                    ['avg-order', avgOrder],
                    ['profit-margin', profitMargin]
                ];
                ids.forEach(([id, value]) => {
                    const el = document.getElementById(id);
                    if (el && el.textContent !== String(value)) el.textContent = value;
                });
                const invAlerts = document.getElementById('inventory-alerts');
                if (invAlerts) {
                    if (alertsCount > 0) {
                        invAlerts.style.display = 'block';
                        if (invAlerts.textContent !== String(alertsCount)) invAlerts.textContent = alertsCount;
                    } else {
                        invAlerts.style.display = 'none';
                    }
                }
            });

            // Update charts and insights after DOM updates
            setTimeout(() => {
                updateDashboardCharts();
                updateBusinessInsights();
            }, 100);
        }

        // Chart management and analytics
        let salesTrendChart, topProductsChart, profitAnalysisChart;

        function initializeCharts() {
            // Sales Trend Chart
            const salesCtx = document.getElementById('salesTrendChart');
            if (salesCtx) {
                salesTrendChart = new Chart(salesCtx, {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [{
                            label: '‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ (‡∏ö‡∏≤‡∏ó)',
                            data: [],
                            borderColor: '#8b5cf6',
                            backgroundColor: 'rgba(139, 92, 246, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            pointBackgroundColor: '#8b5cf6',
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 2,
                            pointRadius: 6,
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                backgroundColor: 'rgba(255, 255, 255, 0.95)',
                                titleColor: '#1f2937',
                                bodyColor: '#1f2937',
                                borderColor: '#8b5cf6',
                                borderWidth: 1,
                                callbacks: {
                                    label: function(context) {
                                        return `${context.parsed.y.toLocaleString()} ‡∏ö‡∏≤‡∏ó`;
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(139, 92, 246, 0.1)'
                                },
                                ticks: {
                                    callback: function(value) {
                                        return value.toLocaleString() + '‡∏ø';
                                    }
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
            }

            // Top Products Chart
            const topCtx = document.getElementById('topProductsChart');
            if (topCtx) {
                topProductsChart = new Chart(topCtx, {
                    type: 'doughnut',
                    data: {
                        labels: [],
                        datasets: [{
                            data: [],
                            backgroundColor: [
                                '#8b5cf6',
                                '#06b6d4',
                                '#10b981',
                                '#f59e0b',
                                '#ef4444'
                            ],
                            borderWidth: 0,
                            cutout: '60%'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 15,
                                    usePointStyle: true,
                                    font: {
                                        size: 12
                                    }
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `${context.label}: ${context.parsed} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`;
                                    }
                                }
                            }
                        }
                    }
                });
            }

            // Profit Analysis Chart
            const profitCtx = document.getElementById('profitAnalysisChart');
            if (profitCtx) {
                profitAnalysisChart = new Chart(profitCtx, {
                    type: 'bar',
                    data: {
                        labels: ['‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢', '‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô', '‡∏Å‡∏≥‡πÑ‡∏£'],
                        datasets: [{
                            data: [],
                            backgroundColor: ['#06b6d4', '#ef4444', '#10b981'],
                            borderRadius: 8,
                            borderSkipped: false,
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `${context.parsed.y.toLocaleString()} ‡∏ö‡∏≤‡∏ó`;
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return value.toLocaleString() + '‡∏ø';
                                    }
                                }
                            }
                        }
                    }
                });
            }
        }

        function updateDashboardCharts() {
            const data = dashboardData || {};

            // Update Sales Trend Chart
            if (salesTrendChart && data.sales?.analytics?.weeklyTrend) {
                const trend = data.sales.analytics.weeklyTrend;
                salesTrendChart.data.labels = trend.map(item => item.date);
                salesTrendChart.data.datasets[0].data = trend.map(item => item.sales);
                salesTrendChart.update('none');
            } else if (salesTrendChart) {
                // Generate sample data if no real data available
                const sampleDays = ['‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå', '‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£', '‡∏û‡∏∏‡∏ò', '‡∏û‡∏§‡∏´‡∏±‡∏™', '‡∏®‡∏∏‡∏Å‡∏£‡πå', '‡πÄ‡∏™‡∏≤‡∏£‡πå', '‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå'];
                const sampleData = [1200, 1350, 980, 1650, 2100, 2500, 1800];
                salesTrendChart.data.labels = sampleDays;
                salesTrendChart.data.datasets[0].data = sampleData;
                salesTrendChart.update('none');
            }

            // Update Top Products Chart
            if (topProductsChart && data.sales?.topProducts) {
                const topProducts = data.sales.topProducts.slice(0, 5);
                topProductsChart.data.labels = topProducts.map(item => item.name);
                topProductsChart.data.datasets[0].data = topProducts.map(item => item.count);
                topProductsChart.update('none');
            } else if (topProductsChart) {
                // Sample data
                topProductsChart.data.labels = ['‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå', '‡∏î‡∏±‡∏ö‡πÄ‡∏ö‡∏¥‡πâ‡∏•‡∏ä‡∏µ‡∏™', '‡πÅ‡∏Æ‡∏°‡∏ä‡∏µ‡∏™', '‡∏Å‡∏≤‡πÅ‡∏ü‡πÄ‡∏¢‡πá‡∏ô', '‡πÄ‡∏ö‡∏Ñ‡∏≠‡∏ô‡∏ä‡∏µ‡∏™'];
                topProductsChart.data.datasets[0].data = [25, 18, 15, 12, 8];
                topProductsChart.update('none');
            }

            // Update Profit Analysis Chart
            if (profitAnalysisChart) {
                const sales = data.sales?.todaySales || 2500;
                const costs = sales * 0.6; // Assume 60% cost ratio
                const profit = sales - costs;

                profitAnalysisChart.data.datasets[0].data = [sales, costs, profit];
                profitAnalysisChart.update('none');
            }
        }

        function updateBusinessInsights() {
            const data = dashboardData || {};

            // Growth insight
            const growthEl = document.getElementById('growth-insight');
            if (growthEl) {
                const growth = data.sales?.analytics?.growthRate || 15;
                if (growth > 20) {
                    growthEl.textContent = `‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï ${growth}% üöÄ ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏Å‡πâ‡∏≤‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏î‡∏µ‡∏°‡∏≤‡∏Å!`;
                } else if (growth > 0) {
                    growthEl.textContent = `‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï ${growth}% üìà ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏î‡∏µ!`;
                } else {
                    growthEl.textContent = `‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏•‡∏î‡∏•‡∏á ${Math.abs(growth)}% ‚ö° ‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå`;
                }
            }

            // Recommendation insight
            const recEl = document.getElementById('recommendation-insight');
            if (recEl) {
                const topProduct = data.sales?.topProducts?.[0]?.name || '‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå';
                recEl.textContent = `${topProduct} ‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°‡∏™‡∏∏‡∏î! ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏ï‡πä‡∏≠‡∏Å‡πÅ‡∏•‡∏∞‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ó`;
            }

            // Performance insight
            const perfEl = document.getElementById('performance-insight');
            if (perfEl) {
                const avgOrder = data.sales?.analytics?.averageOrderValue || 75;
                if (avgOrder > 100) {
                    perfEl.textContent = `‡∏≠‡∏≠‡∏£‡πå‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ ${avgOrder}‡∏ø üåü ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô!`;
                } else {
                    perfEl.textContent = `‡∏≠‡∏≠‡∏£‡πå‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ ${avgOrder}‡∏ø ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏Ç‡∏≤‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏° (upsell)`;
                }
            }

            // Tip insight
            const tipEl = document.getElementById('tip-insight');
            if (tipEl) {
                const tips = [
                    'üéØ ‡∏•‡∏≠‡∏á‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ó combo set ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢',
                    '‚è∞ ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤ 11:00-14:00 ‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏≠‡∏á',
                    'üì± ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° Facebook',
                    'üç∞ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π‡∏Ç‡∏ô‡∏°‡∏´‡∏ß‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á',
                    '‚òï ‡∏Å‡∏≤‡πÅ‡∏ü‡πÄ‡∏¢‡πá‡∏ô‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏™‡∏ä‡∏≤‡∏ï‡∏¥'
                ];
                tipEl.textContent = tips[Math.floor(Math.random() * tips.length)];
            }
        }

        // POS functions
        async function loadMenuItems() {
            try {
                const response = await apiCall('getMenuItems');
                if (response.success) {
                    menuItems = response.data;
                    displayMenuItems();
                }
            } catch (error) {
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏°‡∏ô‡∏π‡πÑ‡∏î‡πâ', 'error');
            }
        }

        function displayMenuItems() {
            const menuGrid = document.getElementById('menu-grid');
            menuGrid.innerHTML = '';

            menuItems.forEach(item => {
                const cost = getCostForMenuItem(item.id);
                const profit = item.price - cost;
                const profitMargin = (profit / item.price) * 100;

                const menuItem = document.createElement('button');
                menuItem.className = 'menu-item';
                menuItem.innerHTML = `
                    <div class="cost-badge">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô ${formatCurrency(cost)}‡∏ø</div>
                    <div class="profit-badge">${Math.round(profitMargin)}%</div>
                    <h3>${item.name}</h3>
                    <div class="price">${formatCurrency(item.price)} ‡∏ö‡∏≤‡∏ó</div>
                    <small style="color: rgba(255,255,255,0.8);">‡∏Å‡∏≥‡πÑ‡∏£ ${formatCurrency(profit)}‡∏ø</small>
                `;
                menuItem.onclick = () => addToCart(item);
                menuGrid.appendChild(menuItem);
            });
        }

        function addToCart(item) {
            const existingItem = currentCart.find(cartItem => cartItem.id === item.id);

            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                currentCart.push({
                    ...item,
                    quantity: 1
                });
            }

            updateCartDisplay();

            // Haptic feedback on mobile
            if (navigator.vibrate) {
                navigator.vibrate(50);
            }
        }

        function updateCartDisplay() {
            const cartItems = document.getElementById('cart-items');
            const cartTotal = document.getElementById('cart-total');
            const totalCostEl = document.getElementById('total-cost');
            const totalProfitEl = document.getElementById('total-profit');
            const checkoutBtn = document.getElementById('checkout-btn');
            const checkoutProfit = document.getElementById('checkout-profit');

            cartItems.innerHTML = '';

            if (currentCart.length === 0) {
                cartItems.innerHTML = '<div style="text-align: center; color: #666; padding: 20px;">‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á</div>';
                cartTotal.textContent = '0 ‡∏ö‡∏≤‡∏ó';
                totalCostEl.textContent = '0 ‡∏ö‡∏≤‡∏ó';
                totalProfitEl.textContent = '0 ‡∏ö‡∏≤‡∏ó';
                checkoutBtn.disabled = true;
                updateCostInfoPanel();
                return;
            }

            const costProfit = calculateCartCostProfit();

            currentCart.forEach((item, index) => {
                const itemTotal = item.price * item.quantity;
                const itemCost = getCostForMenuItem(item.id) * item.quantity;
                const itemProfit = itemTotal - itemCost;

                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                cartItem.innerHTML = `
                    <div class="cart-item-info">
                        <div class="cart-item-name">${item.name}</div>
                        <div class="cart-item-price">
                            ${formatCurrency(item.price)} x ${item.quantity} = ${formatCurrency(itemTotal)} ‡∏ö‡∏≤‡∏ó
                            <br><small style="color: #43e97b;">‡∏Å‡∏≥‡πÑ‡∏£: ${formatCurrency(itemProfit)} ‡∏ö‡∏≤‡∏ó</small>
                        </div>
                    </div>
                    <div class="quantity-controls">
                        <button class="qty-btn" onclick="changeQuantity(${index}, -1)">-</button>
                        <span class="quantity">${item.quantity}</span>
                        <button class="qty-btn" onclick="changeQuantity(${index}, 1)">+</button>
                    </div>
                `;
                cartItems.appendChild(cartItem);
            });

            cartTotal.textContent = `${formatCurrency(costProfit.totalSales)} ‡∏ö‡∏≤‡∏ó`;
            totalCostEl.textContent = `${formatCurrency(costProfit.totalCost)} ‡∏ö‡∏≤‡∏ó`;
            totalProfitEl.textContent = `${formatCurrency(costProfit.totalProfit)} ‡∏ö‡∏≤‡∏ó`;

            // Update profit row styling
            const profitRow = document.querySelector('.profit-row');
            if (costProfit.totalProfit < 0) {
                profitRow.classList.add('negative');
            } else {
                profitRow.classList.remove('negative');
            }

            checkoutProfit.textContent = `(+${formatCurrency(costProfit.totalProfit)})`;
            checkoutBtn.disabled = false;

            updateCostInfoPanel();
        }

        function changeQuantity(index, change) {
            const item = currentCart[index];
            item.quantity += change;

            if (item.quantity <= 0) {
                currentCart.splice(index, 1);
            }

            updateCartDisplay();
        }

        async function checkout() {
            if (currentCart.length === 0) {
                showMessage('‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á', 'error');
                return;
            }

            const checkoutBtn = document.getElementById('checkout-btn');
            checkoutBtn.disabled = true;
            checkoutBtn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...';

            try {
                const total = currentCart.reduce((sum, item) => sum + (item.price * item.quantity), 0);

                const response = await apiCall('processSale', {
                    items: currentCart,
                    total: total
                });

                if (response.success) {
                    showMessage('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
                    currentCart = [];
                    updateCartDisplay();
                    refreshDashboard();

                    // Haptic feedback
                    if (navigator.vibrate) {
                        navigator.vibrate([100, 50, 100]);
                    }
                } else {
                    throw new Error(response.error);
                }
            } catch (error) {
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ: ' + error.message, 'error');
            } finally {
                checkoutBtn.disabled = false;
                checkoutBtn.textContent = '‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô';
            }
        }

        // Inventory functions
        async function loadInventoryAlerts() {
            try {
                const response = await apiCall('getInventoryAlerts');
                if (response.success) {
                    inventoryAlerts = response.data;
                    displayInventoryAlerts();
                }
            } catch (error) {
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÑ‡∏î‡πâ', 'error');
            }
        }

        function displayInventoryAlerts() {
            const alertsList = document.getElementById('inventory-alerts-list');
            alertsList.innerHTML = '';
            const alertsArray = Array.isArray(inventoryAlerts.alerts) ? inventoryAlerts.alerts : (Array.isArray(inventoryAlerts) ? inventoryAlerts : []);
            if (alertsArray.length === 0) {
                alertsList.innerHTML = '<div class="alert alert-info">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô ‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏õ‡∏Å‡∏ï‡∏¥</div>';
                return;
            }

            alertsArray.forEach(alert => {
                const alertDiv = document.createElement('div');
                alertDiv.className = `alert alert-${alert.severity}`;
                alertDiv.textContent = alert.message;
                alertsList.appendChild(alertDiv);
            });
        }

        // Business management functions for solo shop owner

        function showQuickExpenseModal() {
            document.getElementById('quick-expense-modal').style.display = 'flex';
        }
        window.showQuickExpenseModal = showQuickExpenseModal; // Immediate exposure

        function closeQuickExpenseModal() {
            document.getElementById('quick-expense-modal').style.display = 'none';
            document.getElementById('quick-expense-form').reset();
            // Clear receipt preview
            removeReceipt();
        }

        // Receipt upload handling
        function handleReceiptUpload(input) {
            const file = input.files[0];
            if (file) {
                // Validate file size (max 5MB)
                if (file.size > 5 * 1024 * 1024) {
                    showMessage('‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 5MB)', 'error');
                    input.value = '';
                    return;
                }

                // Validate file type
                const allowedTypes = ['image/jpeg', 'image/png', 'image/jpg', 'application/pdf'];
                if (!allowedTypes.includes(file.type)) {
                    showMessage('‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÑ‡∏ü‡∏•‡πå JPG, PNG, PDF ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô', 'error');
                    input.value = '';
                    return;
                }

                // Show preview
                const reader = new FileReader();
                reader.onload = function(e) {
                    const uploadDisplay = document.querySelector('.upload-display');
                    const previewDiv = document.getElementById('receipt-preview');
                    const previewImage = document.getElementById('receipt-image');
                    const filenameSpan = document.getElementById('receipt-filename');

                    uploadDisplay.style.display = 'none';
                    previewDiv.style.display = 'flex';

                    if (file.type === 'application/pdf') {
                        previewImage.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTcgMThoMTBhMSAxIDAgMCAxIDEgMXYxYTEgMSAwIDAgMS0xIDFIN2ExIDEgMCAwIDEtMS0xdi0xYTEgMSAwIDAgMSAxLTFaIiBmaWxsPSIjZmY0NzU3Ii8+CjxwYXRoIGQ9Ik03IDE0aDE0YTEgMSAwIDAgMSAxIDF2MWExIDEgMCAwIDEtMSAxSDdhMSAxIDAgMCAxLTEtMXYtMWExIDEgMCAwIDEgMS0xWiIgZmlsbD0iI2ZmNDc1NyIvPgo8cGF0aCBkPSJNNyAxMGgxNmExIDEgMCAwIDEgMSAxdjFhMSAxIDAgMCAxLTEgMUg3YTEgMSAwIDAgMS0xLTF2LTFhMSAxIDAgMCAxIDEtMVoiIGZpbGw9IiNmZjQ3NTciLz4KPC9zdmc+';
                        previewImage.alt = 'PDF file';
                    } else {
                        previewImage.src = e.target.result;
                        previewImage.alt = 'Receipt preview';
                    }

                    filenameSpan.textContent = file.name;
                };
                reader.readAsDataURL(file);
            }
        }

        function removeReceipt() {
            const uploadDisplay = document.querySelector('.upload-display');
            const previewDiv = document.getElementById('receipt-preview');
            const fileInput = document.getElementById('receipt-file');

            uploadDisplay.style.display = 'block';
            previewDiv.style.display = 'none';
            fileInput.value = '';
        }

        // Handle quick expense form submission
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('quick-expense-form').addEventListener('submit', async function(e) {
                e.preventDefault();

                const fileInput = document.getElementById('receipt-file');
                const file = fileInput.files[0];

                const formData = {
                    store: document.getElementById('store-select').value,
                    items: document.getElementById('expense-items').value,
                    amount: parseFloat(document.getElementById('expense-amount').value),
                    type: document.getElementById('expense-type').value,
                    notes: document.getElementById('expense-notes').value || '',
                    date: new Date().toISOString().split('T')[0],
                    hasReceipt: file ? true : false,
                    receiptFilename: file ? file.name : '',
                    receiptStatus: file ? '‡∏°‡∏µ‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à' : '‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à'
                };

                // If there's a file, we would typically upload it to Google Drive here
                // For now, we'll just include the file info in the expense record
                if (file) {
                    // Create a realistic Google Drive-style URL with proper file ID
                    const fileId = 'EXP_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                    formData.receiptUrl = `https://drive.google.com/file/d/${fileId}/view`;

                    // In a real implementation, you would:
                    // 1. Upload file to Google Drive using DriveApp.createFile()
                    // 2. Set proper sharing permissions
                    // 3. Get the actual file ID and URL
                    // Example: const driveFile = DriveApp.createFile(file.getBlob());
                    //          formData.receiptUrl = driveFile.getUrl();
                }

                try {
                    const response = await apiCall('addExpense', formData);
                    if (response.success) {
                        showMessage('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
                        closeQuickExpenseModal();
                        refreshDashboard();
                    } else {
                        throw new Error(response.error);
                    }
                } catch (error) {
                    showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡πÑ‡∏î‡πâ: ' + error.message, 'error');
                }
            });
        });

        async function showCostAnalysis() {
            try {
                const response = await apiCall('calculateCostAnalysis');
                if (response.success) {
                    displayCostAnalysisModal(response.analysis);
                } else {
                    throw new Error(response.error);
                }
            } catch (error) {
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡πÑ‡∏î‡πâ', 'error');
            }
        }
        window.showCostAnalysis = showCostAnalysis; // Immediate exposure

        function displayCostAnalysisModal(analysisData) {
            const modal = document.getElementById('cost-analysis-modal');
            const content = document.getElementById('cost-analysis-content');

            content.innerHTML = '';

            analysisData.forEach(item => {
                const costItem = document.createElement('div');
                costItem.className = 'cost-item';

                const profitClass = item[8] < 30 ? 'low' : item[8] < 50 ? 'medium' : 'high';

                costItem.innerHTML = `
                    <div class="cost-item-info">
                        <h4>${item[2]}</h4>
                        <p>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢: ${formatCurrency(item[3])} ‡∏ö‡∏≤‡∏ó | ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô: ${formatCurrency(item[6])} ‡∏ö‡∏≤‡∏ó</p>
                    </div>
                    <div class="cost-item-values">
                        <div class="cost">‡∏Å‡∏≥‡πÑ‡∏£: ${formatCurrency(item[7])} ‡∏ö‡∏≤‡∏ó</div>
                        <div class="profit ${profitClass}">${item[8]}% ‡∏Å‡∏≥‡πÑ‡∏£</div>
                    </div>
                `;
                content.appendChild(costItem);
            });

            modal.style.display = 'flex';
        }

        function closeCostAnalysisModal() {
            document.getElementById('cost-analysis-modal').style.display = 'none';
        }

        async function calculateDailyProfit() {
            try {
                const today = new Date().toISOString().split('T')[0];
                const salesResponse = await apiCall('getSalesReport', { date: today });
                const expenseResponse = await apiCall('getExpenseSummary', {
                    startDate: today,
                    endDate: today
                });

                if (salesResponse.success && expenseResponse.success) {
                    const totalSales = salesResponse.data.totalSales || 0;
                    const totalExpenses = expenseResponse.data.totalExpenses || 0;
                    const netProfit = totalSales - totalExpenses;

                    const message = `‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ:\n` +
                                  `‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢: ${formatCurrency(totalSales)} ‡∏ö‡∏≤‡∏ó\n` +
                                  `‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢: ${formatCurrency(totalExpenses)} ‡∏ö‡∏≤‡∏ó\n` +
                                  `‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥: ${formatCurrency(netProfit)} ‡∏ö‡∏≤‡∏ó`;

                    alert(message);
                } else {
                    throw new Error('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Å‡∏≥‡πÑ‡∏£‡πÑ‡∏î‡πâ');
                }
            } catch (error) {
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Å‡∏≥‡πÑ‡∏£‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ', 'error');
            }
        }
        window.calculateDailyProfit = calculateDailyProfit; // Immediate exposure

        async function showPriceRecommendations() {
            try {
                const response = await apiCall('calculateCostAnalysis');
                if (response.success) {
                    const recommendations = response.analysis
                        .filter(item => item[8] < 40) // Less than 40% profit margin
                        .map(item => `${item[2]}: ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ ${item[9]}`)
                        .join('\n');

                    if (recommendations) {
                        alert('‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏Ñ‡∏≤:\n\n' + recommendations);
                    } else {
                        alert('‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏∏‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡πÅ‡∏•‡πâ‡∏ß! üëç');
                    }
                } else {
                    throw new Error(response.error);
                }
            } catch (error) {
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏£‡∏≤‡∏Ñ‡∏≤‡πÑ‡∏î‡πâ', 'error');
            }
        }
        window.showPriceRecommendations = showPriceRecommendations; // Immediate exposure

        function addDailyOperation() {
            const today = new Date().toISOString().split('T')[0];
            const targetSales = prompt('‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ (‡∏ö‡∏≤‡∏ó):');

            if (targetSales) {
                apiCall('addDailyOperation', {
                    date: today,
                    openTime: new Date().toTimeString().split(' ')[0],
                    targetSales: parseFloat(targetSales)
                }).then(response => {
                    if (response.success) {
                        showMessage('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
                        refreshDashboard();
                    }
                }).catch(error => {
                    showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏î‡πâ', 'error');
                });
            }
        }

        async function generateReorderReport() {
            try {
                const response = await apiCall('generateReorderReport');
                if (response.success) {
                    const report = response.data;
                    let message = `‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠:\n`;
                    message += `‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠: ${report.summary.totalItems} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£\n`;
                    message += `‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢: ${formatCurrency(report.summary.estimatedCost)} ‡∏ö‡∏≤‡∏ó`;

                    alert(message);
                } else {
                    throw new Error(response.error);
                }
            } catch (error) {
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ', 'error');
            }
        }
        window.generateReorderReport = generateReorderReport; // Immediate exposure

        function refreshInventory() {
            loadInventoryAlerts();
        }

        // New screen functions
        async function refreshSalesReport() {
            try {
                const response = await apiCall('getSalesReport');
                if (response.success) {
                    const data = response.data;
                    document.getElementById('sales-today').textContent = formatCurrency(data.todaySales || 0);
                    document.getElementById('sales-week').textContent = formatCurrency(data.weekSales || 0);
                    document.getElementById('sales-month').textContent = formatCurrency(data.monthSales || 0);
                    document.getElementById('avg-daily').textContent = formatCurrency(data.avgDaily || 0);

                    const recentSales = document.getElementById('recent-sales');
                    recentSales.innerHTML = '';
                    (data.recentSales || []).forEach(sale => {
                        const saleDiv = document.createElement('div');
                        saleDiv.className = 'list-item';
                        saleDiv.innerHTML = `
                            <div class="list-item-info">
                                <div class="list-item-title">${sale.date || '‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ'}</div>
                                <div class="list-item-subtitle">${sale.items || '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢'} - ${formatCurrency(sale.total || 0)} ‡∏ö‡∏≤‡∏ó</div>
                            </div>
                        `;
                        recentSales.appendChild(saleDiv);
                    });
                }
            } catch (error) {
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ', 'error');
            }
        }

        async function loadExpensesScreen() {
            try {
                const response = await apiCall('getRecentExpenses', { limit: 20 });
                if (response.success) {
                    const expenses = response.data;
                    const recentExpenses = document.getElementById('recent-expenses');
                    recentExpenses.innerHTML = '';

                    expenses.forEach(expense => {
                        const expenseDiv = document.createElement('div');
                        expenseDiv.className = 'list-item';
                        expenseDiv.innerHTML = `
                            <div class="list-item-info">
                                <div class="list-item-title">${expense.store || '‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤'}</div>
                                <div class="list-item-subtitle">${expense.items || '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£'} - ${formatCurrency(expense.amount || 0)} ‡∏ö‡∏≤‡∏ó</div>
                            </div>
                        `;
                        recentExpenses.appendChild(expenseDiv);
                    });
                }
            } catch (error) {
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡πÑ‡∏î‡πâ', 'error');
            }
        }

        function generateAllReports() {
            showMessage('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î...', 'info');
            Promise.all([
                showCostAnalysis(),
                generateReorderReport(),
                showPriceRecommendations()
            ]).then(() => {
                showMessage('‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô!', 'success');
            }).catch(() => {
                showMessage('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô', 'error');
            });
        }

        function changeTheme(theme) {
            // Theme changing functionality - placeholder for future enhancement
            showMessage(`‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ò‡∏µ‡∏°‡πÄ‡∏õ‡πá‡∏ô ${theme} ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡∏à‡∏∞‡∏°‡∏µ‡∏ú‡∏•‡πÉ‡∏ô‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ)`, 'info');
        }

        function saveSettings() {
            const shopName = document.getElementById('shop-name').value;
            const stockThreshold = document.getElementById('stock-threshold').value;
            const theme = document.getElementById('theme-selector').value;

            // Save to localStorage for now
            localStorage.setItem('shopSettings', JSON.stringify({
                shopName,
                stockThreshold: parseInt(stockThreshold),
                theme,
                lastUpdated: new Date().toISOString()
            }));

            showMessage('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
        }

        function resetSettings() {
            document.getElementById('shop-name').value = 'ü•™ ‡∏£‡πâ‡∏≤‡∏ô Sandwich ‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏°';
            document.getElementById('stock-threshold').value = '5';
            document.getElementById('theme-selector').value = 'purple';
            localStorage.removeItem('shopSettings');
            showMessage('‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡πâ‡∏ß', 'info');
        }

        function loadSettings() {
            const saved = localStorage.getItem('shopSettings');
            if (saved) {
                try {
                    const settings = JSON.parse(saved);
                    document.getElementById('shop-name').value = settings.shopName || 'ü•™ ‡∏£‡πâ‡∏≤‡∏ô Sandwich ‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏°';
                    document.getElementById('stock-threshold').value = settings.stockThreshold || 5;
                    document.getElementById('theme-selector').value = settings.theme || 'purple';
                } catch (e) {
                    console.warn('Failed to load settings:', e);
                }
            }
        }

        function refreshInventory() {
            loadInventoryAlerts();
        }

        function toggleMenu() {
            const panel = document.getElementById('utility-menu');
            if (!panel) return;
            const isOpen = panel.style.right === '0px';
            panel.style.right = isOpen ? '-260px' : '0px';
            panel.setAttribute('aria-hidden', isOpen ? 'true' : 'false');
        }
    window.toggleMenu = toggleMenu;

        function showAlerts() {
            // Show inventory alerts and other system alerts
            loadInventoryAlerts();
            showMessage('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î', 'info');
        }
        window.showAlerts = showAlerts; // Immediate exposure

        function closeCostAnalysisModal() {
            document.getElementById('cost-analysis-modal').style.display = 'none';
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize database connection first
            if (initializeDatabase()) {
                console.log('‚úÖ Database ready, loading application data');

                // Load initial data
                refreshDashboard();
                loadMenuItems();

                // Initialize charts after a short delay to ensure DOM is ready
                setTimeout(initializeCharts, 500);
            } else {
                console.error('‚ùå Database initialization failed');
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå', 'warning');

                // Still initialize UI components even if database fails
                setTimeout(initializeCharts, 500);
            }

            // Initialize filters with default date range (last 7 days)
            initializeFilters();

            // Prevent zoom on double tap
            let lastTouchEnd = 0;
            document.addEventListener('touchend', function (event) {
                const now = (new Date()).getTime();
                if (now - lastTouchEnd <= 300) {
                    event.preventDefault();
                }
                lastTouchEnd = now;
            }, false);

            // Auto refresh dashboard every 5 minutes
            setInterval(refreshDashboard, 300000);

            // Show welcome notification
            setTimeout(() => {
                showToast('üéâ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö!', '‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏ã‡∏ô‡∏î‡πå‡∏ß‡∏¥‡∏ä‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡∏°‡∏µ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà: ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á, ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞, ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', 'success', 8000);
            }, 2000);

            console.log('ü•™ ‡∏£‡πâ‡∏≤‡∏ô Sandwich ‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏° App initialized with enhanced analytics');
            // Expose functions globally (Apps Script sometimes isolates scope)
            Object.assign(window, {
                switchScreen,
                refreshDashboard,
                showPriceRecommendations,
                addDailyOperation,
                generateReorderReport,
                calculateDailyProfit,
                toggleMenu,
                checkout,
                changeQuantity,
                showQuickExpenseModal,
                closeQuickExpenseModal,
                removeReceipt,
                showCostAnalysis,
                closeCostAnalysisModal,
                refreshInventory,
                refreshSalesReport,
                loadExpensesScreen,
                generateAllReports,
                changeTheme,
                saveSettings,
                resetSettings,
                loadSettings,
                showAlerts,
                applyFilters,
                resetFilters,
                generateFilteredReport,
                toggleNotificationCenter,
                showToast
            });

            // Additional direct window assignments for critical functions
            // Note: switchScreen is already defined as window.switchScreen function above
            window.showQuickExpenseModal = showQuickExpenseModal;
            window.showCostAnalysis = showCostAnalysis;
            window.calculateDailyProfit = calculateDailyProfit;
            window.generateReorderReport = generateReorderReport;
            window.showPriceRecommendations = showPriceRecommendations;
            window.toggleMenu = toggleMenu;
            window.refreshDashboard = refreshDashboard;
            window.checkout = checkout;
            window.showAlerts = showAlerts;
        });
    </script>
</body>
</html>
