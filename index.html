<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ü•™ ‡∏£‡πâ‡∏≤‡∏ô Sandwich ‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏° - ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏ã‡∏ô‡∏î‡πå‡∏ß‡∏¥‡∏ä</title>

    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ü•™</text></svg>" type="image/svg+xml">

    <!-- Enhanced Font Loading Strategy for Reliable Icon Support -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Noto+Emoji:wght@300;400;500;600;700&family=Noto+Color+Emoji&display=swap" rel="stylesheet">

    <!-- Emoji and Icon Font Fallbacks -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <!-- Supabase client library -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <style>
        /* Modern Design System Variables */
        :root {
            /* Color Palette - Modern Gradient System */
            --primary-50: #f0f8ff;
            --primary-100: #e1f0fe;
            --primary-200: #bae1fc;
            --primary-300: #7cc8f9;
            --primary-400: #36abf3;
            --primary-500: #0c8ce9;
            --primary-600: #0070c7;
            --primary-700: #0159a2;
            --primary-800: #064c86;
            --primary-900: #0a406f;

            /* Secondary Colors - Warm Accent */
            --secondary-50: #fff7ed;
            --secondary-100: #ffedd5;
            --secondary-200: #fed7aa;
            --secondary-300: #fdba74;
            --secondary-400: #fb923c;
            --secondary-500: #f97316;
            --secondary-600: #ea580c;
            --secondary-700: #c2410c;
            --secondary-800: #9a3412;
            --secondary-900: #7c2d12;

            /* Neutral Colors - Sophisticated Grays */
            --gray-50: #f8fafc;
            --gray-100: #f1f5f9;
            --gray-200: #e2e8f0;
            --gray-300: #cbd5e1;
            --gray-400: #94a3b8;
            --gray-500: #64748b;
            --gray-600: #475569;
            --gray-700: #334155;
            --gray-800: #1e293b;
            --gray-900: #0f172a;

            /* Status Colors */
            --success-50: #f0fdf4;
            --success-500: #22c55e;
            --success-600: #16a34a;
            --warning-50: #fffbeb;
            --warning-500: #f59e0b;
            --warning-600: #d97706;
            --error-50: #fef2f2;
            --error-500: #ef4444;
            --error-600: #dc2626;

            /* Semantic Color Mapping */
            --background: var(--gray-50);
            --surface: #ffffff;
            --surface-elevated: #ffffff;
            --surface-glass: rgba(255, 255, 255, 0.8);
            --surface-overlay: rgba(15, 23, 42, 0.8);

            --text-primary: var(--gray-900);
            --text-secondary: var(--gray-600);
            --text-tertiary: var(--gray-400);
            --text-inverse: #ffffff;

            --border-subtle: var(--gray-200);
            --border-default: var(--gray-300);
            --border-strong: var(--gray-400);

            --primary: var(--primary-500);
            --primary-hover: var(--primary-600);
            --primary-active: var(--primary-700);
            --primary-subtle: var(--primary-50);

            --secondary: var(--secondary-500);
            --secondary-hover: var(--secondary-600);

            /* Typography Scale - Improved */
            --text-xs: 0.75rem;      /* 12px */
            --text-sm: 0.875rem;     /* 14px */
            --text-base: 1rem;       /* 16px */
            --text-lg: 1.125rem;     /* 18px */
            --text-xl: 1.25rem;      /* 20px */
            --text-2xl: 1.5rem;      /* 24px */
            --text-3xl: 1.875rem;    /* 30px */
            --text-4xl: 2.25rem;     /* 36px */
            --text-5xl: 3rem;        /* 48px */

            /* Font Weights */
            --font-light: 300;
            --font-normal: 400;
            --font-medium: 500;
            --font-semibold: 600;
            --font-bold: 700;
            --font-extrabold: 800;

            /* Spacing System (Refined 4px grid) */
            --space-0: 0;
            --space-1: 0.25rem;      /* 4px */
            --space-2: 0.5rem;       /* 8px */
            --space-3: 0.75rem;      /* 12px */
            --space-4: 1rem;         /* 16px */
            --space-5: 1.25rem;      /* 20px */
            --space-6: 1.5rem;       /* 24px */
            --space-7: 1.75rem;      /* 28px */
            --space-8: 2rem;         /* 32px */
            --space-9: 2.25rem;      /* 36px */
            --space-10: 2.5rem;      /* 40px */
            --space-12: 3rem;        /* 48px */
            --space-14: 3.5rem;      /* 56px */
            --space-16: 4rem;        /* 64px */
            --space-20: 5rem;        /* 80px */

            /* Border Radius - Modern Scale */
            --radius-none: 0;
            --radius-sm: 0.25rem;    /* 4px */
            --radius-base: 0.375rem; /* 6px */
            --radius-md: 0.5rem;     /* 8px */
            --radius-lg: 0.75rem;    /* 12px */
            --radius-xl: 1rem;       /* 16px */
            --radius-2xl: 1.5rem;    /* 24px */
            --radius-full: 9999px;

            /* Shadows - Refined */
            --shadow-xs: 0 1px 2px 0 rgba(15, 23, 42, 0.04);
            --shadow-sm: 0 1px 3px 0 rgba(15, 23, 42, 0.1), 0 1px 2px 0 rgba(15, 23, 42, 0.06);
            --shadow-md: 0 4px 6px -1px rgba(15, 23, 42, 0.1), 0 2px 4px -1px rgba(15, 23, 42, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(15, 23, 42, 0.1), 0 4px 6px -2px rgba(15, 23, 42, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(15, 23, 42, 0.1), 0 10px 10px -5px rgba(15, 23, 42, 0.04);
            --shadow-2xl: 0 25px 50px -12px rgba(15, 23, 42, 0.25);
            --shadow-glow: 0 0 20px rgba(12, 140, 233, 0.3);
            --shadow-colored: 0 8px 25px -8px rgba(12, 140, 233, 0.3);

            /* Gradients */
            --gradient-primary: linear-gradient(135deg, var(--primary-500), var(--primary-600));
            --gradient-secondary: linear-gradient(135deg, var(--secondary-500), var(--secondary-600));
            --gradient-surface: linear-gradient(145deg, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.7));
            --gradient-glass: linear-gradient(145deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));

            /* Animation & Transitions */
            --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-base: 200ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 300ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-bounce: 500ms cubic-bezier(0.68, -0.55, 0.265, 1.55);

            /* Touch Targets & Interactions - Mobile First */
            --touch-target-min: 44px;
            --touch-target-comfortable: 56px;
            --touch-target-large: 64px;

            /* Mobile-First Spacing System */
            --space-mobile-xs: 4px;
            --space-mobile-sm: 8px;
            --space-mobile-md: 12px;
            --space-mobile-lg: 16px;
            --space-mobile-xl: 20px;
            --space-mobile-2xl: 24px;
            --space-mobile-3xl: 32px;

            /* Mobile Typography Scale */
            --text-mobile-xs: 12px;
            --text-mobile-sm: 14px;
            --text-mobile-base: 16px;
            --text-mobile-lg: 18px;
            --text-mobile-xl: 20px;
            --text-mobile-2xl: 24px;
            --text-mobile-3xl: 30px;

            /* Mobile Layout Breakpoints */
            --mobile-sm: 360px;
            --mobile-md: 390px;
            --mobile-lg: 430px;
            --tablet: 768px;
            --desktop: 1024px;
        }

        /* Modern Reset & Base Styles */
        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            height: 100%;
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', 'Noto Emoji', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            background: var(--background);
            min-height: 100vh;
            min-height: 100dvh; /* Dynamic viewport height for mobile */
            color: var(--text-primary);
            line-height: 1.6;
            font-size: var(--text-mobile-base);
            font-weight: var(--font-normal);
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
            /* Enhanced emoji rendering */
            font-variant-emoji: emoji;
            /* Mobile optimizations */
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        /* Modern background with geometric pattern */
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background:
                radial-gradient(circle at 20% 80%, rgba(12, 140, 233, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(249, 115, 22, 0.06) 0%, transparent 50%),
                linear-gradient(135deg, var(--gray-50) 0%, rgba(248, 250, 252, 0.8) 100%);
            pointer-events: none;
            z-index: -1;
        }

        /* Modern scrollbar styling */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: var(--gray-100);
            border-radius: var(--radius-full);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--gray-300);
            border-radius: var(--radius-full);
            transition: var(--transition-base);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--gray-400);
        }

        /* Focus styles */
        :focus {
            outline: 2px solid var(--primary-500);
            outline-offset: 2px;
        }

        :focus:not(:focus-visible) {
            outline: none;
        }

        /* Selection styles */
        ::selection {
            background: var(--primary-200);
            color: var(--primary-800);
        }

        /* Layout Components */
        .app-container {
            max-width: 100vw;
            min-height: 100vh;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        /* Typography Utilities */
        .text-xs { font-size: var(--text-xs); }
        .text-sm { font-size: var(--text-sm); }
        .text-base { font-size: var(--text-base); }
        .text-lg { font-size: var(--text-lg); }
        .text-xl { font-size: var(--text-xl); }
        .text-2xl { font-size: var(--text-2xl); }
        .text-3xl { font-size: var(--text-3xl); }

        .font-normal { font-weight: var(--font-normal); }
        .font-medium { font-weight: var(--font-medium); }
        .font-semibold { font-weight: var(--font-semibold); }
        .font-bold { font-weight: var(--font-bold); }
        .font-extrabold { font-weight: var(--font-extrabold); }

        .text-primary { color: var(--text-primary); }
        .text-secondary { color: var(--text-secondary); }
        .text-tertiary { color: var(--text-tertiary); }

        /* Mobile-First Header Design */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: var(--surface-elevated);
            backdrop-filter: blur(20px);
            padding: var(--space-mobile-md) var(--space-mobile-lg);
            z-index: 1000;
            border-bottom: 1px solid var(--border-light);
            box-shadow: var(--shadow-sm);
            min-height: var(--touch-target-comfortable);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 100%;
        }

        .header-title {
            font-size: var(--text-mobile-lg);
            font-weight: var(--font-bold);
            color: var(--text-primary);
            margin: 0;
            display: flex;
            align-items: center;
            gap: var(--space-mobile-sm);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: calc(100vw - 100px);
        }

        .header-actions {
            display: flex;
            gap: var(--space-mobile-xs);
            align-items: center;
        }

        /* Desktop header adjustments */
        @media (min-width: 430px) {
            .header {
                padding: var(--space-3) var(--space-4);
                min-height: 60px;
            }

            .header-title {
                font-size: var(--text-lg);
                gap: var(--space-2);
                max-width: calc(100vw - 120px);
            }

            .header-actions {
                gap: var(--space-2);
            }
        }

        /* Professional Button System */
        .btn {
            /* Base button styles */
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-2);
            padding: var(--space-3) var(--space-4);
            border: none;
            border-radius: var(--radius-lg);
            font-family: inherit;
            font-weight: var(--font-medium);
            font-size: var(--text-sm);
            line-height: 1;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            min-height: var(--touch-target-min);
            position: relative;
            outline: none;
            user-select: none;
            -webkit-user-select: none;
        }

        .btn:focus-visible {
            outline: 2px solid var(--primary-500);
            outline-offset: 2px;
        }

        /* Button Variants */
        .btn-primary {
            background: var(--gradient-primary);
            color: var(--text-inverse);
            box-shadow: var(--shadow-md);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, var(--primary-600), var(--primary-500));
            box-shadow: var(--shadow-lg);
            transform: translateY(-1px);
        }

        .btn-primary:active {
            transform: translateY(0);
            box-shadow: var(--shadow-sm);
        }

        .btn-secondary {
            background: var(--surface-elevated);
            color: var(--primary-500);
            border: 1px solid var(--border-medium);
            box-shadow: var(--shadow-sm);
        }

        .btn-secondary:hover {
            background: var(--primary-50);
            border-color: var(--primary-500);
            box-shadow: var(--shadow-md);
            transform: translateY(-1px);
        }

        .btn-ghost {
            background: transparent;
            color: var(--text-secondary);
            border: 1px solid transparent;
        }

        .btn-ghost:hover {
            background: var(--primary-50);
            color: var(--primary-600);
        }

        /* Mobile-First Button Sizes */
        .btn-sm {
            padding: var(--space-mobile-md) var(--space-mobile-lg);
            font-size: var(--text-mobile-sm);
            min-height: var(--touch-target-min);
        }

        .btn-md {
            padding: var(--space-mobile-lg) var(--space-mobile-xl);
            font-size: var(--text-mobile-base);
            min-height: var(--touch-target-comfortable);
        }

        .btn-lg {
            padding: var(--space-mobile-xl) var(--space-mobile-2xl);
            font-size: var(--text-mobile-lg);
            min-height: var(--touch-target-large);
        }

        /* Mobile-Optimized Icon Buttons */
        .btn-icon {
            padding: var(--space-mobile-lg);
            aspect-ratio: 1;
            min-width: var(--touch-target-comfortable);
            min-height: var(--touch-target-comfortable);
        }

        .btn-icon-sm {
            padding: var(--space-mobile-md);
            min-width: var(--touch-target-min);
            min-height: var(--touch-target-min);
            font-size: var(--text-mobile-base);
        }

        /* Desktop button adjustments */
        @media (min-width: 768px) {
            .btn-sm {
                padding: var(--space-2) var(--space-3);
                font-size: var(--text-xs);
                min-height: 36px;
            }

            .btn-md {
                padding: var(--space-3) var(--space-4);
                font-size: var(--text-sm);
            }

            .btn-lg {
                padding: var(--space-4) var(--space-6);
                font-size: var(--text-base);
            }

            .btn-icon {
                padding: var(--space-3);
                min-width: var(--touch-target-min);
                min-height: var(--touch-target-min);
            }

            .btn-icon-sm {
                padding: var(--space-2);
                min-width: 36px;
                font-size: var(--text-sm);
            }
        }

        /* Mobile Touch Enhancements */
        .btn {
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }

        .btn:active {
            transform: scale(0.98);
        }

        @media (hover: hover) {
            .btn:active {
                transform: translateY(0) scale(0.98);
            }
        }

        /* Button States */
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            pointer-events: none;
        }

        .btn-loading {
            color: transparent;
        }

        .btn-loading::after {
            content: "";
            position: absolute;
            width: 16px;
            height: 16px;
            border: 2px solid currentColor;
            border-radius: 50%;
            border-top-color: transparent;
            animation: button-loading 0.8s linear infinite;
        }

        @keyframes button-loading {
            to { transform: rotate(360deg); }
        }

        /* ====================================
           MODERN LAYOUT SYSTEM
        ==================================== */

        /* Main App Layout - Mobile-First Grid */
        .app-layout {
            display: grid;
            grid-template-areas:
                "header"
                "main"
                "nav";
            grid-template-rows: auto 1fr auto;
            min-height: 100vh;
            min-height: 100dvh;
            background: var(--background);
        }

        /* Desktop Layout */
        @media (min-width: 768px) {
            .app-layout {
                grid-template-areas:
                    "sidebar header"
                    "sidebar main";
                grid-template-columns: 280px 1fr;
                grid-template-rows: auto 1fr;
                max-height: 100vh;
                overflow: hidden;
            }
        }

        /* Large Desktop Layout */
        @media (min-width: 1200px) {
            .app-layout {
                grid-template-columns: 320px 1fr;
            }
        }

        /* Header Redesign */
        .app-header {
            grid-area: header;
            background: var(--surface-elevated);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-subtle);
            padding: var(--space-4) var(--space-6);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow-xs);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-brand {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            font-weight: var(--font-bold);
            font-size: var(--text-xl);
            color: var(--text-primary);
        }

        .header-brand .brand-icon {
            width: 32px;
            height: 32px;
            background: var(--gradient-primary);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--text-lg);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }

        .notification-btn {
            position: relative;
            background: var(--surface);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-lg);
            padding: var(--space-3);
            cursor: pointer;
            transition: var(--transition-fast);
        }

        .notification-btn:hover {
            background: var(--primary-50);
            border-color: var(--primary-200);
        }

        .notification-badge {
            position: absolute;
            top: -4px;
            right: -4px;
            background: var(--error-500);
            color: white;
            font-size: 10px;
            font-weight: var(--font-bold);
            padding: 2px 6px;
            border-radius: var(--radius-full);
            min-width: 18px;
            text-align: center;
        }

        /* Sidebar Navigation - Desktop */
        .app-sidebar {
            grid-area: sidebar;
            background: var(--surface-elevated);
            border-right: 1px solid var(--border-subtle);
            padding: var(--space-6);
            overflow-y: auto;
            display: none;
        }

        @media (min-width: 768px) {
            .app-sidebar {
                display: block;
            }
        }

        .sidebar-section {
            margin-bottom: var(--space-8);
        }

        .sidebar-section-title {
            font-size: var(--text-xs);
            font-weight: var(--font-semibold);
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: var(--space-4);
            padding: 0 var(--space-3);
        }

        .nav-menu {
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .nav-item {
            margin-bottom: var(--space-1);
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-3) var(--space-4);
            border-radius: var(--radius-lg);
            color: var(--text-secondary);
            text-decoration: none;
            transition: all var(--transition-fast);
            font-weight: var(--font-medium);
            position: relative;
        }

        .nav-link:hover {
            background: var(--primary-50);
            color: var(--primary-600);
            transform: translateX(4px);
        }

        .nav-link.active {
            background: var(--gradient-primary);
            color: white;
            box-shadow: var(--shadow-colored);
        }

        .nav-link.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 3px;
            height: 24px;
            background: white;
            border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--text-base);
        }

        .nav-label {
            flex: 1;
            font-size: var(--text-sm);
        }

        .nav-badge {
            background: var(--error-100);
            color: var(--error-600);
            font-size: 10px;
            font-weight: var(--font-bold);
            padding: 2px 6px;
            border-radius: var(--radius-full);
            min-width: 18px;
            text-align: center;
        }

        .nav-link.active .nav-badge {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        /* Main Content Area */
        .app-main {
            grid-area: main;
            padding: var(--space-6);
            overflow-y: auto;
            background: var(--background);
        }

        @media (min-width: 768px) {
            .app-main {
                padding: var(--space-8);
            }
        }

        /* Page Header */
        .page-header {
            margin-bottom: var(--space-8);
        }

        .page-title {
            font-size: var(--text-3xl);
            font-weight: var(--font-bold);
            color: var(--text-primary);
            margin: 0 0 var(--space-2) 0;
        }

        .page-subtitle {
            color: var(--text-secondary);
            font-size: var(--text-lg);
            margin: 0;
            line-height: 1.5;
        }

        .page-actions {
            margin-top: var(--space-6);
            display: flex;
            gap: var(--space-4);
            flex-wrap: wrap;
        }

        /* Content Grid System */
        .content-grid {
            display: grid;
            gap: var(--space-6);
            grid-template-columns: 1fr;
        }

        @media (min-width: 768px) {
            .content-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: var(--space-8);
            }
        }

        @media (min-width: 1200px) {
            .content-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .content-grid.grid-2 {
            grid-template-columns: 1fr;
        }

        @media (min-width: 768px) {
            .content-grid.grid-2 {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .content-grid.grid-4 {
            grid-template-columns: 1fr;
        }

        @media (min-width: 576px) {
            .content-grid.grid-4 {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1200px) {
            .content-grid.grid-4 {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        /* Professional Card System */
        .card {
            background: var(--surface-elevated);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-xl);
            padding: var(--space-6);
            box-shadow: var(--shadow-sm);
            transition: all var(--transition-base);
            position: relative;
            overflow: hidden;
        }

        .card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
            border-color: var(--border-default);
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-4);
        }

        .card-title {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin: 0;
        }

        .card-subtitle {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            margin: 0;
        }

        .card-content {
            color: var(--text-primary);
        }

        .card-footer {
            margin-top: var(--space-4);
            padding-top: var(--space-4);
            border-top: 1px solid var(--border-light);
        }

        /* Stat Cards */
        .stat-card {
            background: linear-gradient(135deg, var(--surface-elevated), var(--surface-secondary));
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-xl);
            padding: var(--space-5);
            position: relative;
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .stat-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(135deg, var(--primary-purple), var(--primary-purple-light));
            border-radius: var(--radius-xl) var(--radius-xl) 0 0;
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
            border-color: var(--border-medium);
        }

        .stat-card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-3);
        }

        .stat-card-icon {
            width: 40px;
            height: 40px;
            background: var(--secondary-purple);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--text-lg);
        }

        .stat-card-value {
            font-size: var(--text-2xl);
            font-weight: var(--font-bold);
            color: var(--text-primary);
            margin: 0;
            line-height: 1.2;
        }

        .stat-card-label {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            margin: 0;
            font-weight: var(--font-medium);
        }

        .stat-card-trend {
            font-size: var(--text-xs);
            font-weight: var(--font-semibold);
            padding: var(--space-1) var(--space-2);
            border-radius: var(--radius-sm);
            margin-top: var(--space-2);
            display: inline-block;
        }

        .stat-card-trend.positive {
            background: var(--success-50);
            color: var(--success-600);
        }

        .stat-card-trend.negative {
            background: var(--error-50);
            color: var(--error-600);
        }

        /* Enhanced Forms */
        .form-group {
            margin-bottom: var(--space-5);
        }

        .form-label {
            display: block;
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--text-primary);
            margin-bottom: var(--space-2);
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: var(--space-3) var(--space-4);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-lg);
            background: var(--surface);
            color: var(--text-primary);
            font-size: var(--text-base);
            font-family: inherit;
            transition: all var(--transition-fast);
            min-height: var(--touch-target-min);
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--primary-500);
            box-shadow: 0 0 0 3px rgba(12, 140, 233, 0.1);
        }

        .form-input::placeholder {
            color: var(--text-tertiary);
        }

        .form-textarea {
            resize: vertical;
            min-height: 120px;
        }

        /* Mobile Bottom Navigation */
        .mobile-nav {
            grid-area: nav;
            background: var(--surface-elevated);
            border-top: 1px solid var(--border-subtle);
            padding: var(--space-2) var(--space-3);
            display: flex;
            justify-content: space-around;
            align-items: center;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            bottom: 0;
            z-index: 100;
        }

        @media (min-width: 768px) {
            .mobile-nav {
                display: none;
            }
        }

        .mobile-nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: var(--space-1);
            padding: var(--space-2);
            border-radius: var(--radius-lg);
            color: var(--text-secondary);
            text-decoration: none;
            transition: all var(--transition-fast);
            min-width: var(--touch-target-min);
            min-height: var(--touch-target-min);
            position: relative;
        }

        .mobile-nav-item:hover,
        .mobile-nav-item.active {
            color: var(--primary-600);
            background: var(--primary-50);
        }

        .mobile-nav-item.active::before {
            content: '';
            position: absolute;
            top: -2px;
            left: 50%;
            transform: translateX(-50%);
            width: 24px;
            height: 3px;
            background: var(--gradient-primary);
            border-radius: 0 0 var(--radius-sm) var(--radius-sm);
        }

        .mobile-nav-icon {
            font-size: var(--text-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
        }

        .mobile-nav-label {
            font-size: 10px;
            font-weight: var(--font-medium);
            text-align: center;
            line-height: 1;
        }

        .mobile-nav-badge {
            position: absolute;
            top: 6px;
            right: 6px;
            background: var(--error-500);
            color: white;
            font-size: 8px;
            font-weight: var(--font-bold);
            padding: 1px 4px;
            border-radius: var(--radius-full);
            min-width: 14px;
            text-align: center;
            line-height: 1.2;
        }

        /* Enhanced Modals */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--surface-overlay);
            backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: var(--space-4);
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all var(--transition-base);
        }

        .modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--surface-elevated);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-2xl);
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            transform: scale(0.95) translateY(20px);
            transition: all var(--transition-base);
        }

        .modal.active .modal-content {
            transform: scale(1) translateY(0);
        }

        .modal-header {
            padding: var(--space-6) var(--space-6) var(--space-4) var(--space-6);
            border-bottom: 1px solid var(--border-subtle);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-title {
            font-size: var(--text-xl);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin: 0;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: var(--text-xl);
            color: var(--text-secondary);
            cursor: pointer;
            padding: var(--space-2);
            border-radius: var(--radius-md);
            transition: var(--transition-fast);
        }

        .modal-close:hover {
            background: var(--gray-100);
            color: var(--text-primary);
        }

        .modal-body {
            padding: var(--space-6);
        }

        .modal-footer {
            padding: var(--space-4) var(--space-6) var(--space-6) var(--space-6);
            border-top: 1px solid var(--border-subtle);
            display: flex;
            gap: var(--space-3);
            justify-content: flex-end;
        }

        /* Enhanced Alerts & Toasts */
        .alert {
            padding: var(--space-4) var(--space-5);
            border-radius: var(--radius-lg);
            border: 1px solid;
            display: flex;
            align-items: flex-start;
            gap: var(--space-3);
            margin-bottom: var(--space-4);
        }

        .alert-success {
            background: var(--success-50);
            border-color: var(--success-200);
            color: var(--success-800);
        }

        .alert-warning {
            background: var(--warning-50);
            border-color: var(--warning-200);
            color: var(--warning-800);
        }

        .alert-error {
            background: var(--error-50);
            border-color: var(--error-200);
            color: var(--error-800);
        }

        .alert-info {
            background: var(--primary-50);
            border-color: var(--primary-200);
            color: var(--primary-800);
        }

        .alert-icon {
            flex-shrink: 0;
            font-size: var(--text-lg);
        }

        .alert-content {
            flex: 1;
        }

        .alert-title {
            font-weight: var(--font-semibold);
            margin: 0 0 var(--space-1) 0;
        }

        .alert-message {
            margin: 0;
            font-size: var(--text-sm);
            line-height: 1.5;
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            top: var(--space-4);
            right: var(--space-4);
            z-index: 1100;
            display: flex;
            flex-direction: column;
            gap: var(--space-3);
            max-width: 400px;
        }

        .toast {
            background: var(--surface-elevated);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            padding: var(--space-4);
            display: flex;
            align-items: flex-start;
            gap: var(--space-3);
            transform: translateX(100%);
            transition: all var(--transition-base);
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast-icon {
            flex-shrink: 0;
            width: 20px;
            height: 20px;
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--text-sm);
            color: white;
        }

        .toast-success .toast-icon {
            background: var(--success-500);
        }

        .toast-warning .toast-icon {
            background: var(--warning-500);
        }

        .toast-error .toast-icon {
            background: var(--error-500);
        }

        .toast-info .toast-icon {
            background: var(--primary-500);
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: var(--font-semibold);
            font-size: var(--text-sm);
            color: var(--text-primary);
            margin: 0 0 var(--space-1) 0;
        }

        .toast-message {
            font-size: var(--text-xs);
            color: var(--text-secondary);
            margin: 0;
            line-height: 1.4;
        }

        .toast-close {
            background: none;
            border: none;
            color: var(--text-tertiary);
            cursor: pointer;
            padding: var(--space-1);
            border-radius: var(--radius-sm);
            transition: var(--transition-fast);
        }

        .toast-close:hover {
            background: var(--gray-100);
            color: var(--text-secondary);
        }

        /* ====================================
           ANIMATIONS & MICRO-INTERACTIONS
        ==================================== */

        /* Loading Animations */
        .loading-spinner {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-subtle);
            border-top: 2px solid var(--primary-500);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-dots {
            display: inline-flex;
            gap: 4px;
            align-items: center;
        }

        .loading-dots::before,
        .loading-dots::after {
            content: '';
            width: 4px;
            height: 4px;
            background: currentColor;
            border-radius: 50%;
            animation: loading-dots 1.5s ease-in-out infinite;
        }

        .loading-dots::before {
            animation-delay: 0s;
        }

        .loading-dots::after {
            animation-delay: 0.3s;
        }

        @keyframes loading-dots {
            0%, 60%, 100% {
                opacity: 0.3;
                transform: scale(0.8);
            }
            30% {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* Fade In Animations */
        .fade-in {
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .slide-in-right {
            animation: slideInRight 0.3s ease-out;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .slide-in-left {
            animation: slideInLeft 0.3s ease-out;
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Scale Animation */
        .scale-in {
            animation: scaleIn 0.2s ease-out;
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* Bounce Animation */
        .bounce-in {
            animation: bounceIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes bounceIn {
            0% {
                opacity: 0;
                transform: scale(0.3);
            }
            50% {
                opacity: 1;
                transform: scale(1.05);
            }
            70% {
                transform: scale(0.9);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* Shake Animation for Errors */
        .shake {
            animation: shake 0.4s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-4px); }
            20%, 40%, 60%, 80% { transform: translateX(4px); }
        }

        /* Pulse Animation */
        .pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.7;
            }
        }

        /* Gradient Animation */
        .gradient-animate {
            background-size: 200% 200%;
            animation: gradientShift 3s ease infinite;
        }

        @keyframes gradientShift {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }

        /* Hover Effects */
        .hover-lift {
            transition: all var(--transition-base);
        }

        .hover-lift:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }

        .hover-glow {
            transition: all var(--transition-base);
        }

        .hover-glow:hover {
            box-shadow: var(--shadow-glow);
        }

        /* Progress Indicators */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--gray-200);
            border-radius: var(--radius-full);
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            background: var(--gradient-primary);
            border-radius: var(--radius-full);
            transition: width var(--transition-slow);
            position: relative;
            overflow: hidden;
        }

        .progress-bar-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.3),
                transparent
            );
            transform: translateX(-100%);
            animation: progressShimmer 2s infinite;
        }

        @keyframes progressShimmer {
            0% {
                transform: translateX(-100%);
            }
            100% {
                transform: translateX(100%);
            }
        }

        /* ====================================
           ENHANCED RESPONSIVE DESIGN
        ==================================== */

        /* Mobile-First Breakpoint System */
        @media (max-width: 374px) {
            .app-main {
                padding: var(--space-4);
            }

            .page-title {
                font-size: var(--text-mobile-2xl);
            }

            .content-grid {
                gap: var(--space-4);
            }

            .card {
                padding: var(--space-4);
            }
        }

        @media (min-width: 375px) and (max-width: 767px) {
            .header-brand {
                font-size: var(--text-mobile-lg);
            }

            .page-title {
                font-size: var(--text-mobile-3xl);
            }
        }

        @media (min-width: 768px) {
            .page-title {
                font-size: var(--text-4xl);
            }

            .stat-card-icon {
                width: 48px;
                height: 48px;
            }

            .stat-card-value {
                font-size: var(--text-3xl);
            }
        }

        @media (min-width: 1024px) {
            .app-main {
                padding: var(--space-10);
            }

            .content-grid {
                gap: var(--space-8);
            }

            .page-title {
                font-size: var(--text-5xl);
            }
        }

        /* High-DPI Display Optimizations */
        @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
            .header-brand .brand-icon {
                background-size: 100% 100%;
            }
        }

        /* Dark Mode Support (Future Implementation) */
        @media (prefers-color-scheme: dark) {
            :root {
                --background: var(--gray-900);
                --surface: var(--gray-800);
                --surface-elevated: var(--gray-700);
                --text-primary: var(--gray-100);
                --text-secondary: var(--gray-300);
                --text-tertiary: var(--gray-400);
                --border-subtle: var(--gray-700);
                --border-default: var(--gray-600);
            }
        }

        /* Reduced Motion Support */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }

            .hover-lift:hover {
                transform: none;
            }
        }

        /* Print Styles */
        @media print {
            .mobile-nav,
            .app-sidebar,
            .header-actions,
            .modal,
            .toast-container {
                display: none !important;
            }

            .app-layout {
                grid-template-areas: "main";
                grid-template-columns: 1fr;
            }

            .card {
                box-shadow: none;
                border: 1px solid var(--gray-300);
            }
        }

        /* ====================================
           UTILITY CLASSES
        ==================================== */

        /* Display */
        .d-none { display: none !important; }
        .d-block { display: block !important; }
        .d-flex { display: flex !important; }
        .d-grid { display: grid !important; }
        .d-inline { display: inline !important; }
        .d-inline-block { display: inline-block !important; }
        .d-inline-flex { display: inline-flex !important; }

        /* Flexbox */
        .flex-row { flex-direction: row !important; }
        .flex-column { flex-direction: column !important; }
        .flex-wrap { flex-wrap: wrap !important; }
        .flex-nowrap { flex-wrap: nowrap !important; }
        .justify-start { justify-content: flex-start !important; }
        .justify-center { justify-content: center !important; }
        .justify-end { justify-content: flex-end !important; }
        .justify-between { justify-content: space-between !important; }
        .justify-around { justify-content: space-around !important; }
        .align-start { align-items: flex-start !important; }
        .align-center { align-items: center !important; }
        .align-end { align-items: flex-end !important; }
        .align-stretch { align-items: stretch !important; }
        .flex-grow-1 { flex-grow: 1 !important; }
        .flex-shrink-0 { flex-shrink: 0 !important; }

        /* Grid */
        .grid-cols-1 { grid-template-columns: repeat(1, 1fr) !important; }
        .grid-cols-2 { grid-template-columns: repeat(2, 1fr) !important; }
        .grid-cols-3 { grid-template-columns: repeat(3, 1fr) !important; }
        .grid-cols-4 { grid-template-columns: repeat(4, 1fr) !important; }
        .col-span-2 { grid-column: span 2 !important; }
        .col-span-3 { grid-column: span 3 !important; }
        .col-span-4 { grid-column: span 4 !important; }

        /* Spacing */
        .m-0 { margin: 0 !important; }
        .m-1 { margin: var(--space-1) !important; }
        .m-2 { margin: var(--space-2) !important; }
        .m-3 { margin: var(--space-3) !important; }
        .m-4 { margin: var(--space-4) !important; }
        .m-5 { margin: var(--space-5) !important; }
        .m-6 { margin: var(--space-6) !important; }
        .mx-auto { margin-left: auto !important; margin-right: auto !important; }
        .my-auto { margin-top: auto !important; margin-bottom: auto !important; }

        .p-0 { padding: 0 !important; }
        .p-1 { padding: var(--space-1) !important; }
        .p-2 { padding: var(--space-2) !important; }
        .p-3 { padding: var(--space-3) !important; }
        .p-4 { padding: var(--space-4) !important; }
        .p-5 { padding: var(--space-5) !important; }
        .p-6 { padding: var(--space-6) !important; }

        /* Text */
        .text-left { text-align: left !important; }
        .text-center { text-align: center !important; }
        .text-right { text-align: right !important; }
        .text-primary { color: var(--primary-600) !important; }
        .text-secondary { color: var(--text-secondary) !important; }
        .text-tertiary { color: var(--text-tertiary) !important; }
        .text-success { color: var(--success-600) !important; }
        .text-warning { color: var(--warning-600) !important; }
        .text-error { color: var(--error-600) !important; }
        .text-xs { font-size: var(--text-xs) !important; }
        .text-sm { font-size: var(--text-sm) !important; }
        .text-base { font-size: var(--text-base) !important; }
        .text-lg { font-size: var(--text-lg) !important; }
        .text-xl { font-size: var(--text-xl) !important; }
        .font-normal { font-weight: var(--font-normal) !important; }
        .font-medium { font-weight: var(--font-medium) !important; }
        .font-semibold { font-weight: var(--font-semibold) !important; }
        .font-bold { font-weight: var(--font-bold) !important; }

        /* Background */
        .bg-primary { background-color: var(--primary-500) !important; }
        .bg-secondary { background-color: var(--gray-100) !important; }
        .bg-success { background-color: var(--success-500) !important; }
        .bg-warning { background-color: var(--warning-500) !important; }
        .bg-error { background-color: var(--error-500) !important; }
        .bg-transparent { background-color: transparent !important; }

        /* Border */
        .border { border: 1px solid var(--border-default) !important; }
        .border-0 { border: 0 !important; }
        .border-subtle { border: 1px solid var(--border-subtle) !important; }
        .rounded { border-radius: var(--radius-md) !important; }
        .rounded-sm { border-radius: var(--radius-sm) !important; }
        .rounded-lg { border-radius: var(--radius-lg) !important; }
        .rounded-full { border-radius: var(--radius-full) !important; }

        /* Width & Height */
        .w-full { width: 100% !important; }
        .w-auto { width: auto !important; }
        .h-full { height: 100% !important; }
        .h-auto { height: auto !important; }
        .min-h-screen { min-height: 100vh !important; }

        /* Position */
        .relative { position: relative !important; }
        .absolute { position: absolute !important; }
        .fixed { position: fixed !important; }
        .sticky { position: sticky !important; }

        /* Z-Index */
        .z-10 { z-index: 10 !important; }
        .z-20 { z-index: 20 !important; }
        .z-50 { z-index: 50 !important; }

        /* Overflow */
        .overflow-hidden { overflow: hidden !important; }
        .overflow-auto { overflow: auto !important; }
        .overflow-x-auto { overflow-x: auto !important; }
        .overflow-y-auto { overflow-y: auto !important; }

        /* Shadows */
        .shadow-none { box-shadow: none !important; }
        .shadow-sm { box-shadow: var(--shadow-sm) !important; }
        .shadow-md { box-shadow: var(--shadow-md) !important; }
        .shadow-lg { box-shadow: var(--shadow-lg) !important; }

        /* Visibility */
        .visible { visibility: visible !important; }
        .invisible { visibility: hidden !important; }
        .opacity-0 { opacity: 0 !important; }
        .opacity-50 { opacity: 0.5 !important; }
        .opacity-100 { opacity: 1 !important; }

        /* Cursor */
        .cursor-pointer { cursor: pointer !important; }
        .cursor-not-allowed { cursor: not-allowed !important; }
        .cursor-wait { cursor: wait !important; }

        /* User Select */
        .select-none { user-select: none !important; }
        .select-text { user-select: text !important; }
        .select-all { user-select: all !important; }

        /* Transform */
        .transform { transform: translateZ(0) !important; }
        .scale-90 { transform: scale(0.9) !important; }
        .scale-95 { transform: scale(0.95) !important; }
        .scale-100 { transform: scale(1) !important; }
        .scale-105 { transform: scale(1.05) !important; }
        .scale-110 { transform: scale(1.1) !important; }

        /* Transitions */
        .transition-none { transition: none !important; }
        .transition-all { transition: all var(--transition-base) !important; }
        .transition-colors { transition: color var(--transition-base), background-color var(--transition-base), border-color var(--transition-base) !important; }
        .transition-opacity { transition: opacity var(--transition-base) !important; }
        .transition-transform { transition: transform var(--transition-base) !important; }

        /* Focus States */
        .focus-outline:focus {
            outline: 2px solid var(--primary-500) !important;
            outline-offset: 2px !important;
        }

        /* Accessibility */
        .sr-only {
            position: absolute !important;
            width: 1px !important;
            height: 1px !important;
            padding: 0 !important;
            margin: -1px !important;
            overflow: hidden !important;
            clip: rect(0, 0, 0, 0) !important;
            white-space: nowrap !important;
            border: 0 !important;
        }

        /* ====================================
           FINAL OPTIMIZATIONS
        ==================================== */

        /* Performance Optimizations */
        .gpu-accelerated {
            transform: translateZ(0);
            will-change: transform;
        }

        /* Touch Optimizations */
        .touch-manipulation {
            touch-action: manipulation;
        }

        /* Form Control Enhancements */
        .form-control:invalid {
            border-color: var(--error-500);
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
        }

        .form-control:valid {
            border-color: var(--success-500);
        }

        /* Loading States */
        .loading {
            pointer-events: none;
            opacity: 0.7;
            position: relative;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 2px solid var(--border-subtle);
            border-top: 2px solid var(--primary-500);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        /* Focus Management */
        .focus-trap {
            outline: none;
        }

        .focus-trap:focus-within {
            box-shadow: var(--shadow-focus);
        }

        /* Modern Browser Features */
        @supports (backdrop-filter: blur(10px)) {
            .modal-backdrop {
                backdrop-filter: blur(10px);
                background: rgba(0, 0, 0, 0.3);
            }
        }

        @supports (display: contents) {
            .display-contents {
                display: contents;
            }
        }

        /* Final Touch - Ensure Typography is Crisp */
        html, body {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
        }

        .stat-card-label {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            margin: 0;
            font-weight: var(--font-medium);
        }

        .stat-card-change {
            font-size: var(--text-xs);
            font-weight: var(--font-medium);
            padding: var(--space-1) var(--space-2);
            border-radius: var(--radius-sm);
            display: inline-flex;
            align-items: center;
            gap: var(--space-1);
            margin-top: var(--space-2);
        }

        .stat-card-change.positive {
            background: rgba(16, 185, 129, 0.1);
            color: var(--accent-green);
        }

        .stat-card-change.negative {
            background: rgba(239, 68, 68, 0.1);
            color: var(--accent-red);
        }

        /* Mobile-First Layout & Spacing */
        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 0 var(--space-mobile-lg);
            width: 100%;
        }

        /* Mobile container adjustments */
        @media (min-width: 430px) {
            .container {
                padding: 0 var(--space-5);
            }
        }

        @media (min-width: 768px) {
            .container {
                padding: 0 var(--space-6);
                max-width: 1200px;
            }
        }

        @media (min-width: 1024px) {
            .container {
                padding: 0 var(--space-8);
            }
        }

        .flex {
            display: flex;
        }

        .flex-col {
            flex-direction: column;
        }

        .items-center {
            align-items: center;
        }

        .justify-center {
            justify-content: center;
        }

        .justify-between {
            justify-content: space-between;
        }

        .gap-2 { gap: var(--space-2); }
        .gap-3 { gap: var(--space-3); }
        .gap-4 { gap: var(--space-4); }
        .gap-6 { gap: var(--space-6); }

        .p-2 { padding: var(--space-2); }
        .p-3 { padding: var(--space-3); }
        .p-4 { padding: var(--space-4); }
        .p-6 { padding: var(--space-6); }

        .mt-2 { margin-top: var(--space-2); }
        .mt-4 { margin-top: var(--space-4); }
        .mb-4 { margin-bottom: var(--space-4); }
        .mb-6 { margin-bottom: var(--space-6); }

        /* Grid System */
        .grid {
            display: grid;
        }

        .grid-cols-1 {
            grid-template-columns: repeat(1, 1fr);
        }

        .grid-cols-2 {
            grid-template-columns: repeat(2, 1fr);
        }

        .grid-cols-3 {
            grid-template-columns: repeat(3, 1fr);
        }

        .grid-cols-4 {
            grid-template-columns: repeat(4, 1fr);
        }

        /* Mobile-First Main Content Layout */
        .main-content {
            flex: 1;
            padding-top: calc(var(--touch-target-comfortable) + var(--space-mobile-md)); /* Mobile header height + spacing */
            padding-bottom: calc(var(--touch-target-large) + var(--space-mobile-lg)); /* Mobile bottom nav + spacing */
            min-height: calc(100dvh - 140px);
        }

        @media (min-width: 430px) {
            .main-content {
                padding-top: 76px; /* Header height + spacing */
                padding-bottom: 80px; /* Bottom nav height + spacing */
                min-height: calc(100vh - 156px);
            }
        }

        .screen {
            display: none;
            padding: var(--space-mobile-lg);
            max-width: 100%;
            margin: 0 auto;
        }

        @media (min-width: 430px) {
            .screen {
                padding: var(--space-4);
            }
        }

        @media (min-width: 768px) {
            .screen {
                padding: var(--space-6);
            }
        }

        .screen.active {
            display: block;
        }

        /* Mobile-First Typography */
        .section-title {
            font-size: var(--text-mobile-xl);
            font-weight: var(--font-bold);
            color: var(--text-primary);
            margin: 0 0 var(--space-mobile-xl) 0;
            line-height: 1.3;
        }

        @media (min-width: 430px) {
            .section-title {
                font-size: var(--text-xl);
                margin: 0 0 var(--space-6) 0;
                line-height: 1.4;
            }
        }

        /* Professional Form Components */
        .form-group {
            margin-bottom: var(--space-4);
            position: relative;
        }

        .form-label {
            display: block;
            font-size: var(--text-mobile-sm);
            font-weight: var(--font-medium);
            color: var(--text-primary);
            margin-bottom: var(--space-mobile-sm);
            transition: all 0.2s ease;
            line-height: 1.4;
        }

        @media (min-width: 430px) {
            .form-label {
                font-size: var(--text-sm);
                margin-bottom: var(--space-2);
            }
        }

        /* Mobile-First Form Components */
        .form-input {
            width: 100%;
            padding: var(--space-mobile-lg) var(--space-mobile-xl);
            border: 1px solid var(--border-medium);
            border-radius: var(--radius-lg);
            font-size: var(--text-mobile-base);
            line-height: 1.5;
            background: var(--surface-primary);
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            min-height: var(--touch-target-comfortable);
            touch-action: manipulation;
            -webkit-appearance: none;
            appearance: none;
        }

        @media (min-width: 430px) {
            .form-input {
                padding: var(--space-3) var(--space-4);
                font-size: var(--text-base);
                min-height: var(--touch-target-min);
            }
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-500);
            box-shadow: 0 0 0 3px var(--primary-100);
            transform: translateY(-1px);
        }

        .form-input:hover {
            border-color: var(--border-strong);
        }

        .form-input::placeholder {
            color: var(--text-tertiary);
        }

        .form-select {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%23475569' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
            background-position: right var(--space-3) center;
            background-repeat: no-repeat;
            background-size: 16px;
            padding-right: var(--space-10);
            appearance: none;
        }

        .form-select:focus {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%233b82f6' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
        }

        /* Mobile-Optimized Floating Labels */
        .form-floating {
            position: relative;
        }

        .form-floating .form-input {
            padding: var(--space-mobile-2xl) var(--space-mobile-xl) var(--space-mobile-lg) var(--space-mobile-xl);
        }

        .form-floating .form-label {
            position: absolute;
            top: 50%;
            left: var(--space-mobile-xl);
            transform: translateY(-50%);
            font-size: var(--text-mobile-base);
            color: var(--text-tertiary);
            pointer-events: none;
            transition: all 0.2s ease;
            margin-bottom: 0;
        }

        .form-floating .form-input:focus + .form-label,
        .form-floating .form-input:not(:placeholder-shown) + .form-label {
            top: var(--space-mobile-lg);
            font-size: var(--text-mobile-xs);
            font-weight: var(--font-medium);
            color: var(--primary-500);
            transform: translateY(0);
        }

        /* Desktop floating label adjustments */
        @media (min-width: 430px) {
            .form-floating .form-input {
                padding: var(--space-4) var(--space-4) var(--space-3) var(--space-4);
            }

            .form-floating .form-label {
                left: var(--space-4);
                font-size: var(--text-base);
            }

            .form-floating .form-input:focus + .form-label,
            .form-floating .form-input:not(:placeholder-shown) + .form-label {
                top: var(--space-3);
                font-size: var(--text-xs);
            }
        }

        .form-error {
            color: var(--accent-red);
            font-size: var(--text-sm);
            margin-top: var(--space-2);
            display: flex;
            align-items: center;
            gap: var(--space-1);
        }

        .form-help {
            color: var(--text-secondary);
            font-size: var(--text-sm);
            margin-top: var(--space-2);
        }

        /* Input Variants */
        .form-input-success {
            border-color: var(--accent-green);
            box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.1);
        }

        .form-input-error {
            border-color: var(--accent-red);
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
        }

        /* Professional Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--surface-elevated);
            backdrop-filter: blur(20px);
            border-top: 1px solid var(--border-light);
            padding: var(--space-2) var(--space-4) env(safe-area-inset-bottom);
            z-index: 1000;
            box-shadow: var(--shadow-lg);
        }

        /* Modern Navigation - Floating Tab Bar */
        .nav-items {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-3);
            background: var(--surface);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-2xl);
            box-shadow: var(--shadow-lg);
            backdrop-filter: blur(20px);
            max-width: fit-content;
            margin: 0 auto;
        }

        .nav-item {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-1);
            padding: var(--space-3) var(--space-4);
            border-radius: var(--radius-xl);
            transition: all var(--transition-base);
            min-width: 68px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: var(--text-xs);
            font-weight: var(--font-medium);
            background: transparent;
            border: none;
            cursor: pointer;
        }

        .nav-item:hover {
            color: var(--primary-600);
            background: var(--primary-50);
            transform: translateY(-1px);
        }

        .nav-item.active {
            color: var(--surface);
            background: var(--gradient-primary);
            box-shadow: var(--shadow-colored);
            transform: translateY(-2px);
        }

        .nav-item.active::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: var(--gradient-primary);
            border-radius: var(--radius-xl);
            opacity: 0.3;
            z-index: -1;
            animation: pulse-glow 2s ease-in-out infinite;
        }

        @keyframes pulse-glow {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.05); }
        }

        .nav-icon {
            width: 22px;
            height: 22px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: var(--transition-base);
            position: relative;
            /* Enhanced emoji display with comprehensive fallbacks */
            font-family: 'Noto Color Emoji', 'Apple Color Emoji', 'Segoe UI Emoji', 'Noto Emoji', 'Segoe UI Symbol', 'EmojiSymbols', 'Android Emoji', 'Font Awesome 6 Free', emoji, monospace;
            font-variant-emoji: emoji;
            text-rendering: optimizeSpeed;
            -webkit-font-feature-settings: "liga" 1;
            font-feature-settings: "liga" 1;
            line-height: 1;
            overflow: hidden;
        }

        /* Ensure icons don't overlap text */
        .nav-icon::before {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: block;
            width: 100%;
            height: 100%;
            line-height: 1;
            text-align: center;
        }

        /* Enhanced emoji support for specific elements */
        .screen-content h2, .screen-content h3,
        .menu-item h3, .menu-item .price,
        .nav-item span, .stat-value, .stat-label,
        .quick-action span, .chart-container h3,
        .alert-message, .empty-state {
            font-family: 'Inter', 'Noto Color Emoji', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            font-variant-emoji: emoji;
        }

        /* Prevent icon overlay issues */
        button, .btn {
            display: flex;
            align-items: center;
            gap: 6px;
            justify-content: center;
            text-align: center;
            white-space: nowrap;
        }

        /* Ensure proper spacing in buttons with icons */
        button:has(.emoji-icon), .btn:has(.emoji-icon) {
            gap: 8px;
        }

        /* Fix text and icon alignment */
        .action-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }

        .action-icon {
            margin-bottom: 4px;
        }

        /* Ensure icons don't break layout */
        .nav-icon, .action-icon, .insight-icon {
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Specific emoji rendering for buttons and UI elements */
        button, .button, .menu-item, .screen-header, .nav-item, .stat-card, .quick-action {
            font-family: 'Inter', 'Noto Emoji', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            font-variant-emoji: emoji;
        }

        /* Mobile-specific emoji rendering optimizations */
        @media (max-width: 768px) {
            .nav-icon, button, .menu-item, .stat-card {
                text-rendering: optimizeSpeed;
                -webkit-font-feature-settings: "liga" 1, "kern" 1;
                font-feature-settings: "liga" 1, "kern" 1;
            }
        }

        /* Fallback for browsers that don't support Noto Emoji */
        @supports not (font-variation-settings: normal) {
            .nav-icon, button[data-emoji], .menu-item, .stat-card {
                font-family: 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'EmojiSymbols', 'Android Emoji', monospace;
            }
        }

        /* Enhanced Icon System with Multiple Fallbacks */
        .icon-fallback {
            display: inline-block;
            width: 1em;
            height: 1em;
            text-align: center;
            line-height: 1;
        }

        /* Navigation Icon Fallbacks with FontAwesome */
        .nav-item:nth-child(1) .nav-icon:has-text("?")::before,
        .nav-item:nth-child(1) .nav-icon:empty::before {
            content: "\f015"; /* FontAwesome home */
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            font-size: 16px;
        }

        .nav-item:nth-child(2) .nav-icon:has-text("?")::before,
        .nav-item:nth-child(2) .nav-icon:empty::before {
            content: "\f07a"; /* FontAwesome shopping cart */
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            font-size: 16px;
        }

        .nav-item:nth-child(3) .nav-icon:has-text("?")::before,
        .nav-item:nth-child(3) .nav-icon:empty::before {
            content: "\f187"; /* FontAwesome archive */
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            font-size: 16px;
        }

        .nav-item:nth-child(4) .nav-icon:has-text("?")::before,
        .nav-item:nth-child(4) .nav-icon:empty::before {
            content: "\f080"; /* FontAwesome chart bar */
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            font-size: 16px;
        }

        .nav-item:nth-child(5) .nav-icon:has-text("?")::before,
        .nav-item:nth-child(5) .nav-icon:empty::before {
            content: "\f013"; /* FontAwesome cog */
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            font-size: 16px;
        }

        /* Fix for broken emoji display */
        .nav-icon.icon-broken {
            font-size: 0;
        }

        .nav-icon.icon-broken::before {
            font-size: 16px !important;
            display: block;
        }

        /* Hybrid Icon System - Emoji with FontAwesome Fallback */
        .emoji-icon {
            font-family: 'Noto Color Emoji', 'Apple Color Emoji', 'Segoe UI Emoji', 'Noto Emoji', 'Segoe UI Symbol', monospace;
            font-variant-emoji: emoji;
            display: inline-block;
            line-height: 1;
        }

        .fallback-icon {
            display: none;
            color: var(--primary-600);
        }

        /* Show fallback when emoji fails */
        @supports not (font-variation-settings: normal) {
            .emoji-icon {
                display: none;
            }
            .fallback-icon {
                display: inline-block;
            }
        }

        /* Action icons and button icons */
        .action-icon, .insight-icon {
            font-family: 'Noto Color Emoji', 'Apple Color Emoji', 'Segoe UI Emoji', 'Noto Emoji', 'Segoe UI Symbol', 'Font Awesome 6 Free', monospace;
            font-size: 18px;
            line-height: 1;
            display: inline-block;
            text-align: center;
            min-width: 1em;
            font-variant-emoji: emoji;
        }

        /* Detect broken emojis with JavaScript and show fallback */
        .nav-icon.broken-emoji .emoji-icon {
            display: none;
        }

        .nav-icon.broken-emoji .fallback-icon {
            display: inline-block;
        }

        .nav-item.active .nav-icon {
            transform: scale(1.1);
        }

        .nav-label {
            font-size: var(--text-xs);
            line-height: 1;
            font-weight: var(--font-medium);
            letter-spacing: 0.025em;
        }

        /* Mobile-First Navigation Optimizations */
        @media (max-width: 430px) {
            .bottom-nav {
                padding: var(--space-mobile-sm) var(--space-mobile-md) env(safe-area-inset-bottom);
            }

            .nav-items {
                gap: var(--space-mobile-xs);
                padding: var(--space-mobile-sm);
                width: 100%;
                max-width: none;
                justify-content: space-around;
            }

            .nav-item {
                min-width: var(--touch-target-comfortable);
                padding: var(--space-mobile-md) var(--space-mobile-sm);
                min-height: var(--touch-target-comfortable);
            }

            .nav-icon {
                width: 24px;
                height: 24px;
                font-size: var(--text-mobile-lg);
            }

            .nav-label {
                font-size: var(--text-mobile-xs);
                line-height: 1.2;
            }
        }

        /* Tablet navigation adjustments */
        @media (min-width: 431px) and (max-width: 768px) {
            .nav-items {
                gap: var(--space-3);
                padding: var(--space-3);
            }

            .nav-item {
                min-width: 70px;
                padding: var(--space-3) var(--space-4);
            }

            .nav-icon {
                width: 22px;
                height: 22px;
                font-size: 16px;
            }
        }

        /* Mobile-First POS Interface */
        .pos-layout {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--space-mobile-lg);
            min-height: calc(100dvh - 160px);
            padding: var(--space-mobile-lg);
        }

        @media (min-width: 430px) {
            .pos-layout {
                gap: var(--space-5);
                padding: var(--space-5);
                min-height: calc(100vh - 170px);
            }
        }

        @media (min-width: 768px) {
            .pos-layout {
                grid-template-columns: 1fr 400px;
                gap: var(--space-6);
                padding: var(--space-6);
                min-height: calc(100vh - 180px);
            }
        }

        @media (min-width: 1024px) {
            .pos-layout {
                grid-template-columns: 1fr 420px;
                gap: var(--space-8);
                padding: var(--space-8);
            }
        }

        /* Mobile-First Menu Grid */
        .menu-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--space-mobile-lg);
            padding: var(--space-mobile-md);
            max-height: calc(100dvh - 200px);
            overflow-y: auto;
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
        }

        @media (min-width: 430px) {
            .menu-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                gap: var(--space-4);
                padding: var(--space-4);
            }
        }

        @media (min-width: 600px) {
            .menu-grid {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
                gap: var(--space-5);
            }
        }

        @media (min-width: 768px) {
            .menu-grid {
                gap: var(--space-6);
                max-height: calc(100vh - 220px);
            }
        }

        /* Mobile-Optimized Menu Items */
        .menu-item {
            background: var(--surface);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-xl);
            padding: var(--space-mobile-lg);
            transition: all var(--transition-base);
            box-shadow: var(--shadow-sm);
            position: relative;
            overflow: hidden;
            cursor: pointer;
            min-height: var(--touch-target-large);
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }

        .menu-item:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
            border-color: var(--primary-300);
        }

        .menu-item:active {
            transform: translateY(0);
            box-shadow: var(--shadow-sm);
        }

        @media (min-width: 430px) {
            .menu-item {
                padding: var(--space-5);
            }

            .menu-item:hover {
                transform: translateY(-2px);
                border-color: var(--primary-500);
            }
        }

        @media (min-width: 768px) {
            .menu-item {
                padding: var(--space-6);
            }
        }

        .menu-item-image {
            width: 100%;
            height: 120px;
            background: var(--secondary-purple);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin-bottom: var(--space-3);
        }

        .menu-item-name {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin-bottom: var(--space-2);
        }

        .menu-item-price {
            font-size: var(--text-xl);
            font-weight: var(--font-bold);
            color: var(--primary-purple);
        }

        .cart-panel {
            background: var(--surface-elevated);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-xl);
            padding: var(--space-6);
            height: fit-content;
            max-height: calc(100vh - 200px);
            overflow-y: auto;
            position: sticky;
            top: var(--space-4);
        }

        .cart-item {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-3);
            border-bottom: 1px solid var(--border-light);
        }

        .cart-item:last-child {
            border-bottom: none;
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-name {
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--text-primary);
            margin-bottom: var(--space-1);
        }

        .cart-item-price {
            font-size: var(--text-sm);
            color: var(--text-secondary);
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .quantity-btn {
            width: 32px;
            height: 32px;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border-medium);
            background: var(--surface-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .quantity-btn:hover {
            border-color: var(--primary-purple);
            background: var(--secondary-purple);
        }

        .checkout-section {
            margin-top: var(--space-6);
            padding-top: var(--space-6);
            border-top: 1px solid var(--border-light);
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-4);
        }

        .total-label {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
        }

        .total-amount {
            font-size: var(--text-xl);
            font-weight: var(--font-bold);
            color: var(--primary-purple);
        }

        /* Enhanced Dashboard Styles */
        /* Modern Dashboard Layout */
        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--space-6);
            margin-bottom: var(--space-8);
        }

        .dashboard-card {
            position: relative;
            background: var(--surface);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-2xl);
            padding: var(--space-8);
            transition: all var(--transition-base);
            box-shadow: var(--shadow-sm);
            backdrop-filter: blur(10px);
            overflow: hidden;
        }

        .dashboard-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
            border-radius: var(--radius-2xl) var(--radius-2xl) 0 0;
        }

        .dashboard-card::after {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, var(--primary-100) 0%, transparent 70%);
            opacity: 0;
            transition: var(--transition-slow);
            pointer-events: none;
        }

        .dashboard-card:hover {
            transform: translateY(-6px);
            box-shadow: var(--shadow-xl);
            border-color: var(--border-default);
        }

        .dashboard-card:hover::after {
            opacity: 0.3;
        }

        .dashboard-card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-4);
        }

        .dashboard-card h3 {
            font-size: var(--text-mobile-xs);
            font-weight: var(--font-semibold);
            color: var(--text-secondary);
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            line-height: 1.2;
        }

        .dashboard-card-icon {
            width: 36px;
            height: 36px;
            background: var(--gradient-primary);
            border-radius: var(--radius-xl);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: var(--text-mobile-base);
            box-shadow: var(--shadow-colored);
        }

        .dashboard-card .value {
            font-size: var(--text-mobile-3xl);
            font-weight: var(--font-bold);
            color: var(--text-primary);
            margin: var(--space-mobile-md) 0;
            line-height: 1.1;
        }

        /* Desktop dashboard adjustments */
        @media (min-width: 430px) {
            .dashboard-card h3 {
                font-size: var(--text-sm);
            }

            .dashboard-card-icon {
                width: 40px;
                height: 40px;
                font-size: 18px;
            }

            .dashboard-card .value {
                font-size: var(--text-4xl);
                margin: var(--space-3) 0;
                line-height: 1;
            }
        }

        .dashboard-card-footer {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: var(--space-4);
        }

        .dashboard-card .change {
            font-size: var(--text-sm);
            font-weight: var(--font-semibold);
            padding: var(--space-2) var(--space-3);
            border-radius: var(--radius-full);
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
            backdrop-filter: blur(10px);
        }

        .dashboard-card .change.positive {
            background: rgba(34, 197, 94, 0.15);
            color: var(--success-600);
            border: 1px solid rgba(34, 197, 94, 0.2);
        }

        .dashboard-card .change.negative {
            background: rgba(239, 68, 68, 0.15);
            color: var(--error-600);
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        .dashboard-card .trend-icon {
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Modern Action Grid */
        .action-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: var(--space-6);
            margin-bottom: var(--space-8);
        }

        .action-btn {
            position: relative;
            background: var(--gradient-primary);
            color: var(--text-inverse);
            border: none;
            border-radius: var(--radius-xl);
            padding: var(--space-4);
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            min-height: var(--touch-target-comfortable);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-2);
            box-shadow: var(--shadow-md);
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            background: linear-gradient(135deg, var(--primary-600), var(--primary-500));
        }

        .action-btn:active {
            transform: translateY(0);
            box-shadow: var(--shadow-sm);
        }

        .action-btn-icon {
            font-size: 1.5rem;
            margin-bottom: var(--space-1);
        }

        /* Responsive Design System */
        @media (max-width: 480px) {
            .header-title {
                font-size: var(--text-base);
            }

            .dashboard-stats {
                grid-template-columns: 1fr;
                gap: var(--space-3);
            }

            .action-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: var(--space-3);
            }

            .menu-grid {
                grid-template-columns: 1fr;
                gap: var(--space-3);
            }

            .pos-layout {
                grid-template-columns: 1fr;
            }

            .container {
                padding: 0 var(--space-3);
            }
        }

        @media (min-width: 481px) and (max-width: 768px) {
            .dashboard-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .action-grid {
                grid-template-columns: repeat(3, 1fr);
            }

            .menu-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 769px) {
            .dashboard-stats {
                grid-template-columns: repeat(4, 1fr);
            }

            .action-grid {
                grid-template-columns: repeat(4, 1fr);
            }

            .menu-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        /* Enhanced Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--surface-overlay);
            backdrop-filter: blur(16px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: var(--space-4);
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modal.active {
            display: flex;
            opacity: 1;
        }

        .modal.active .modal-content {
            transform: scale(1);
            opacity: 1;
        }

        /* Mobile-Optimized Modal Content */
        .modal-content {
            background: var(--surface-elevated);
            border-radius: var(--radius-2xl);
            padding: var(--space-mobile-2xl);
            max-width: 500px;
            width: calc(100% - var(--space-mobile-2xl));
            max-height: 90dvh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            box-shadow: var(--shadow-2xl);
            border: 1px solid var(--border-light);
            position: relative;
            transform: scale(0.95);
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-mobile-xl);
            padding-bottom: var(--space-mobile-lg);
            border-bottom: 1px solid var(--border-light);
        }

        .modal-title {
            font-size: var(--text-mobile-lg);
            font-weight: var(--font-bold);
            color: var(--text-primary);
            margin: 0;
            line-height: 1.3;
        }

        /* Desktop modal adjustments */
        @media (min-width: 430px) {
            .modal-content {
                padding: var(--space-6);
                width: 100%;
                max-height: 90vh;
            }

            .modal-header {
                margin-bottom: var(--space-6);
                padding-bottom: var(--space-4);
            }

            .modal-title {
                font-size: var(--text-xl);
                line-height: 1.4;
            }
        }

        .modal-close {
            background: none;
            border: none;
            font-size: var(--text-xl);
            cursor: pointer;
            color: var(--text-secondary);
            padding: var(--space-2);
            border-radius: var(--radius-lg);
            transition: all 0.2s ease;
            width: var(--touch-target-min);
            height: var(--touch-target-min);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            background: var(--primary-50);
            color: var(--primary-600);
            transform: rotate(90deg);
        }

        /* Enhanced List Styles */
        .list-container {
            background: var(--surface-elevated);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-xl);
            overflow: hidden;
            margin-bottom: var(--space-4);
            box-shadow: var(--shadow-sm);
        }

        .list-header {
            background: var(--primary-50);
            padding: var(--space-4);
            border-bottom: 1px solid var(--border-light);
        }

        .list-title {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--primary-600);
            margin: 0;
        }

        .list-item {
            padding: var(--space-4);
            border-bottom: 1px solid var(--border-light);
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .list-item:last-child {
            border-bottom: none;
        }

        .list-item:hover {
            background: var(--primary-25);
        }

        .list-item:hover {
            background: var(--secondary-purple);
        }

        .list-item-title {
            font-size: var(--text-base);
            font-weight: var(--font-medium);
            color: var(--text-primary);
            margin: 0 0 var(--space-1) 0;
        }

        .list-item-subtitle {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            margin: 0;
        }

        .list-item-value {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--primary-purple);
        }

        /* Professional Alert Styles */
        .alert {
            padding: var(--space-4);
            border-radius: var(--radius-lg);
            margin-bottom: var(--space-4);
            border: 1px solid;
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }

        .alert-info {
            background: rgba(6, 182, 212, 0.1);
            border-color: var(--accent-cyan);
            color: var(--accent-cyan);
        }

        .alert-warning {
            background: rgba(245, 158, 11, 0.1);
            border-color: var(--accent-orange);
            color: var(--accent-orange);
        }

        .alert-error {
            background: rgba(239, 68, 68, 0.1);
            border-color: var(--accent-red);
            color: var(--accent-red);
        }

        .alert-success {
            background: rgba(16, 185, 129, 0.1);
            border-color: var(--accent-green);
            color: var(--accent-green);
        }

        /* Loading States */
        .loading {
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
        }

        .spinner {
            width: 16px;
            height: 16px;
            border: 2px solid var(--border-light);
            border-top-color: var(--primary-purple);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Dashboard Cards */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 20px;
        }

        .dashboard-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 20px 15px;
            text-align: center;
            border: 1px solid rgba(139, 92, 246, 0.1);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(139, 92, 246, 0.08);
        }

        .dashboard-card:active {
            transform: scale(0.98);
        }

        .dashboard-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(139, 92, 246, 0.12);
            border-color: rgba(139, 92, 246, 0.2);
        }

        .dashboard-card.sales {
            background: linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%);
            color: white;
        }

        .dashboard-card.sales::before {
            content: "üí∞";
            position: absolute;
            top: 10px;
            left: 15px;
            font-size: 20px;
            opacity: 0.8;
        }

        .dashboard-card.inventory {
            background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);
            color: white;
        }

        .dashboard-card.inventory::before {
            content: "üì¶";
            position: absolute;
            top: 10px;
            left: 15px;
            font-size: 20px;
            opacity: 0.8;
        }

        .dashboard-card.alerts {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
        }

        .dashboard-card.alerts::before {
            content: "‚ö†Ô∏è";
            position: absolute;
            top: 10px;
            left: 15px;
            font-size: 20px;
            opacity: 0.8;
        }

        .dashboard-card.expenses {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }

        .dashboard-card.expenses::before {
            content: "üí≥";
            position: absolute;
            top: 10px;
            left: 15px;
            font-size: 20px;
            opacity: 0.8;
        }

        .card-value {
            font-size: 24px;
            font-weight: 800;
            margin-bottom: 5px;
            line-height: 1;
        }

        .card-label {
            font-size: 12px;
            opacity: 0.9;
            font-weight: 500;
        }

        .card-trend {
            position: absolute;
            top: 8px;
            right: 8px;
            font-size: 18px;
        }

        /* Alert Badge */
        .alert-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #ff4757;
            color: white;
            border-radius: 12px;
            padding: 4px 8px;
            font-size: 11px;
            font-weight: 600;
            min-width: 20px;
            /* animation moved to unified definition later (gentle-pulse) */
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        /* Quick Actions */
        .quick-actions {
            margin-bottom: 25px;
        }

        .section-title {
            font-size: 16px;
            font-weight: 700;
            color: #6b46c1;
            margin-bottom: 12px;
            text-shadow: none;
        }

        .actions-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }

        .action-btn {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(139, 92, 246, 0.1);
            border-radius: 16px;
            padding: 20px 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 80px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 6px;
            box-shadow: 0 4px 16px rgba(139, 92, 246, 0.06);
        }

        .action-btn:active {
            transform: scale(0.95);
            background: rgba(255, 255, 255, 1);
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(139, 92, 246, 0.12);
            border-color: rgba(139, 92, 246, 0.2);
        }

        .action-icon {
            font-size: 24px;
            margin-bottom: 4px;
            filter: drop-shadow(0 2px 4px rgba(139, 92, 246, 0.1));
        }

        .action-label {
            font-size: 10px;
            font-weight: 600;
            color: #4c1d95;
            text-align: center;
            line-height: 1.2;
        }

        .action-btn.pos-action .action-icon {
            color: #8b5cf6;
        }

        .action-btn.inventory-action .action-icon {
            color: #06b6d4;
        }

        .action-btn.expense-action .action-icon {
            color: #10b981;
        }

        .action-btn.analysis-action .action-icon {
            color: #f59e0b;
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(139, 92, 246, 0.1);
            padding: 8px 0;
            z-index: 1000;
            box-shadow: 0 -2px 20px rgba(139, 92, 246, 0.08);
        }

        .nav-items {
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            cursor: pointer;
            padding: 8px;
            border-radius: 12px;
            transition: all 0.3s ease;
            flex: 1;
            max-width: 80px;
            position: relative;
        }

        .nav-item.active {
            background: rgba(139, 92, 246, 0.1);
            color: #8b5cf6;
        }

        .nav-item.active::after {
            content: "";
            position: absolute;
            top: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 24px;
            height: 3px;
            background: linear-gradient(135deg, #8b5cf6, #a855f7);
            border-radius: 0 0 3px 3px;
        }

        .nav-item:active {
            transform: scale(0.95);
        }

        .nav-icon {
            font-size: 20px;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
        }

        .nav-label {
            font-size: 10px;
            font-weight: 600;
        }

        /* POS Screen */
        .pos-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .menu-section {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 10px;
            max-height: 50vh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .menu-item {
            background: linear-gradient(135deg, #ff9a8b 0%, #fd746c 100%);
            border: none;
            border-radius: 12px;
            padding: 15px 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
            text-align: center;
            min-height: 90px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            touch-action: manipulation;
        }

        .menu-item:active {
            transform: scale(0.95);
        }

        .menu-item h3 {
            font-size: 13px;
            margin-bottom: 5px;
            font-weight: 600;
            line-height: 1.2;
        }

        .menu-item .price {
            font-size: 14px;
            font-weight: 700;
        }

        .cart-section {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            max-height: 40vh;
            display: flex;
            flex-direction: column;
        }

        .cart-header {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 10px;
            text-align: center;
            color: #333;
        }

        .cart-items {
            flex: 1;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            margin-bottom: 15px;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin-bottom: 8px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 10px;
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-name {
            font-size: 14px;
            font-weight: 600;
            color: #333;
        }

        .cart-item-price {
            font-size: 12px;
            color: #666;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .qty-btn {
            background: #667eea;
            border: none;
            border-radius: 8px;
            color: white;
            width: 30px;
            height: 30px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .qty-btn:active {
            transform: scale(0.9);
        }

        .quantity {
            font-size: 14px;
            font-weight: 600;
            min-width: 20px;
            text-align: center;
        }

        .cart-total {
            font-size: 16px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 15px;
            padding: 12px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 10px;
            color: #333;
        }

        .checkout-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            border-radius: 12px;
            padding: 15px;
            color: white;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .checkout-btn:active {
            transform: scale(0.98);
        }

        .checkout-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Enhanced POS Styles */
        .menu-categories {
            display: flex;
            gap: var(--space-2);
            margin-bottom: var(--space-4);
            overflow-x: auto;
            padding-bottom: var(--space-2);
            -webkit-overflow-scrolling: touch;
        }

        .category-btn {
            background: var(--surface);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-full);
            padding: var(--space-2) var(--space-4);
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all var(--transition-base);
            white-space: nowrap;
            min-height: var(--touch-target-min);
        }

        .category-btn.active {
            background: var(--primary-500);
            color: var(--text-inverse);
            border-color: var(--primary-500);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .category-btn:hover:not(.active) {
            background: var(--gray-100);
            border-color: var(--border-default);
        }

        .pos-main {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--space-6);
        }

        .menu-controls {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            flex-wrap: wrap;
        }

        .search-box {
            position: relative;
            min-width: 200px;
        }

        .search-box input {
            width: 100%;
            padding: var(--space-2) var(--space-10) var(--space-2) var(--space-3);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-lg);
            font-size: var(--text-sm);
            background: var(--surface);
        }

        .search-box .search-icon {
            position: absolute;
            right: var(--space-3);
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-tertiary);
            pointer-events: none;
        }

        .cart-count {
            background: var(--primary-500);
            color: var(--text-inverse);
            font-size: var(--text-xs);
            padding: var(--space-1) var(--space-2);
            border-radius: var(--radius-full);
            margin-left: var(--space-2);
            min-width: 20px;
            text-align: center;
        }

        .clear-cart-btn {
            background: var(--error-500);
            color: var(--text-inverse);
            border: none;
            border-radius: var(--radius-md);
            padding: var(--space-1) var(--space-2);
            font-size: var(--text-xs);
            cursor: pointer;
            transition: all var(--transition-base);
        }

        .clear-cart-btn:hover {
            background: var(--error-600);
            transform: translateY(-1px);
        }

        .empty-cart-message {
            text-align: center;
            padding: var(--space-8) var(--space-4);
            color: var(--text-tertiary);
        }

        .empty-cart-icon {
            font-size: 3rem;
            margin-bottom: var(--space-4);
            opacity: 0.5;
        }

        .discount-section {
            margin-bottom: var(--space-4);
            padding: var(--space-3);
            background: var(--gray-50);
            border-radius: var(--radius-lg);
        }

        .discount-input {
            display: flex;
            gap: var(--space-2);
        }

        .discount-input input {
            flex: 1;
            padding: var(--space-2);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-md);
            font-size: var(--text-sm);
        }

        .discount-input select {
            padding: var(--space-2);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-md);
            font-size: var(--text-sm);
            background: var(--surface);
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-2) 0;
            font-size: var(--text-sm);
        }

        .total-row.subtotal {
            border-bottom: 1px solid var(--border-subtle);
        }

        .total-row.discount {
            color: var(--success-600);
        }

        .total-row.total {
            border-top: 2px solid var(--border-default);
            padding-top: var(--space-3);
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
        }

        .total-row.profit-row {
            background: linear-gradient(135deg, var(--success-50), var(--success-100));
            margin: var(--space-2) -var(--space-3);
            padding: var(--space-3);
            border-radius: var(--radius-lg);
            font-weight: var(--font-semibold);
            color: var(--success-700);
        }

        .payment-methods {
            margin-bottom: var(--space-4);
        }

        .payment-methods label {
            display: block;
            margin-bottom: var(--space-2);
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--text-secondary);
        }

        .payment-options {
            display: flex;
            gap: var(--space-2);
        }

        .payment-btn {
            flex: 1;
            padding: var(--space-2);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-lg);
            background: var(--surface);
            font-size: var(--text-xs);
            cursor: pointer;
            transition: all var(--transition-base);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-1);
        }

        .payment-btn.active {
            background: var(--primary-500);
            color: var(--text-inverse);
            border-color: var(--primary-500);
        }

        .payment-btn:hover:not(.active) {
            background: var(--gray-100);
            border-color: var(--border-strong);
        }

        .checkout-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-2);
            background: linear-gradient(135deg, var(--primary-500), var(--primary-600));
            border: none;
            border-radius: var(--radius-xl);
            padding: var(--space-4);
            color: var(--text-inverse);
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            cursor: pointer;
            transition: all var(--transition-base);
            width: 100%;
            min-height: var(--touch-target-large);
            position: relative;
            overflow: hidden;
        }

        .checkout-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .checkout-btn:active:not(:disabled) {
            transform: translateY(0);
        }

        .checkout-btn:disabled {
            background: var(--gray-300);
            color: var(--text-tertiary);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-profit {
            background: rgba(255, 255, 255, 0.2);
            padding: var(--space-1) var(--space-2);
            border-radius: var(--radius-md);
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
        }

        /* Responsive POS Layout */
        @media (min-width: 768px) {
            .pos-main {
                grid-template-columns: 2fr 1fr;
            }

            .menu-categories {
                justify-content: center;
            }

            .menu-controls {
                justify-content: space-between;
            }
        }

        @media (min-width: 1024px) {
            .pos-container {
                grid-template-columns: 1fr;
                max-width: 1200px;
                margin: 0 auto;
            }

            .menu-grid {
                grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
                max-height: 60vh;
            }

            .cart-section {
                max-height: 70vh;
            }
        }

        /* Form Styles */
        .form-container {
            background: var(--surface-elevated);
            backdrop-filter: blur(16px);
            border-radius: var(--radius-2xl);
            padding: var(--space-6);
            border: 1px solid var(--border-light);
            margin-bottom: var(--space-6);
            box-shadow: var(--shadow-lg);
        }

        .form-group {
            margin-bottom: var(--space-4);
        }

        .form-group label {
            display: block;
            margin-bottom: var(--space-2);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            font-size: var(--text-sm);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: var(--space-3);
            border: 1px solid var(--border-medium);
            border-radius: var(--radius-lg);
            font-size: var(--text-base);
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            background: var(--surface-primary);
            backdrop-filter: blur(8px);
            appearance: none;
            -webkit-appearance: none;
            min-height: var(--touch-target-min);
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-500);
            box-shadow: 0 0 0 3px var(--primary-100);
            transform: translateY(-1px);
        }

        /* Receipt Upload Styles */
        .receipt-upload-area {
            position: relative;
            border: 2px dashed #e8ecf4;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            background: rgba(255, 255, 255, 0.5);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .receipt-upload-area:hover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
        }

        .receipt-upload-area input[type="file"] {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }

        .upload-display {
            pointer-events: none;
        }

        .upload-icon {
            font-size: 32px;
            margin-bottom: 10px;
            opacity: 0.7;
        }

        .upload-text {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .upload-info {
            font-size: 12px;
            color: #666;
        }

        .receipt-preview {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            border: 2px solid #e8ecf4;
        }

        .receipt-preview img {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 8px;
            border: 1px solid #ddd;
        }

        .receipt-info {
            flex: 1;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .receipt-info span {
            font-size: 14px;
            color: #333;
            font-weight: 500;
        }

        .remove-receipt {
            background: #ff4757;
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .remove-receipt:hover {
            background: #ff3742;
        }

        /* Missing media query restored for small device layout adjustments */

        .btn::before {
            content: "";
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn:hover {
            box-shadow: 0 6px 24px rgba(139, 92, 246, 0.35);
            background: linear-gradient(135deg, #7c3aed, #9333ea);
            transform: translateY(-1px);
        }

        .btn-small {
            padding: 8px 12px;
            font-size: 12px;
            min-height: 36px;
        }

        .btn-success {
            background: linear-gradient(135deg, #10b981, #059669);
            box-shadow: 0 4px 16px rgba(16, 185, 129, 0.25);
        }

        .btn-success:hover {
            box-shadow: 0 6px 24px rgba(16, 185, 129, 0.35);
            background: linear-gradient(135deg, #047857, #065f46);
        }

        .btn-warning {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            box-shadow: 0 4px 16px rgba(245, 158, 11, 0.25);
        }

        .btn-warning:hover {
            box-shadow: 0 6px 24px rgba(245, 158, 11, 0.35);
            background: linear-gradient(135deg, #d97706, #b45309);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            box-shadow: 0 4px 16px rgba(239, 68, 68, 0.25);
        }

        .btn-danger:hover {
            box-shadow: 0 6px 24px rgba(239, 68, 68, 0.35);
            background: linear-gradient(135deg, #dc2626, #b91c1c);
        }

        /* List Styles */
        .list-container {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            margin-bottom: 15px;
        }

        .list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .list-title {
            font-size: 16px;
            font-weight: 700;
            color: #333;
        }

        .list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            margin-bottom: 8px;
            background: rgba(102, 126, 234, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .list-item-info {
            flex: 1;
        }

        .list-item-title {
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
        }

        .list-item-subtitle {
            font-size: 12px;
            color: #666;
        }

        .list-item-actions {
            display: flex;
            gap: 6px;
        }

        /* Alert Styles */
        .alert {
            padding: 12px 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            font-size: 14px;
            font-weight: 500;
        }

        .alert-critical {
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            color: white;
            animation: pulse 2s infinite;
        }

        .alert-warning {
            background: linear-gradient(135deg, #fa709a, #fee140);
            color: white;
        }

        .alert-info {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            color: white;
        }

        /* Loading States */
        .loading {
            text-align: center;
            padding: 40px 20px;
            color: #666;
            font-size: 14px;
        }

        .loading::after {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid #667eea;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Success/Error Messages */
        .message {
            position: fixed;
            top: 80px;
            left: 20px;
            right: 20px;
            padding: 15px;
            border-radius: 12px;
            font-weight: 600;
            z-index: 2000;
            animation: slideDown 0.3s ease;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .message.success {
            background: linear-gradient(135deg, rgba(67, 233, 123, 0.9), rgba(56, 249, 215, 0.9));
            color: white;
            border-left: 4px solid #43e97b;
        }

        .message.success::before {
            content: "‚úÖ";
            font-size: 18px;
        }

        .message.error {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.9), rgba(254, 202, 87, 0.9));
            color: white;
            border-left: 4px solid #ff6b6b;
        }

        .message.error::before {
            content: "‚ö†Ô∏è";
            font-size: 18px;
        }

        .message.info {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.9), rgba(168, 85, 247, 0.9));
            color: white;
            border-left: 4px solid #8b5cf6;
        }

        .message.info::before {
            content: "‚ÑπÔ∏è";
            font-size: 18px;
        }

        @keyframes slideDown {
            from {
                transform: translateY(-100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 15px 10px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.3);
            min-height: 80px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .stat-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(135deg, #8b5cf6, #a855f7);
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
        }

        .stat-card h3 {
            font-size: 18px;
            font-weight: 700;
            color: #333;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .stat-card h3::before {
            font-size: 16px;
        }

        .stat-card h3[data-stat="customers"]::before {
            content: "üë•";
        }

        .stat-card h3[data-stat="orders"]::before {
            content: "üìã";
        }

        .stat-card h3[data-stat="avg-order"]::before {
            content: "üí∞";
        }

        .stat-card h3[data-stat="profit"]::before {
            content: "üìà";
        }

        .stat-card p {
            font-size: 11px;
            color: #666;
            font-weight: 500;
        }

        /* Enhanced Analytics Styles */
        .analytics-section {
            margin-top: var(--space-6);
            display: flex;
            flex-direction: column;
            gap: var(--space-6);
        }

        .chart-container {
            background: var(--surface-primary);
            border-radius: var(--radius-xl);
            padding: var(--space-6);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-light);
        }

        .chart-title {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin: 0 0 var(--space-4) 0;
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .chart-wrapper {
            position: relative;
            height: 300px;
            width: 100%;
        }

        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--space-4);
        }

        .half-width .chart-wrapper {
            height: 250px;
        }

        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--space-4);
        }

        .insight-card {
            background: linear-gradient(135deg, var(--surface-primary) 0%, var(--surface-secondary) 100%);
            border-radius: var(--radius-lg);
            padding: var(--space-4);
            border: 1px solid var(--border-light);
            display: flex;
            align-items: flex-start;
            gap: var(--space-3);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .insight-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-purple);
        }

        .insight-icon {
            font-size: var(--text-2xl);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 48px;
            height: 48px;
            background: var(--secondary-purple);
            border-radius: var(--radius-lg);
            flex-shrink: 0;
        }

        .insight-content h4 {
            font-size: var(--text-sm);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin: 0 0 var(--space-1) 0;
        }

        .insight-content p {
            font-size: var(--text-xs);
            color: var(--text-secondary);
            margin: 0;
            line-height: 1.4;
        }

        /* Smart Notifications System */
        .toast-container {
            position: fixed;
            top: 80px;
            right: 20px;
            z-index: 9999;
            pointer-events: none;
        }

        .toast {
            background: var(--surface-primary);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-xl);
            border-left: 4px solid var(--primary-purple);
            padding: var(--space-4);
            margin-bottom: var(--space-3);
            max-width: 320px;
            transform: translateX(100%);
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            pointer-events: auto;
        }

        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }

        .toast.success {
            border-left-color: var(--accent-green);
        }

        .toast.warning {
            border-left-color: var(--accent-orange);
        }

        .toast.error {
            border-left-color: var(--accent-red);
        }

        .toast.info {
            border-left-color: var(--accent-cyan);
        }

        .toast-header {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            margin-bottom: var(--space-2);
        }

        .toast-icon {
            font-size: var(--text-lg);
        }

        .toast-title {
            font-weight: var(--font-semibold);
            font-size: var(--text-sm);
            color: var(--text-primary);
            margin: 0;
        }

        .toast-message {
            font-size: var(--text-xs);
            color: var(--text-secondary);
            line-height: 1.4;
            margin: 0;
        }

        .toast-close {
            background: none;
            border: none;
            color: var(--text-tertiary);
            cursor: pointer;
            padding: 2px;
            margin-left: auto;
            border-radius: var(--radius-sm);
            font-size: var(--text-sm);
        }

        .toast-close:hover {
            background: var(--secondary-purple);
            color: var(--text-primary);
        }

        /* Alert Badge */
        .alert-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--accent-red);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: var(--font-bold);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .notification-center {
            position: fixed;
            top: 0;
            right: -400px;
            width: 380px;
            height: 100vh;
            background: var(--surface-primary);
            box-shadow: var(--shadow-xl);
            border-left: 1px solid var(--border-light);
            z-index: 9998;
            transition: right 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
        }

        .notification-center.open {
            right: 0;
        }

        .notification-header {
            padding: var(--space-4);
            border-bottom: 1px solid var(--border-light);
            display: flex;
            justify-content: between;
            align-items: center;
        }

        .notification-list {
            flex: 1;
            overflow-y: auto;
            padding: var(--space-2);
        }

        .notification-item {
            padding: var(--space-3);
            margin-bottom: var(--space-2);
            background: var(--surface-secondary);
            border-radius: var(--radius-lg);
            border-left: 3px solid var(--primary-purple);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .notification-item:hover {
            transform: translateX(4px);
            box-shadow: var(--shadow-md);
        }

        .notification-item.unread {
            background: var(--secondary-purple);
        }

        /* Chart Responsiveness */
        @media (max-width: 768px) {
            .analytics-grid {
                grid-template-columns: 1fr;
            }

            .chart-wrapper {
                height: 250px;
            }

            .half-width .chart-wrapper {
                height: 200px;
            }

            .insights-grid {
                grid-template-columns: 1fr;
            }

            .toast-container {
                right: 10px;
                top: 70px;
            }

            .toast {
                max-width: calc(100vw - 20px);
            }

            .notification-center {
                width: 100vw;
                right: -100vw;
            }

            .filters-grid {
                grid-template-columns: 1fr;
                gap: var(--space-3);
            }

            .date-range {
                flex-direction: column;
                gap: var(--space-2);
            }
        }

        /* Advanced Filters Styles */
        .filters-section {
            background: var(--surface-primary);
            border-radius: var(--radius-xl);
            padding: var(--space-4);
            margin-bottom: var(--space-6);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-light);
        }

        .filters-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-4);
        }

        .filters-header h3 {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin: 0;
        }

        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-4);
            align-items: end;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: var(--space-2);
        }

        .filter-group label {
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--text-secondary);
        }

        .filter-group input,
        .filter-group select {
            padding: var(--space-3);
            border: 1px solid var(--border-medium);
            border-radius: var(--radius-lg);
            font-size: var(--text-sm);
            transition: all 0.2s ease;
            background: var(--surface-primary);
        }

        .filter-group input:focus,
        .filter-group select:focus {
            outline: none;
            border-color: var(--primary-purple);
            box-shadow: 0 0 0 3px var(--secondary-purple);
        }

        .date-range {
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .date-range span {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            white-space: nowrap;
        }

        .date-range input {
            flex: 1;
            margin: 0;
        }

        /* Responsive Adjustments */
        @media (max-width: 360px) {
            .header h1 {
                font-size: 14px;
            }
        }

        /* Floating Animation */
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-6px); }
        }

        .dashboard-card.sales {
            animation: float 6s ease-in-out infinite;
            animation-delay: 0s;
        }

        .dashboard-card.inventory {
            animation: float 6s ease-in-out infinite;
            animation-delay: 1s;
        }

        .dashboard-card.alerts {
            animation: float 6s ease-in-out infinite;
            animation-delay: 2s;
        }

        .dashboard-card.expenses {
            animation: float 6s ease-in-out infinite;
            animation-delay: 3s;
        }

        /* Shimmer Loading Effect */
        @keyframes shimmer {
            0% { background-position: -468px 0; }
            100% { background-position: 468px 0; }
        }

        .loading-shimmer {
            background: linear-gradient(90deg, transparent, rgba(139, 92, 246, 0.1), transparent);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }

        /* Pulse Animation for Important Elements */
        @keyframes gentle-pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .alert-badge {
            animation: gentle-pulse 2s infinite;
        }
        /* Missing media query restored for small device layout adjustments */
        @media (max-width: 480px) {
            .main-content { padding: 10px; }
            .dashboard-grid { gap: 8px; }
            .dashboard-card { padding: 15px 10px; }
            .card-value { font-size: 20px; }
            .actions-grid { grid-template-columns: repeat(4, 1fr); gap: 8px; }
            .action-btn { padding: 15px 5px; min-height: 70px; }
            .action-icon { font-size: 20px; }
            .action-label { font-size: 9px; }
        }

        /* Safe area support for notched phones */
        @supports (padding: max(0px)) {
            .header {
                padding-top: max(12px, env(safe-area-inset-top));
            }

            .bottom-nav {
                padding-bottom: max(8px, env(safe-area-inset-bottom));
            }
        }

        /* Enhanced POS Features */
        .cost-info-panel {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            border-radius: 16px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);
        }

        .cost-summary {
            display: flex;
            flex-direction: column;
            gap: 4px;
            font-size: 12px;
            font-weight: 600;
        }

        .quick-expense-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            padding: 8px 12px;
            color: white;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .quick-expense-btn::before {
            content: "üí≥";
            margin-right: 6px;
            font-size: 14px;
        }

        .quick-expense-btn:active {
            transform: scale(0.95);
            background: rgba(255, 255, 255, 0.3);
        }

        .quick-expense-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .menu-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .cost-analysis-btn {
            background: linear-gradient(135deg, #43e97b, #38f9d7);
            border: none;
            border-radius: 8px;
            padding: 6px 10px;
            color: white;
            font-size: 11px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .cost-analysis-btn:active {
            transform: scale(0.95);
        }

        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .profit-indicator {
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .profit-indicator.low {
            filter: hue-rotate(0deg); /* Red */
        }

        .profit-indicator.medium {
            filter: hue-rotate(60deg); /* Yellow */
        }

        .profit-indicator.high {
            filter: hue-rotate(120deg); /* Green */
        }

        .cart-totals {
            margin-bottom: 15px;
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            margin-bottom: 5px;
            background: rgba(102, 126, 234, 0.05);
            border-radius: 8px;
            font-size: 14px;
        }

        .profit-row {
            background: rgba(67, 233, 123, 0.1);
            border: 1px solid rgba(67, 233, 123, 0.2);
            font-weight: 700;
            color: #2d7d32;
        }

        .profit-row.negative {
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid rgba(255, 107, 107, 0.2);
            color: #d32f2f;
        }

        /* Enhanced Menu Items with Cost Info */
        .menu-item {
            position: relative;
            overflow: visible;
        }

        .menu-item .cost-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border-radius: 8px;
            padding: 2px 6px;
            font-size: 9px;
            font-weight: 600;
            line-height: 1;
        }

        .menu-item .profit-badge {
            position: absolute;
            bottom: -5px;
            left: -5px;
            background: linear-gradient(135deg, #43e97b, #38f9d7);
            color: white;
            border-radius: 8px;
            padding: 2px 6px;
            font-size: 9px;
            font-weight: 600;
            line-height: 1;
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            width: 100%;
            max-width: 400px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .modal-content.cost-modal {
            max-width: 500px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
        }

        .modal-header h3 {
            margin: 0;
            color: #333;
            font-size: 18px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .modal-header h3::before {
            content: "‚ú®";
            font-size: 20px;
        }

        .close-btn {
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            font-size: 18px;
            color: #666;
            cursor: pointer;
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 1);
            color: #ff4757;
            transform: scale(1.1);
        }

        .modal form {
            padding: 20px;
        }

        .modal-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .btn-cancel {
            flex: 1;
            background: linear-gradient(135deg, #e0e0e0, #f5f5f5);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            padding: 12px;
            color: #666;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn-cancel:hover {
            background: linear-gradient(135deg, #f5f5f5, #ffffff);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .btn-save {
            flex: 1;
            background: linear-gradient(135deg, #8b5cf6, #a855f7);
            border: none;
            border-radius: 12px;
            padding: 12px;
            color: white;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 16px rgba(139, 92, 246, 0.25);
        }

        .btn-save:hover {
            background: linear-gradient(135deg, #7c3aed, #9333ea);
            transform: translateY(-1px);
            box-shadow: 0 6px 24px rgba(139, 92, 246, 0.35);
        }

        .btn-save::before {
            content: "üíæ";
            margin-right: 6px;
        }

        .cost-analysis-content {
            padding: 20px;
            max-height: 400px;
            overflow-y: auto;
        }

        .cost-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            margin-bottom: 8px;
            background: rgba(102, 126, 234, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .cost-item-info h4 {
            margin: 0 0 4px 0;
            font-size: 14px;
            font-weight: 600;
            color: #333;
        }

        .cost-item-info p {
            margin: 0;
            font-size: 12px;
            color: #666;
        }

        .cost-item-values {
            text-align: right;
        }

        .cost-item-values .cost {
            font-size: 12px;
            color: #666;
        }

        .cost-item-values .profit {
            font-size: 14px;
            font-weight: 700;
            color: #43e97b;
        }

        .cost-item-values .profit.low {
            color: #ff6b6b;
        }

        .cost-item-values .profit.medium {
            color: #feca57;
        }

        /* Improved Mobile Touch Targets */
        .qty-btn {
            min-width: 40px;
            min-height: 40px;
            font-size: 18px;
        }

        .checkout-btn {
            min-height: 50px;
            font-size: 16px;
            position: relative;
        }

        #checkout-profit {
            position: absolute;
            top: 2px;
            right: 15px;
            font-size: 11px;
            opacity: 0.8;
        }

        /* Quick Actions Enhancement */
        .action-btn.expense-action {
            background: linear-gradient(135deg, #fa709a, #fee140);
        }

        .action-btn.cost-action {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
        }

        /* Responsive Improvements */
        @media (max-width: 390px) {
            .cost-summary {
                font-size: 11px;
            }

            .quick-expense-btn {
                font-size: 11px;
                padding: 6px 8px;
            }

            .modal-content {
                margin: 10px;
                max-height: 85vh;
            }

            .total-row {
                font-size: 13px;
                padding: 6px 10px;
            }
        }

        @media (max-width: 360px) {
            .cost-info-panel {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }

            .menu-header {
                flex-direction: column;
                gap: 10px;
                align-items: stretch;
            }

            .cost-analysis-btn {
                width: 100%;
                padding: 8px;
            }
        }

        /* ===============================================
           MOBILE-FIRST ENHANCED FEATURES
           =============================================== */

        /* Mobile Pull-to-Refresh Indicator */
        .pull-to-refresh {
            position: absolute;
            top: -60px;
            left: 50%;
            transform: translateX(-50%);
            color: var(--primary-500);
            font-size: var(--text-sm);
            text-align: center;
            transition: all 0.3s ease;
            opacity: 0;
        }

        .pull-to-refresh.active {
            opacity: 1;
            top: -40px;
        }

        /* Enhanced Mobile Scrollbars */
        .mobile-scroll::-webkit-scrollbar {
            width: 3px;
        }

        .mobile-scroll::-webkit-scrollbar-track {
            background: transparent;
        }

        .mobile-scroll::-webkit-scrollbar-thumb {
            background: var(--primary-300);
            border-radius: var(--radius-full);
        }

        /* Mobile-Specific Animations */
        @keyframes mobile-bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .mobile-bounce {
            animation: mobile-bounce 0.6s ease-in-out;
        }

        /* Mobile Safe Area Support */
        .safe-area-top {
            padding-top: env(safe-area-inset-top);
        }

        .safe-area-bottom {
            padding-bottom: env(safe-area-inset-bottom);
        }

        .safe-area-left {
            padding-left: env(safe-area-inset-left);
        }

        .safe-area-right {
            padding-right: env(safe-area-inset-right);
        }

        /* Mobile Haptic Feedback Simulation */
        .haptic-light {
            animation: haptic-pulse 0.1s ease;
        }

        .haptic-medium {
            animation: haptic-pulse 0.15s ease;
        }

        .haptic-heavy {
            animation: haptic-pulse 0.2s ease;
        }

        @keyframes haptic-pulse {
            0% { transform: scale(1); }
            50% { transform: scale(0.97); }
            100% { transform: scale(1); }
        }

        /* Mobile Loading States */
        .mobile-loading {
            position: relative;
            overflow: hidden;
        }

        .mobile-loading::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: mobile-shimmer 1.5s infinite;
        }

        @keyframes mobile-shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        /* Swipe Gesture Indicators */
        .swipe-indicator {
            position: relative;
            overflow: hidden;
        }

        .swipe-indicator::after {
            content: '';
            position: absolute;
            right: var(--space-mobile-md);
            top: 50%;
            width: 20px;
            height: 2px;
            background: var(--primary-300);
            transform: translateY(-50%);
            border-radius: var(--radius-full);
        }

        .swipe-indicator::before {
            content: '';
            position: absolute;
            right: var(--space-mobile-lg);
            top: 50%;
            width: 0;
            height: 0;
            border-left: 6px solid var(--primary-300);
            border-top: 3px solid transparent;
            border-bottom: 3px solid transparent;
            transform: translateY(-50%);
        }

        /* Mobile-Only Utilities */
        @media (max-width: 767px) {
            .desktop-only {
                display: none !important;
            }

            .mobile-center {
                text-align: center !important;
            }

            .mobile-full-width {
                width: 100% !important;
            }

            .mobile-stack {
                flex-direction: column !important;
            }

            .mobile-hidden {
                display: none !important;
            }
        }

        @media (min-width: 768px) {
            .mobile-only {
                display: none !important;
            }
        }

        /* Enhanced Focus States for Mobile */
        @media (max-width: 767px) {
            .btn:focus-visible,
            .form-input:focus,
            .nav-item:focus {
                outline: 3px solid var(--primary-500);
                outline-offset: 2px;
            }
        }

        /* Theme System - Complete Implementation */
        .theme-dark {
            --bg-primary: #1f2937;
            --bg-secondary: #374151;
            --text-primary: #f9fafb;
            --text-secondary: #d1d5db;
            --primary-500: #3b82f6;
            --border-default: #4b5563;
        }

        .theme-modern {
            --primary-500: #8b5cf6;
            --primary-600: #7c3aed;
            --bg-secondary: #f0f4ff;
            --border-default: #e0e7ff;
        }

        .theme-classic {
            --primary-500: #dc2626;
            --primary-600: #b91c1c;
            --bg-primary: #fffbeb;
            --bg-secondary: #fef3c7;
            --text-primary: #451a03;
            --border-default: #fed7aa;
        }

        /* Theme transitions */
        * {
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }
    </style>

        /* Settings Screen Specific Styles */
        .settings-container {
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .settings-categories {
            margin: 20px 0;
        }

        .category-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 10px;
        }

        .category-tab {
            padding: 12px 20px;
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-secondary);
            transition: all 0.2s ease;
            border-bottom: none;
            position: relative;
            bottom: -2px;
        }

        .category-tab:hover {
            background: var(--hover-color);
            color: var(--text-primary);
        }

        .category-tab.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .settings-content {
            background: var(--surface-color);
            border-radius: 0 12px 12px 12px;
            padding: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .settings-section h3 {
            margin-bottom: 20px;
            color: var(--text-primary);
            font-size: 20px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .notification-category {
            margin-bottom: 30px;
            padding: 20px;
            background: var(--card-bg);
            border-radius: 12px;
            border-left: 4px solid var(--primary-color);
        }

        .notification-category h4 {
            margin-bottom: 15px;
            color: var(--text-primary);
            font-size: 16px;
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 14px;
            color: var(--text-secondary);
        }

        .checkbox-custom {
            width: 18px;
            height: 18px;
            background: var(--surface-color);
            border: 2px solid var(--border-color);
            border-radius: 4px;
            margin-right: 12px;
            position: relative;
            transition: all 0.2s ease;
        }

        .checkbox-label input[type="checkbox"] {
            display: none;
        }

        .checkbox-label input[type="checkbox"]:checked + .checkbox-custom {
            background: var(--primary-color);
            border-color: var(--primary-color);
        }

        .checkbox-label input[type="checkbox"]:checked + .checkbox-custom::after {
            content: '‚úì';
            position: absolute;
            top: -2px;
            left: 3px;
            color: white;
            font-size: 14px;
            font-weight: bold;
        }

        .sub-setting {
            margin-left: 30px;
            margin-top: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            color: var(--text-secondary);
        }

        .sub-setting input {
            width: 80px;
            padding: 4px 8px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
        }

        .unit {
            color: var(--text-secondary);
        }

        .data-management-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .data-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.2s ease;
        }

        .data-card:hover {
            transform: translateY(-2px);
        }

        .data-header {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }

        .data-icon {
            font-size: 24px;
            margin-right: 12px;
        }

        .data-title {
            font-weight: 600;
            color: var(--text-primary);
        }

        .data-description {
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: 15px;
            line-height: 1.4;
        }

        .data-status {
            margin-bottom: 15px;
            padding: 8px 12px;
            background: var(--surface-color);
            border-radius: 6px;
            font-size: 13px;
        }

        .status-indicator {
            margin-right: 6px;
        }

        .data-actions {
            display: flex;
            gap: 8px;
        }

        .data-stats {
            margin-top: 30px;
            padding: 20px;
            background: var(--card-bg);
            border-radius: 12px;
        }

        .data-stats h4 {
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .stat-label {
            color: var(--text-secondary);
        }

        .stat-value {
            color: var(--text-primary);
            font-weight: 600;
        }

        .about-section {
            margin-top: 30px;
            background: var(--surface-color);
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .about-header h3 {
            color: var(--text-primary);
            margin-bottom: 20px;
        }

        .app-info {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
        }

        .app-logo {
            font-size: 48px;
            margin-right: 20px;
        }

        .app-details h4 {
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .app-version {
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: 5px;
        }

        .app-description {
            color: var(--text-secondary);
        }

        .app-features {
            margin-top: 20px;
        }

        .app-features h5 {
            color: var(--text-primary);
            margin-bottom: 10px;
        }

        .app-features ul {
            list-style: none;
            padding: 0;
        }

        .app-features li {
            padding: 4px 0;
            color: var(--text-secondary);
        }

        @media (max-width: 768px) {
            .category-tabs {
                overflow-x: auto;
                flex-wrap: nowrap;
                -webkit-overflow-scrolling: touch;
            }

            .form-row {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .data-management-grid {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

    <!-- Configuration and Database Scripts -->
    <script src="js/config.js"></script>
    <script src="js/database.js"></script>
</head>
<body>
    <!-- Toast Notification Container -->
    <div class="toast-container" id="toast-container"></div>

    <!-- Notification Center -->
    <div class="notification-center" id="notification-center">
        <div class="notification-header">
            <h3>üîî ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h3>
            <button class="btn btn-ghost btn-icon" onclick="toggleNotificationCenter()">√ó</button>
        </div>
        <div class="notification-list" id="notification-list"></div>
    </div>

    <div class="app-container">
        <!-- Professional Header -->
    <header class="header" role="banner" aria-label="Main application header">
            <div class="header-content">
                <h1 class="header-title">ü•™ ‡∏£‡πâ‡∏≤‡∏ô Sandwich ‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏°</h1>
                <div class="header-actions">
                    <button class="btn btn-icon btn-icon-sm btn-ghost" onclick="refreshDashboard()" title="‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä" aria-label="‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
                            <path d="M21 3v5h-5"/>
                            <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
                            <path d="M3 21v-5h5"/>
                        </svg>
                    </button>
                    <button class="btn btn-icon btn-icon-sm btn-ghost" onclick="toggleNotificationCenter()" title="‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô" aria-label="‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô" style="position: relative;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/>
                            <path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/>
                        </svg>
                        <span id="notification-badge" class="alert-badge" style="display: none;">0</span>
                    </button>
                    <button class="btn btn-icon btn-icon-sm btn-ghost" onclick="toggleMenu()" title="‡πÄ‡∏°‡∏ô‡∏π" aria-label="‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏°‡∏ô‡∏π">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="4" y1="6" x2="20" y2="6"/>
                            <line x1="4" y1="12" x2="20" y2="12"/>
                            <line x1="4" y1="18" x2="20" y2="18"/>
                        </svg>
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
    <div class="main-content" role="main">
            <!-- Utility Slide-in Menu -->
            <aside id="utility-menu" aria-label="Utility Menu" style="position:fixed;top:70px;right:-260px;width:250px;height:calc(100vh - 70px);background:rgba(255,255,255,0.96);backdrop-filter:blur(18px);border-left:1px solid rgba(139,92,246,0.15);box-shadow:-4px 0 18px -4px rgba(139,92,246,0.15);transition:right .35s cubic-bezier(.4,0,.2,1);z-index:1500;display:flex;flex-direction:column;">
                <div style="padding:14px 16px;border-bottom:1px solid rgba(139,92,246,0.15);display:flex;justify-content:space-between;align-items:center;">
                    <strong style="font-size:14px;color:#4c1d95;display:flex;align-items:center;gap:6px;">‚öôÔ∏è ‡πÄ‡∏°‡∏ô‡∏π</strong>
                    <button aria-label="‡∏õ‡∏¥‡∏î‡πÄ‡∏°‡∏ô‡∏π" onclick="toggleMenu()" style="background:transparent;border:none;font-size:18px;cursor:pointer;color:#6b21a8;">√ó</button>
                </div>
                <nav style="flex:1;overflow-y:auto;padding:10px 8px;" aria-label="Utility Actions">
                    <button class="btn btn-small" style="width:100%;margin-bottom:8px;" onclick="showQuickExpenseModal()">‚ûï ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏£‡πá‡∏ß</button>
                    <button class="btn btn-small" style="width:100%;margin-bottom:8px;" onclick="showCostAnalysis()">üìä ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô</button>
                    <button class="btn btn-small" style="width:100%;margin-bottom:8px;" onclick="showPriceRecommendations()">üí° ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏£‡∏≤‡∏Ñ‡∏≤</button>
                    <button class="btn btn-small" style="width:100%;margin-bottom:8px;" onclick="calculateDailyProfit()">üßÆ ‡∏Å‡∏≥‡πÑ‡∏£‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</button>
                    <button class="btn btn-small" style="width:100%;margin-bottom:8px;" onclick="generateReorderReport()">üì¶ ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</button>
                    <button class="btn btn-small" style="width:100%;margin-bottom:8px;" onclick="refreshDashboard()">üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</button>
                    <div style="margin:10px 4px 6px;font-size:11px;color:#6b7280;">‡∏£‡∏∞‡∏ö‡∏ö</div>
                    <button class="btn btn-small btn-warning" style="width:100%;margin-bottom:8px;" onclick="loadInventoryAlerts()">‚ö†Ô∏è ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏ï‡πä‡∏≠‡∏Å</button>
                </nav>
                <div style="padding:10px 12px;border-top:1px solid rgba(139,92,246,0.15);font-size:11px;color:#6b7280;line-height:1.4;">
                    <div>‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô: <span id="app-version">1.0.0-refactor</span></div>
                    <div style="opacity:.8;">¬© 2025 Sandwich ‡∏Å‡∏•‡∏°</div>
                </div>
            </aside>
            <!-- Dashboard Screen -->
            <div id="dashboard-screen" class="screen active">
                <!-- Advanced Filters -->
                <div class="filters-section">
                    <div class="filters-header">
                        <h3>üîç ‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
                        <button class="btn btn-ghost btn-small" onclick="resetFilters()">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
                    </div>
                    <div class="filters-grid">
                        <div class="filter-group">
                            <label>‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
                            <div class="date-range">
                                <input type="date" id="startDate" onchange="applyFilters()" />
                                <span>‡∏ñ‡∏∂‡∏á</span>
                                <input type="date" id="endDate" onchange="applyFilters()" />
                            </div>
                        </div>
                        <div class="filter-group">
                            <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</label>
                            <select id="dataType" onchange="applyFilters()">
                                <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                                <option value="sales">‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢</option>
                                <option value="expenses">‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</option>
                                <option value="inventory">‡∏™‡∏ï‡πä‡∏≠‡∏Å</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</label>
                            <input type="text" id="searchInput" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏°‡∏ô‡∏π, ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤..." onkeyup="applyFilters()" />
                        </div>
                        <div class="filter-group">
                            <button class="btn btn-primary btn-small" onclick="generateFilteredReport()">üìä ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
                        </div>
                    </div>
                </div>

                <!-- Dashboard Cards -->
                <div class="dashboard-grid">
                    <div class="dashboard-card sales" onclick="switchScreen('sales-screen')">
                        <div class="card-trend">üìà</div>
                        <div class="card-value" id="today-sales">0</div>
                        <div class="card-label">‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
                    </div>
                    <div class="dashboard-card inventory" onclick="switchScreen('inventory-screen')">
                        <div class="card-trend">üì¶</div>
                        <div class="card-value" id="inventory-status">OK</div>
                        <div class="card-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏ï‡πä‡∏≠‡∏Å</div>
                        <div class="alert-badge" id="inventory-alerts" style="display: none;">0</div>
                    </div>
                    <div class="dashboard-card alerts" onclick="showAlerts()">
                        <div class="card-trend">‚ö†Ô∏è</div>
                        <div class="card-value" id="alerts-count">0</div>
                        <div class="card-label">‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</div>
                    </div>
                    <div class="dashboard-card expenses" onclick="switchScreen('expenses-screen')">
                        <div class="card-trend">üí∞</div>
                        <div class="card-value" id="month-expenses">0</div>
                        <div class="card-label">‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="quick-actions">
                    <h3 class="section-title">‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏î‡πà‡∏ß‡∏ô</h3>
                    <div class="actions-grid">
                        <button class="action-btn" onclick="switchScreen('pos-screen')">
                            <div class="action-icon">üõí</div>
                            <div class="action-label">‡∏Ç‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</div>
                        </button>
                        <button class="action-btn expense-action" onclick="showQuickExpenseModal()">
                            <div class="action-icon">ÔøΩ</div>
                            <div class="action-label">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á</div>
                        </button>
                        <button class="action-btn cost-action" onclick="showCostAnalysis()">
                            <div class="action-icon">ÔøΩ</div>
                            <div class="action-label">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô</div>
                        </button>
                        <button class="action-btn" onclick="calculateDailyProfit()">
                            <div class="action-icon">ÔøΩ</div>
                            <div class="action-label">‡∏Å‡∏≥‡πÑ‡∏£‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
                        </button>
                        <button class="action-btn" onclick="switchScreen('inventory-screen')">
                            <div class="action-icon">üìã</div>
                            <div class="action-label">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏ï‡πä‡∏≠‡∏Å</div>
                        </button>
                        <button class="action-btn" onclick="showPriceRecommendations()">
                            <div class="action-icon">üí≤</div>
                            <div class="action-label">‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏£‡∏≤‡∏Ñ‡∏≤</div>
                        </button>
                        <button class="action-btn" onclick="addDailyOperation()">
                            <div class="action-icon">üìã</div>
                            <div class="action-label">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</div>
                        </button>
                        <button class="action-btn" onclick="generateReorderReport()">
                            <div class="action-icon">üõçÔ∏è</div>
                            <div class="action-label">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠</div>
                        </button>
                    </div>
                </div>

                <!-- Today's Summary -->
                <div class="form-container">
                    <h3 class="section-title" style="color: #333; text-shadow: none; margin-bottom: 15px;">‡∏™‡∏£‡∏∏‡∏õ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3 id="today-customers" data-stat="customers">0</h3>
                            <p>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="today-orders" data-stat="orders">0</h3>
                            <p>‡∏≠‡∏≠‡∏£‡πå‡πÄ‡∏î‡∏≠‡∏£‡πå</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="avg-order" data-stat="avg-order">0</h3>
                            <p>‡∏≠‡∏≠‡∏£‡πå‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="profit-margin" data-stat="profit">0%</h3>
                            <p>‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏ô</p>
                        </div>
                    </div>
                </div>

                <!-- Enhanced Analytics Section -->
                <div class="analytics-section">
                    <!-- Sales Trend Chart -->
                    <div class="chart-container">
                        <h3 class="chart-title">üìà ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ 7 ‡∏ß‡∏±‡∏ô‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á</h3>
                        <div class="chart-wrapper">
                            <canvas id="salesTrendChart"></canvas>
                        </div>
                    </div>

                    <!-- Analytics Grid -->
                    <div class="analytics-grid">
                        <!-- Top Products Chart -->
                        <div class="chart-container half-width">
                            <h3 class="chart-title">üèÜ ‡πÄ‡∏°‡∏ô‡∏π‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°</h3>
                            <div class="chart-wrapper">
                                <canvas id="topProductsChart"></canvas>
                            </div>
                        </div>

                        <!-- Profit Analysis -->
                        <div class="chart-container half-width">
                            <h3 class="chart-title">üí∞ ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Å‡∏≥‡πÑ‡∏£</h3>
                            <div class="chart-wrapper">
                                <canvas id="profitAnalysisChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Business Intelligence Cards -->
                    <div class="insights-grid">
                        <div class="insight-card">
                            <div class="insight-icon">üöÄ</div>
                            <div class="insight-content">
                                <h4>‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï</h4>
                                <p id="growth-insight">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì...</p>
                            </div>
                        </div>
                        <div class="insight-card">
                            <div class="insight-icon">‚≠ê</div>
                            <div class="insight-content">
                                <h4>‡πÄ‡∏°‡∏ô‡∏π‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</h4>
                                <p id="recommendation-insight">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå...</p>
                            </div>
                        </div>
                        <div class="insight-card">
                            <div class="insight-icon">üìä</div>
                            <div class="insight-content">
                                <h4>‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û</h4>
                                <p id="performance-insight">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô...</p>
                            </div>
                        </div>
                        <div class="insight-card">
                            <div class="insight-icon">üí°</div>
                            <div class="insight-content">
                                <h4>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</h4>
                                <p id="tip-insight">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- POS Screen -->
            <!-- POS Screen -->
            <div id="pos-screen" class="screen">
                <div class="pos-container">
                    <!-- Quick Cost Info Panel -->
                    <div class="cost-info-panel">
                        <div class="cost-summary">
                            <span id="cart-cost">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô: 0‡∏ø</span>
                            <span id="cart-profit">‡∏Å‡∏≥‡πÑ‡∏£: 0‡∏ø</span>
                            <span id="profit-margin">%‡∏Å‡∏≥‡πÑ‡∏£: 0%</span>
                        </div>
                        <button class="quick-expense-btn" onclick="showQuickExpenseModal()">
                            üí∞ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á
                        </button>
                    </div>

                    <!-- Menu Categories -->
                    <div class="menu-categories">
                        <button class="category-btn active" onclick="loadCategoryMenu('all')" data-category="all">
                            üçΩÔ∏è ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                        </button>
                        <button class="category-btn" onclick="loadCategoryMenu('sandwich')" data-category="sandwich">
                            ü•™ ‡πÅ‡∏ã‡∏ô‡∏î‡πå‡∏ß‡∏¥‡∏ä
                        </button>
                        <button class="category-btn" onclick="loadCategoryMenu('drink')" data-category="drink">
                            ü•§ ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°
                        </button>
                        <button class="category-btn" onclick="loadCategoryMenu('dessert')" data-category="dessert">
                            üç∞ ‡∏Ç‡∏≠‡∏á‡∏´‡∏ß‡∏≤‡∏ô
                        </button>
                        <button class="category-btn" onclick="loadCategoryMenu('side')" data-category="side">
                            üçü ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á
                        </button>
                    </div>

                    <div class="pos-main">
                        <div class="menu-section">
                            <div class="menu-header">
                                <h3 class="section-title">‡πÄ‡∏°‡∏ô‡∏π‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
                                <div class="menu-controls">
                                    <button class="cost-analysis-btn" onclick="showCostAnalysis()">üìä ‡∏î‡∏π‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô</button>
                                    <div class="search-box">
                                        <input type="text" id="menu-search" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏°‡∏ô‡∏π..." onkeyup="searchMenu(this.value)">
                                        <span class="search-icon">üîç</span>
                                    </div>
                                </div>
                            </div>
                            <div class="menu-grid" id="menu-grid">
                                <!-- Menu items will be loaded here -->
                            </div>
                        </div>

                        <div class="cart-section">
                            <div class="cart-header">
                                <h3>
                                    ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
                                    <span class="cart-count" id="cart-count">0</span>
                                    <span class="profit-indicator" id="profit-indicator">üíö</span>
                                </h3>
                                <button class="clear-cart-btn" onclick="clearCart()" id="clear-cart-btn" style="display: none;">
                                    üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤
                                </button>
                            </div>
                            <div class="cart-items" id="cart-items">
                                <div class="empty-cart-message">
                                    <div class="empty-cart-icon">üõí</div>
                                    <p>‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á</p>
                                    <small>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</small>
                                </div>
                            </div>
                            <div class="cart-totals" id="cart-totals-section" style="display: none;">
                                <div class="discount-section">
                                    <div class="discount-input">
                                        <input type="number" id="discount-amount" placeholder="0" min="0" onchange="applyDiscount()">
                                        <select id="discount-type" onchange="applyDiscount()">
                                            <option value="percent">% ‡∏•‡∏î</option>
                                            <option value="fixed">‡∏ö‡∏≤‡∏ó ‡∏•‡∏î</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="total-row subtotal">
                                    <span>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°:</span>
                                    <span id="cart-subtotal">0 ‡∏ö‡∏≤‡∏ó</span>
                                </div>
                                <div class="total-row discount" id="discount-row" style="display: none;">
                                    <span>‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î:</span>
                                    <span id="discount-display">0 ‡∏ö‡∏≤‡∏ó</span>
                                </div>
                                <div class="total-row">
                                    <span>‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏£‡∏ß‡∏°:</span>
                                    <span id="total-cost">0 ‡∏ö‡∏≤‡∏ó</span>
                                </div>
                                <div class="total-row total">
                                    <span>‡∏¢‡∏≠‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥:</span>
                                    <span id="cart-total">0 ‡∏ö‡∏≤‡∏ó</span>
                                </div>
                                <div class="total-row profit-row">
                                    <span>‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥:</span>
                                    <span id="total-profit">0 ‡∏ö‡∏≤‡∏ó</span>
                                </div>
                            </div>
                            <div class="checkout-section">
                                <div class="payment-methods" id="payment-methods" style="display: none;">
                                    <label>‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô:</label>
                                    <div class="payment-options">
                                        <button class="payment-btn active" data-method="cash">üíµ ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î</button>
                                        <button class="payment-btn" data-method="transfer">üè¶ ‡πÇ‡∏≠‡∏ô</button>
                                        <button class="payment-btn" data-method="qr">üì± QR Code</button>
                                    </div>
                                </div>
                                <button class="checkout-btn" id="checkout-btn" onclick="checkout()" disabled>
                                    <span class="btn-text">‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</span>
                                    <span id="checkout-profit" class="btn-profit"></span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Expense Modal -->
            <div id="quick-expense-modal" class="modal" style="display: none;" role="dialog" aria-modal="true" aria-labelledby="quick-expense-title">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 id="quick-expense-title">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡∏î‡πà‡∏ß‡∏ô</h3>
                        <button class="close-btn" onclick="closeQuickExpenseModal()">√ó</button>
                    </div>
                    <form id="quick-expense-form">
                        <div class="form-group">
                            <label>‡∏£‡πâ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠:</label>
                            <select id="store-select" required>
                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡πâ‡∏≤‡∏ô</option>
                                <option value="‡πÇ‡∏•‡∏ï‡∏±‡∏™">‡πÇ‡∏•‡∏ï‡∏±‡∏™</option>
                                <option value="7-Eleven">7-Eleven</option>
                                <option value="‡πÅ‡∏°‡πá‡∏Ñ‡πÇ‡∏Ñ‡∏£">‡πÅ‡∏°‡πá‡∏Ñ‡πÇ‡∏Ñ‡∏£</option>
                                <option value="‡πÄ‡∏ó‡∏™‡πÇ‡∏Å‡πâ">‡πÄ‡∏ó‡∏™‡πÇ‡∏Å‡πâ</option>
                                <option value="‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏™‡πà‡∏á">‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏™‡πà‡∏á</option>
                                <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠:</label>
                            <input type="text" id="expense-items" placeholder="‡πÄ‡∏ä‡πà‡∏ô: ‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á ‡πÅ‡∏Æ‡∏° ‡∏ä‡∏µ‡∏™" required>
                        </div>
                        <div class="form-group">
                            <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó):</label>
                            <input type="number" id="expense-amount" placeholder="0" required>
                        </div>
                        <div class="form-group">
                            <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:</label>
                            <select id="expense-type" required>
                                <option value="‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö">‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö</option>
                                <option value="‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°</option>
                                <option value="‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå">‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</option>
                                <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>‡πÅ‡∏ô‡∏ö‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à:</label>
                            <div class="receipt-upload-area">
                                <input type="file" id="receipt-file" accept="image/*,application/pdf" onchange="handleReceiptUpload(this)">
                                <div class="upload-display">
                                    <div class="upload-icon">üì∏</div>
                                    <div class="upload-text">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏£‡∏∑‡∏≠‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ</div>
                                    <div class="upload-info">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö JPG, PNG, PDF</div>
                                </div>
                                <div id="receipt-preview" class="receipt-preview" style="display: none;">
                                    <img id="receipt-image" src="" alt="Receipt preview">
                                    <div class="receipt-info">
                                        <span id="receipt-filename"></span>
                                        <button type="button" onclick="removeReceipt()" class="remove-receipt">√ó</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</label>
                            <textarea id="expense-notes" placeholder="‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..." rows="2"></textarea>
                        </div>
                        <div class="modal-actions">
                            <button type="button" class="btn-cancel" onclick="closeQuickExpenseModal()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                            <button type="submit" class="btn-save">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Cost Analysis Modal -->
            <div id="cost-analysis-modal" class="modal" style="display: none;" role="dialog" aria-modal="true" aria-labelledby="cost-analysis-title">
                <div class="modal-content cost-modal">
                    <div class="modal-header">
                        <h3 id="cost-analysis-title">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡πÄ‡∏°‡∏ô‡∏π</h3>
                        <button class="close-btn" onclick="closeCostAnalysisModal()">√ó</button>
                    </div>
                    <div class="cost-analysis-content" id="cost-analysis-content">
                        <!-- Cost analysis data will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Sales Screen -->
            <div id="sales-screen" class="screen">
                <div class="sales-container">
                    <div class="screen-header">
                        <h2 class="screen-title">üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</h2>
                        <div class="screen-actions">
                            <button class="btn btn-secondary" onclick="exportSalesData()">üì• ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å</button>
                            <button class="btn btn-primary" onclick="refreshSalesReport()">üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</button>
                        </div>
                    </div>

                    <!-- Date Range Filter -->
                    <div class="date-filter-section">
                        <div class="filter-group">
                            <label>‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</label>
                            <div class="date-range-picker">
                                <input type="date" id="sales-start-date" onchange="updateSalesDateRange()">
                                <span class="date-separator">‡∏ñ‡∏∂‡∏á</span>
                                <input type="date" id="sales-end-date" onchange="updateSalesDateRange()">
                            </div>
                        </div>
                        <div class="quick-date-filters">
                            <button class="quick-date-btn active" onclick="setSalesDateRange('today')">‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</button>
                            <button class="quick-date-btn" onclick="setSalesDateRange('week')">‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ô‡∏µ‡πâ</button>
                            <button class="quick-date-btn" onclick="setSalesDateRange('month')">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</button>
                            <button class="quick-date-btn" onclick="setSalesDateRange('quarter')">‡πÑ‡∏ï‡∏£‡∏°‡∏≤‡∏™‡∏ô‡∏µ‡πâ</button>
                        </div>
                    </div>

                    <!-- Sales Statistics Grid -->
                    <div class="sales-stats-grid">
                        <div class="stat-card primary">
                            <div class="stat-icon">üí∞</div>
                            <div class="stat-content">
                                <div class="stat-value" id="total-sales">‡∏ø0</div>
                                <div class="stat-label">‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°</div>
                                <div class="stat-change positive" id="sales-change">+0%</div>
                            </div>
                        </div>
                        <div class="stat-card success">
                            <div class="stat-icon">üì¶</div>
                            <div class="stat-content">
                                <div class="stat-value" id="total-orders">0</div>
                                <div class="stat-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</div>
                                <div class="stat-change positive" id="orders-change">+0%</div>
                            </div>
                        </div>
                        <div class="stat-card warning">
                            <div class="stat-icon">üìà</div>
                            <div class="stat-content">
                                <div class="stat-value" id="avg-order-value">‡∏ø0</div>
                                <div class="stat-label">‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ï‡πà‡∏≠‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</div>
                                <div class="stat-change positive" id="aov-change">+0%</div>
                            </div>
                        </div>
                        <div class="stat-card info">
                            <div class="stat-icon">üéØ</div>
                            <div class="stat-content">
                                <div class="stat-value" id="profit-margin">0%</div>
                                <div class="stat-label">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≥‡πÑ‡∏£</div>
                                <div class="stat-change positive" id="margin-change">+0%</div>
                            </div>
                        </div>
                    </div>

                    <!-- Sales Chart Section -->
                    <div class="chart-section">
                        <div class="chart-header">
                            <h3>‡∏Å‡∏£‡∏≤‡∏ü‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢</h3>
                            <div class="chart-controls">
                                <select id="chart-period" onchange="updateSalesChart()">
                                    <option value="daily">‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</option>
                                    <option value="weekly">‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå</option>
                                    <option value="monthly">‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</option>
                                </select>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="sales-chart"></canvas>
                        </div>
                    </div>

                    <!-- Top Products Section -->
                    <div class="top-products-section">
                        <div class="section-header">
                            <h3>üèÜ ‡πÄ‡∏°‡∏ô‡∏π‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ</h3>
                            <span class="section-subtitle">‡∏ï‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</span>
                        </div>
                        <div class="top-products-grid" id="top-products-list">
                            <!-- Top products will be loaded here -->
                        </div>
                    </div>

                    <!-- Recent Sales Section -->
                    <div class="recent-sales-section">
                        <div class="section-header">
                            <h3>üïí ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h3>
                            <button class="btn btn-outline" onclick="viewAllTransactions()">‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                        </div>
                        <div class="recent-sales-list" id="recent-sales-list">
                            <!-- Recent sales will be loaded here -->
                        </div>
                    </div>

                    <!-- Performance Insights -->
                    <div class="insights-section">
                        <div class="section-header">
                            <h3>üí° ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å</h3>
                        </div>
                        <div class="insights-grid" id="sales-insights">
                            <!-- Insights will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Expenses Screen -->
            <div id="expenses-screen" class="screen">
                <div class="expenses-container">
                    <div class="screen-header">
                        <h2 class="screen-title">üí∏ ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢ & ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</h2>
                        <div class="screen-actions">
                            <button class="btn btn-secondary" onclick="exportExpensesData()">üì• ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å</button>
                            <button class="btn btn-success" onclick="showQuickExpenseModal()">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</button>
                        </div>
                    </div>

                    <!-- Expense Categories Filter -->
                    <div class="expense-filter-section">
                        <div class="filter-group">
                            <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢:</label>
                            <div class="category-filters">
                                <button class="category-filter-btn active" onclick="filterExpensesByCategory('all')">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                                <button class="category-filter-btn" onclick="filterExpensesByCategory('ingredient')">ü•¨ ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö</button>
                                <button class="category-filter-btn" onclick="filterExpensesByCategory('equipment')">üîß ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</button>
                                <button class="category-filter-btn" onclick="filterExpensesByCategory('utility')">‚ö° ‡∏Ñ‡πà‡∏≤‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏π‡∏õ‡πÇ‡∏†‡∏Ñ</button>
                                <button class="category-filter-btn" onclick="filterExpensesByCategory('rent')">üè† ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤</button>
                                <button class="category-filter-btn" onclick="filterExpensesByCategory('marketing')">üì¢ ‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î</button>
                                <button class="category-filter-btn" onclick="filterExpensesByCategory('other')">üì¶ ‡∏≠‡∏∑‡πà‡∏ô‡πÜ</button>
                            </div>
                        </div>
                    </div>

                    <!-- Expense Statistics -->
                    <div class="expenses-stats-grid">
                        <div class="stat-card danger">
                            <div class="stat-icon">üí≥</div>
                            <div class="stat-content">
                                <div class="stat-value" id="total-expenses">‡∏ø0</div>
                                <div class="stat-label">‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏ß‡∏°</div>
                                <div class="stat-period">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</div>
                            </div>
                        </div>
                        <div class="stat-card warning">
                            <div class="stat-icon">üìä</div>
                            <div class="stat-content">
                                <div class="stat-value" id="avg-daily-expense">‡∏ø0</div>
                                <div class="stat-label">‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô</div>
                                <div class="stat-period">30 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</div>
                            </div>
                        </div>
                        <div class="stat-card info">
                            <div class="stat-icon">üèÜ</div>
                            <div class="stat-content">
                                <div class="stat-value" id="top-expense-category">-</div>
                                <div class="stat-label">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</div>
                                <div class="stat-period" id="top-category-amount">‡∏ø0</div>
                            </div>
                        </div>
                        <div class="stat-card success">
                            <div class="stat-icon">üí∞</div>
                            <div class="stat-content">
                                <div class="stat-value" id="net-profit-after-expense">‡∏ø0</div>
                                <div class="stat-label">‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</div>
                                <div class="stat-period">‡∏´‡∏•‡∏±‡∏á‡∏´‡∏±‡∏Å‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</div>
                            </div>
                        </div>
                    </div>

                    <!-- Expense Chart -->
                    <div class="chart-section">
                        <div class="chart-header">
                            <h3>‡∏Å‡∏£‡∏≤‡∏ü‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</h3>
                            <div class="chart-controls">
                                <select id="expense-chart-type" onchange="updateExpenseChart()">
                                    <option value="category">‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</option>
                                    <option value="timeline">‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤</option>
                                    <option value="comparison">‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö</option>
                                </select>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="expenses-chart"></canvas>
                        </div>
                    </div>

                    <!-- Quick Add Expenses -->
                    <div class="quick-add-section">
                        <div class="section-header">
                            <h3>‚ö° ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏î‡πà‡∏ß‡∏ô</h3>
                        </div>
                        <div class="quick-add-grid">
                            <button class="quick-add-btn" onclick="addQuickExpense('‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö', 500)">
                                <div class="quick-add-icon">ü•¨</div>
                                <div class="quick-add-label">‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö</div>
                                <div class="quick-add-amount">500‡∏ø</div>
                            </button>
                            <button class="quick-add-btn" onclick="addQuickExpense('‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü', 800)">
                                <div class="quick-add-icon">‚ö°</div>
                                <div class="quick-add-label">‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü</div>
                                <div class="quick-add-amount">800‡∏ø</div>
                            </button>
                            <button class="quick-add-btn" onclick="addQuickExpense('‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥', 200)">
                                <div class="quick-add-icon">üíß</div>
                                <div class="quick-add-label">‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥</div>
                                <div class="quick-add-amount">200‡∏ø</div>
                            </button>
                            <button class="quick-add-btn" onclick="showQuickExpenseModal()">
                                <div class="quick-add-icon">‚ûï</div>
                                <div class="quick-add-label">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</div>
                                <div class="quick-add-amount">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏≠‡∏á</div>
                            </button>
                        </div>
                    </div>

                    <!-- Recent Expenses -->
                    <div class="recent-expenses-section">
                        <div class="section-header">
                            <h3>üïí ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h3>
                            <button class="btn btn-outline" onclick="viewAllExpenses()">‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                        </div>
                        <div class="expense-list" id="recent-expenses-list">
                            <!-- Recent expenses will be loaded here -->
                        </div>
                    </div>

                    <!-- Expense Analysis -->
                    <div class="expense-analysis-section">
                        <div class="section-header">
                            <h3>üìà ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</h3>
                        </div>
                        <div class="analysis-grid">
                            <div class="analysis-card">
                                <div class="analysis-header">
                                    <h4>üéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</h4>
                                    <span class="analysis-period">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="expense-progress" style="width: 0%"></div>
                                </div>
                                <div class="progress-labels">
                                    <span id="current-expense-amount">‡∏ø0</span>
                                    <span id="expense-budget-amount">/ ‡∏ø15,000</span>
                                </div>
                            </div>
                            <div class="analysis-card">
                                <div class="analysis-header">
                                    <h4>üìä ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô</h4>
                                </div>
                                <div class="comparison-stats">
                                    <div class="comparison-item">
                                        <span class="comparison-label">‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏ß‡∏°</span>
                                        <span class="comparison-value" id="expense-comparison">+0%</span>
                                    </div>
                                    <div class="comparison-item">
                                        <span class="comparison-label">‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö</span>
                                        <span class="comparison-value" id="ingredient-comparison">+0%</span>
                                    </div>
                                    <div class="comparison-item">
                                        <span class="comparison-label">‡∏Ñ‡πà‡∏≤‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏π‡∏õ‡πÇ‡∏†‡∏Ñ</span>
                                        <span class="comparison-value" id="utility-comparison">+0%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Inventory Screen -->
            <div id="inventory-screen" class="screen">
                <div class="inventory-container">
                    <div class="screen-header">
                        <h2 class="screen-title">üì¶ ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ï‡πá‡∏≠‡∏Å</h2>
                        <div class="screen-actions">
                            <button class="btn btn-secondary" onclick="exportInventoryData()">üì• ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å</button>
                            <button class="btn btn-warning" onclick="generateReorderReport()">üîÑ ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</button>
                            <button class="btn btn-primary" onclick="refreshInventory()">üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</button>
                        </div>
                    </div>

                    <!-- Inventory Status Overview -->
                    <div class="inventory-status-grid">
                        <div class="status-card critical">
                            <div class="status-icon">üö®</div>
                            <div class="status-content">
                                <div class="status-value" id="critical-stock-count">0</div>
                                <div class="status-label">‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏ß‡∏¥‡∏Å‡∏§‡∏ï</div>
                                <div class="status-desc">‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 20%</div>
                            </div>
                        </div>
                        <div class="status-card warning">
                            <div class="status-icon">‚ö†Ô∏è</div>
                            <div class="status-content">
                                <div class="status-value" id="low-stock-count">0</div>
                                <div class="status-label">‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏ï‡πà‡∏≥</div>
                                <div class="status-desc">‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 50%</div>
                            </div>
                        </div>
                        <div class="status-card success">
                            <div class="status-icon">‚úÖ</div>
                            <div class="status-content">
                                <div class="status-value" id="good-stock-count">0</div>
                                <div class="status-label">‡∏™‡∏ï‡πá‡∏≠‡∏Å‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠</div>
                                <div class="status-desc">‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 50%</div>
                            </div>
                        </div>
                        <div class="status-card info">
                            <div class="status-icon">üìä</div>
                            <div class="status-content">
                                <div class="status-value" id="total-items-count">0</div>
                                <div class="status-label">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                                <div class="status-desc">‡πÉ‡∏ô‡∏Ñ‡∏•‡∏±‡∏á</div>
                            </div>
                        </div>
                    </div>

                    <!-- Inventory Filters -->
                    <div class="inventory-filters">
                        <div class="filter-group">
                            <label>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà:</label>
                            <select id="inventory-category-filter" onchange="filterInventory()">
                                <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                                <option value="bread">‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á</option>
                                <option value="dairy">‡∏ô‡∏° & ‡πÄ‡∏ô‡∏¢</option>
                                <option value="meat">‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏™‡∏±‡∏ï‡∏ß‡πå</option>
                                <option value="vegetable">‡∏ú‡∏±‡∏Å</option>
                                <option value="condiment">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏£‡∏∏‡∏á</option>
                                <option value="beverage">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°</option>
                                <option value="packaging">‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏ï‡πá‡∏≠‡∏Å:</label>
                            <select id="inventory-status-filter" onchange="filterInventory()">
                                <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                                <option value="critical">‡∏ß‡∏¥‡∏Å‡∏§‡∏ï</option>
                                <option value="low">‡∏ï‡πà‡∏≥</option>
                                <option value="sufficient">‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠</option>
                                <option value="excess">‡πÄ‡∏Å‡∏¥‡∏ô</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>‡∏ú‡∏π‡πâ‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢:</label>
                            <select id="inventory-supplier-filter" onchange="filterInventory()">
                                <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                                <!-- Supplier options will be loaded dynamically -->
                            </select>
                        </div>
                        <div class="search-group">
                            <input type="text" id="inventory-search" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£..." onkeyup="searchInventory(this.value)">
                            <span class="search-icon">üîç</span>
                        </div>
                    </div>

                    <!-- Inventory Table -->
                    <div class="inventory-table-section">
                        <div class="table-header">
                            <h3>üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏á‡∏Ñ‡∏•‡∏±‡∏á</h3>
                            <div class="table-actions">
                                <button class="btn btn-outline" onclick="addNewItem()">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>
                                <button class="btn btn-outline" onclick="bulkUpdate()">üìù ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°</button>
                            </div>
                        </div>
                        <div class="table-container">
                            <table class="inventory-table" id="inventory-table">
                                <thead>
                                    <tr>
                                        <th><input type="checkbox" id="select-all-items" onchange="selectAllItems()"></th>
                                        <th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
                                        <th>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</th>
                                        <th>‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</th>
                                        <th>‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥</th>
                                        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                        <th>‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô/‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                                        <th>‡∏ú‡∏π‡πâ‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢</th>
                                        <th>‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</th>
                                        <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                                    </tr>
                                </thead>
                                <tbody id="inventory-table-body">
                                    <!-- Inventory items will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="quick-actions-section">
                        <div class="section-header">
                            <h3>‚ö° ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏î‡πà‡∏ß‡∏ô</h3>
                        </div>
                        <div class="quick-actions-grid">
                            <button class="quick-action-btn reorder" onclick="quickReorder()">
                                <div class="action-icon">üìû</div>
                                <div class="action-label">‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏î‡πà‡∏ß‡∏ô</div>
                                <div class="action-desc">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î</div>
                            </button>
                            <button class="quick-action-btn adjust" onclick="quickStockAdjust()">
                                <div class="action-icon">üìä</div>
                                <div class="action-label">‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏ï‡πá‡∏≠‡∏Å</div>
                                <div class="action-desc">‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</div>
                            </button>
                            <button class="quick-action-btn alert" onclick="setStockAlerts()">
                                <div class="action-icon">üîî</div>
                                <div class="action-label">‡∏ï‡∏±‡πâ‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</div>
                                <div class="action-desc">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏à‡∏∏‡∏î‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</div>
                            </button>
                            <button class="quick-action-btn report" onclick="generateStockReport()">
                                <div class="action-icon">üìÑ</div>
                                <div class="action-label">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å</div>
                                <div class="action-desc">‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                            </button>
                        </div>
                    </div>

                    <!-- Stock Movement History -->
                    <div class="stock-movement-section">
                        <div class="section-header">
                            <h3>üìà ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß</h3>
                            <div class="movement-filters">
                                <select id="movement-type-filter" onchange="filterStockMovement()">
                                    <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                                    <option value="in">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏ï‡πá‡∏≠‡∏Å</option>
                                    <option value="out">‡∏•‡∏î‡∏™‡∏ï‡πá‡∏≠‡∏Å</option>
                                    <option value="adjust">‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á</option>
                                </select>
                            </div>
                        </div>
                        <div class="movement-list" id="stock-movement-list">
                            <!-- Stock movement history will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Reports Screen -->
            <div id="reports-screen" class="screen">
                <div class="reports-container">
                    <div class="screen-header">
                        <h2 class="screen-title">üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</h2>
                        <div class="screen-actions">
                            <button class="btn btn-secondary" onclick="scheduleReports()">üìÖ ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ß‡∏•‡∏≤</button>
                            <button class="btn btn-primary" onclick="generateAllReports()">üìÑ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                        </div>
                    </div>

                    <!-- Report Categories -->
                    <div class="report-categories">
                        <div class="category-tabs">
                            <button class="category-tab active" onclick="switchReportCategory('overview')" data-category="overview">
                                üìà ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°
                            </button>
                            <button class="category-tab" onclick="switchReportCategory('financial')" data-category="financial">
                                üí∞ ‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô
                            </button>
                            <button class="category-tab" onclick="switchReportCategory('inventory')" data-category="inventory">
                                üì¶ ‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
                            </button>
                            <button class="category-tab" onclick="switchReportCategory('performance')" data-category="performance">
                                üéØ ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û
                            </button>
                        </div>
                    </div>

                    <!-- Overview Reports -->
                    <div class="report-content" id="overview-reports">
                        <div class="report-section">
                            <h3>üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</h3>
                            <div class="report-cards-grid">
                                <div class="report-card executive">
                                    <div class="report-header">
                                        <div class="report-icon">üëî</div>
                                        <div class="report-title">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£</div>
                                    </div>
                                    <div class="report-description">‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°</div>
                                    <div class="report-actions">
                                        <button class="btn btn-outline" onclick="previewReport('executive')">üëÅÔ∏è ‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</button>
                                        <button class="btn btn-primary" onclick="generateReport('executive')">üìÑ ‡∏™‡∏£‡πâ‡∏≤‡∏á</button>
                                    </div>
                                </div>
                                <div class="report-card dashboard">
                                    <div class="report-header">
                                        <div class="report-icon">üìä</div>
                                        <div class="report-title">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏™‡∏î</div>
                                    </div>
                                    <div class="report-description">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå</div>
                                    <div class="report-actions">
                                        <button class="btn btn-outline" onclick="previewReport('dashboard')">üëÅÔ∏è ‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</button>
                                        <button class="btn btn-primary" onclick="generateReport('dashboard')">üìÑ ‡∏™‡∏£‡πâ‡∏≤‡∏á</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Financial Reports -->
                    <div class="report-content" id="financial-reports" style="display: none;">
                        <div class="report-section">
                            <h3>üí∞ ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</h3>
                            <div class="report-cards-grid">
                                <div class="report-card profit-loss">
                                    <div class="report-header">
                                        <div class="report-icon">ÔøΩ</div>
                                        <div class="report-title">‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô</div>
                                    </div>
                                    <div class="report-description">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ - ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢ = ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</div>
                                    <div class="report-preview">
                                        <div class="preview-stat">
                                            <span class="stat-label">‡∏Å‡∏≥‡πÑ‡∏£‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ:</span>
                                            <span class="stat-value profit" id="monthly-profit">+‡∏ø0</span>
                                        </div>
                                    </div>
                                    <div class="report-actions">
                                        <button class="btn btn-outline" onclick="previewReport('profit-loss')">üëÅÔ∏è ‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</button>
                                        <button class="btn btn-primary" onclick="generateReport('profit-loss')">üìÑ ‡∏™‡∏£‡πâ‡∏≤‡∏á</button>
                                    </div>
                                </div>
                                <div class="report-card cash-flow">
                                    <div class="report-header">
                                        <div class="report-icon">ÔøΩ</div>
                                        <div class="report-title">‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î</div>
                                    </div>
                                    <div class="report-description">‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡∏Ç‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î</div>
                                    <div class="report-preview">
                                        <div class="preview-stat">
                                            <span class="stat-label">‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:</span>
                                            <span class="stat-value" id="cash-balance">‡∏ø0</span>
                                        </div>
                                    </div>
                                    <div class="report-actions">
                                        <button class="btn btn-outline" onclick="previewReport('cash-flow')">üëÅÔ∏è ‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</button>
                                        <button class="btn btn-primary" onclick="generateReport('cash-flow')">üìÑ ‡∏™‡∏£‡πâ‡∏≤‡∏á</button>
                                    </div>
                                </div>
                                <div class="report-card tax">
                                    <div class="report-header">
                                        <div class="report-icon">üßæ</div>
                                        <div class="report-title">‡∏†‡∏≤‡∏©‡∏µ</div>
                                    </div>
                                    <div class="report-description">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏µ</div>
                                    <div class="report-preview">
                                        <div class="preview-stat">
                                            <span class="stat-label">VAT ‡∏Ñ‡πâ‡∏≤‡∏á‡∏à‡πà‡∏≤‡∏¢:</span>
                                            <span class="stat-value" id="vat-payable">‡∏ø0</span>
                                        </div>
                                    </div>
                                    <div class="report-actions">
                                        <button class="btn btn-outline" onclick="previewReport('tax')">üëÅÔ∏è ‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</button>
                                        <button class="btn btn-primary" onclick="generateReport('tax')">üìÑ ‡∏™‡∏£‡πâ‡∏≤‡∏á</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Inventory Reports -->
                    <div class="report-content" id="inventory-reports" style="display: none;">
                        <div class="report-section">
                            <h3>ÔøΩ ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
                            <div class="report-cards-grid">
                                <div class="report-card stock-level">
                                    <div class="report-header">
                                        <div class="report-icon">üìä</div>
                                        <div class="report-title">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏ï‡πá‡∏≠‡∏Å</div>
                                    </div>
                                    <div class="report-description">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏á‡∏Ñ‡∏•‡∏±‡∏á</div>
                                    <div class="report-actions">
                                        <button class="btn btn-outline" onclick="previewReport('stock-level')">üëÅÔ∏è ‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</button>
                                        <button class="btn btn-primary" onclick="generateReport('stock-level')">üìÑ ‡∏™‡∏£‡πâ‡∏≤‡∏á</button>
                                    </div>
                                </div>
                                <div class="report-card reorder">
                                    <div class="report-header">
                                        <div class="report-icon">üîÑ</div>
                                        <div class="report-title">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</div>
                                    </div>
                                    <div class="report-description">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</div>
                                    <div class="report-actions">
                                        <button class="btn btn-outline" onclick="previewReport('reorder')">üëÅÔ∏è ‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</button>
                                        <button class="btn btn-primary" onclick="generateReport('reorder')">üìÑ ‡∏™‡∏£‡πâ‡∏≤‡∏á</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Performance Reports -->
                    <div class="report-content" id="performance-reports" style="display: none;">
                        <div class="report-section">
                            <h3>üéØ ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û</h3>
                            <div class="report-cards-grid">
                                <div class="report-card sales-performance">
                                    <div class="report-header">
                                        <div class="report-icon">üèÜ</div>
                                        <div class="report-title">‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</div>
                                    </div>
                                    <div class="report-description">‡πÄ‡∏°‡∏ô‡∏π‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ & ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°</div>
                                    <div class="report-actions">
                                        <button class="btn btn-outline" onclick="previewReport('sales-performance')">üëÅÔ∏è ‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</button>
                                        <button class="btn btn-primary" onclick="generateReport('sales-performance')">üìÑ ‡∏™‡∏£‡πâ‡∏≤‡∏á</button>
                                    </div>
                                </div>
                                <div class="report-card cost-analysis">
                                    <div class="report-header">
                                        <div class="report-icon">üí°</div>
                                        <div class="report-title">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô</div>
                                    </div>
                                    <div class="report-description">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô & ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≥‡πÑ‡∏£</div>
                                    <div class="report-actions">
                                        <button class="btn btn-outline" onclick="previewReport('cost-analysis')">üëÅÔ∏è ‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</button>
                                        <button class="btn btn-primary" onclick="generateReport('cost-analysis')">üìÑ ‡∏™‡∏£‡πâ‡∏≤‡∏á</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Generated Reports History -->
                    <div class="reports-history-section">
                        <div class="section-header">
                            <h3>üìÅ ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</h3>
                            <button class="btn btn-outline" onclick="clearReportsHistory()">üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</button>
                        </div>
                        <div class="reports-history-list" id="reports-history-list">
                            <!-- Reports history will be loaded here -->
                        </div>
                    </div>

                    <!-- Report Preview Modal -->
                    <div id="report-preview-modal" class="modal" style="display: none;">
                        <div class="modal-content report-preview-content">
                            <div class="modal-header">
                                <h3 id="preview-report-title">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</h3>
                                <button class="close-btn" onclick="closeReportPreview()">√ó</button>
                            </div>
                            <div class="report-preview-body" id="report-preview-body">
                                <!-- Report preview content -->
                            </div>
                            <div class="modal-actions">
                                <button class="btn btn-secondary" onclick="closeReportPreview()">‡∏õ‡∏¥‡∏î</button>
                                <button class="btn btn-primary" onclick="downloadCurrentReport()">üì• ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Screen -->
            <div id="settings-screen" class="screen">
                <div class="list-container">
                    <div class="list-header">
                        <h3 class="list-title">‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</h3>
                    </div>
                    <div class="form-container">
                        <div class="form-group">
                            <label>‡∏ä‡∏∑‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô:</label>
                            <input type="text" id="shop-name" value="ü•™ ‡∏£‡πâ‡∏≤‡∏ô Sandwich ‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏°" readonly>
                        </div>
                        <div class="form-group">
                            <label>‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏≠‡∏õ:</label>
                            <input type="text" id="app-version-display" value="1.0.0-refactor" readonly>
                        </div>
                        <div class="form-group">
                            <label>‡∏ò‡∏µ‡∏°‡∏™‡∏µ:</label>
                            <select id="theme-selector" onchange="changeTheme(this.value)">
                                <option value="purple">‡∏°‡πà‡∏ß‡∏á (‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô)</option>
                                <option value="blue">‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô</option>
                                <option value="green">‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏ï‡πä‡∏≠‡∏Å:</label>
                            <input type="number" id="stock-threshold" value="5" min="1" max="50">
                            <small>‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ (‡∏´‡∏ô‡πà‡∏ß‡∏¢)</small>
                        </div>
                        <div class="modal-actions">
                            <button class="btn-save" onclick="saveSettings()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
                            <button class="btn-cancel" onclick="resetSettings()">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
                        </div>
                    </div>

                    <!-- Mock Data Management Section -->
                    <div class="list-container" style="margin-top: 20px;">
                        <div class="list-header">
                            <h4>üé≠ ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏î‡∏™‡∏≠ÿ®</h4>
                        </div>
                        <div style="padding: 15px;">
                            <div class="actions-grid" style="grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 16px;">
                                <button class="action-btn" onclick="loadMockData()" style="background: #10b981; color: white;">
                                    <div class="action-icon">üîÑ</div>
                                    <div class="action-label">‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡∏•‡∏≠‡∏á</div>
                                </button>
                                <button class="action-btn" onclick="clearMockData()" style="background: #ef4444; color: white;">
                                    <div class="action-icon">üóëÔ∏è</div>
                                    <div class="action-label">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>
                                </button>
                            </div>
                            <div id="mock-data-status" style="padding: 12px; background: #f0f9f4; border-radius: 8px; font-size: 14px; color: #059669;">
                                <div>üìä ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡∏•‡∏≠‡∏á: <span id="mock-status">‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î</span></div>
                                <div id="mock-stats" style="margin-top: 8px; font-size: 12px;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="list-container" style="margin-top: 20px;">
                        <div class="list-header">
                            <h4>‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÅ‡∏≠‡∏õ</h4>
                        </div>
                        <div style="padding: 15px; color: #666; font-size: 14px; line-height: 1.6;">
                            <p><strong>ü•™ ‡∏£‡πâ‡∏≤‡∏ô Sandwich ‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏°</strong></p>
                            <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏ã‡∏ô‡∏î‡πå‡∏ß‡∏¥‡∏ä‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏£‡∏ö‡∏ß‡∏á‡∏à‡∏£</p>
                            <p>‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô: 1.0.0-refactor</p>
                            <p>¬© 2025 Sandwich ‡∏Å‡∏•‡∏° - ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢ ‚ù§Ô∏è</p>
                            <p>‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô: support@sandwich‡∏Å‡∏•‡∏°.com</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Navigation -->
    <div class="bottom-nav" role="navigation" aria-label="Primary">
            <div class="nav-items">
                <div class="nav-item active" onclick="switchScreen('dashboard-screen')">
                    <div class="nav-icon" data-icon="home">
                        <span class="emoji-icon">üè†</span>
                        <i class="fas fa-home fallback-icon"></i>
                    </div>
                    <div class="nav-label">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</div>
                </div>
                <div class="nav-item" onclick="switchScreen('pos-screen')">
                    <div class="nav-icon" data-icon="cart">
                        <span class="emoji-icon">üõí</span>
                        <i class="fas fa-shopping-cart fallback-icon"></i>
                    </div>
                    <div class="nav-label">‡∏Ç‡∏≤‡∏¢</div>
                </div>
                <div class="nav-item" onclick="switchScreen('inventory-screen')">
                    <div class="nav-icon" data-icon="inventory">
                        <span class="emoji-icon">üì¶</span>
                        <i class="fas fa-boxes fallback-icon"></i>
                    </div>
                    <div class="nav-label">‡∏™‡∏ï‡πä‡∏≠‡∏Å</div>
                </div>
                <div class="nav-item" onclick="switchScreen('reports-screen')">
                    <div class="nav-icon" data-icon="reports">
                        <span class="emoji-icon">üìä</span>
                        <i class="fas fa-chart-bar fallback-icon"></i>
                    </div>
                    <div class="nav-label">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</div>
                </div>
                <div class="nav-item" onclick="switchScreen('settings-screen')">
                    <div class="nav-icon" data-icon="settings">
                        <span class="emoji-icon">‚öôÔ∏è</span>
                        <i class="fas fa-cog fallback-icon"></i>
                    </div>
                    <div class="nav-label">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</div>
                </div>
            </div>
        </div>

    <script>
        // IMMEDIATE FUNCTION DEFINITIONS FOR CRITICAL OPERATIONS
        // These must be available immediately when page loads

        window.switchScreen = function(screenId) {
            console.log('Switching to screen:', screenId);

            try {
                // Hide all screens
                document.querySelectorAll('.screen').forEach(screen => {
                    screen.classList.remove('active');
                });

                // Show target screen
                const targetScreen = document.getElementById(screenId);
                if (targetScreen) {
                    targetScreen.classList.add('active');
                    console.log('Screen activated:', screenId);
                } else {
                    console.error('Screen not found:', screenId);
                    return;
                }

                // Update navigation
                document.querySelectorAll('.nav-item').forEach(nav => {
                    nav.classList.remove('active');
                });

                // Find and activate corresponding nav item
                const navMap = {
                    'dashboard-screen': 0,
                    'pos-screen': 1,
                    'inventory-screen': 2,
                    'reports-screen': 3,
                    'settings-screen': 4
                };

                const navIndex = navMap[screenId];
                if (navIndex !== undefined) {
                    const navItems = document.querySelectorAll('.nav-item');
                    if (navItems[navIndex]) {
                        navItems[navIndex].classList.add('active');
                        console.log('Navigation updated for index:', navIndex);
                    }
                }

                // Load screen-specific data if functions are available
                if (typeof refreshDashboard === 'function' && screenId === 'dashboard-screen') {
                    refreshDashboard();
                } else if (typeof loadMenuItems === 'function' && screenId === 'pos-screen') {
                    loadMenuItems();
                } else if (screenId === 'settings-screen') {
                    // Initialize settings screen data
                    setTimeout(() => {
                        if (typeof updateDataStats === 'function') {
                            updateDataStats();
                        }
                    }, 100);
                }

            } catch (error) {
                console.error('Error switching screen:', error);
            }
        };

        // Other critical immediate functions
        window.showQuickExpenseModal = function() {
            const modal = document.getElementById('quick-expense-modal');
            if (modal) modal.classList.add('active');
            console.log('Quick expense modal shown');
        };

        window.closeQuickExpenseModal = function() {
            const modal = document.getElementById('quick-expense-modal');
            if (modal) modal.classList.remove('active');
            console.log('Quick expense modal closed');
        };

        window.showCostAnalysis = function() {
            const modal = document.getElementById('cost-analysis-modal');
            if (modal) modal.classList.add('active');
            console.log('Cost analysis modal shown');
        };

        window.closeCostAnalysisModal = function() {
            const modal = document.getElementById('cost-analysis-modal');
            if (modal) modal.classList.remove('active');
            console.log('Cost analysis modal closed');
        };

        window.checkout = function() {
            console.log('Checkout initiated');
            alert('‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏≠‡∏≤‡∏ó‡πå ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£...');
        };

        // COMPLETE DASHBOARD IMPLEMENTATION
        window.refreshDashboard = function() {
            console.log('üîÑ Refreshing dashboard with real data...');

            try {
                // Update all dashboard components
                updateDashboardMetrics();
                updateRecentSales();
                updateAlerts();
                updateQuickActions();
                updateDailyChart();
                updateTopProducts();
                updateLowStockAlerts();

                console.log('‚úÖ Dashboard refreshed successfully');
            } catch (error) {
                console.error('‚ùå Dashboard refresh error:', error);
            }
        };

        // Update main dashboard metrics
        function updateDashboardMetrics() {
            const today = new Date();
            const todayStr = today.toISOString().split('T')[0];

            // Simulate real-time data (integrate with Supabase later)
            const mockData = {
                todaysSales: 2847,
                todaysProfit: 1423,
                totalOrders: 47,
                avgOrderValue: 60.57,
                hourlyTrend: 12.5 // percentage increase
            };

            // Update sales display
            const salesElement = document.querySelector('.metric-card:nth-child(1) .metric-value');
            if (salesElement) {
                salesElement.innerHTML = `‡∏ø${mockData.todaysSales.toLocaleString()}`;
            }

            // Update profit display
            const profitElement = document.querySelector('.metric-card:nth-child(2) .metric-value');
            if (profitElement) {
                profitElement.innerHTML = `‡∏ø${mockData.todaysProfit.toLocaleString()}`;
            }

            // Update orders display
            const ordersElement = document.querySelector('.metric-card:nth-child(3) .metric-value');
            if (ordersElement) {
                ordersElement.innerHTML = mockData.totalOrders.toString();
            }

            // Update average order value
            const avgElement = document.querySelector('.metric-card:nth-child(4) .metric-value');
            if (avgElement) {
                avgElement.innerHTML = `‡∏ø${mockData.avgOrderValue.toFixed(0)}`;
            }
        }

        // Update recent sales list
        function updateRecentSales() {
            const recentSalesContainer = document.querySelector('#recent-sales-list');
            if (!recentSalesContainer) return;

            const recentSales = [
                { time: '14:23', items: '‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå‡∏Ñ‡∏•‡∏≤‡∏™‡∏™‡∏¥‡∏Å x2, ‡∏Å‡∏≤‡πÅ‡∏ü‡πÄ‡∏¢‡πá‡∏ô x1', amount: 140, profit: 68 },
                { time: '14:15', items: '‡πÅ‡∏Æ‡∏°‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå x1, ‡∏Å‡∏≤‡πÅ‡∏ü‡∏£‡πâ‡∏≠‡∏ô x2', amount: 96, profit: 51 },
                { time: '14:08', items: '‡∏î‡∏±‡∏ö‡πÄ‡∏ö‡∏¥‡πâ‡∏•‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå x1', amount: 65, profit: 30 },
                { time: '13:58', items: '‡∏ó‡∏π‡∏ô‡πà‡∏≤‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå x1, ‡∏Å‡∏≤‡πÅ‡∏ü‡πÄ‡∏¢‡πá‡∏ô x1', amount: 110, profit: 60 },
                { time: '13:45', items: '‡∏™‡∏∏‡∏û‡∏£‡∏µ‡∏°‡πÇ‡∏ó‡∏™‡∏ï‡πå x1, ‡∏Å‡∏≤‡πÅ‡∏ü‡∏£‡πâ‡∏≠‡∏ô x1', amount: 108, profit: 48 }
            ];

            recentSalesContainer.innerHTML = recentSales.map(sale => `
                <div class="recent-sale-item" style="display: flex; justify-content: space-between; padding: 12px; border-bottom: 1px solid #f0f0f0;">
                    <div>
                        <div style="font-weight: 500; font-size: 14px;">${sale.time}</div>
                        <div style="color: #666; font-size: 12px; margin-top: 2px;">${sale.items}</div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-weight: 600; color: #2ecc71;">‡∏ø${sale.amount}</div>
                        <div style="color: #666; font-size: 12px;">‡∏Å‡∏≥‡πÑ‡∏£ ‡∏ø${sale.profit}</div>
                    </div>
                </div>
            `).join('');
        }

        // Update alerts section
        function updateAlerts() {
            const alertsContainer = document.querySelector('#dashboard-alerts');
            if (!alertsContainer) return;

            const alerts = [
                { type: 'warning', icon: '‚ö†Ô∏è', message: '‡∏ä‡∏µ‡∏™‡∏™‡πÑ‡∏•‡∏ã‡πå‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ô‡πâ‡∏≠‡∏¢ (‡πÄ‡∏´‡∏•‡∏∑‡∏≠ 12 ‡∏ä‡∏¥‡πâ‡∏ô)', time: '10 ‡∏ô‡∏≤‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß' },
                { type: 'info', icon: 'üìä', message: '‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ß‡∏≤‡∏ô 15%', time: '1 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß' },
                { type: 'success', icon: '‚úÖ', message: '‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡πâ‡∏ß', time: '2 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß' }
            ];

            alertsContainer.innerHTML = alerts.map(alert => `
                <div class="alert-item" style="display: flex; align-items: center; padding: 10px; background: ${alert.type === 'warning' ? '#fff3cd' : alert.type === 'success' ? '#d1e7dd' : '#d1ecf1'}; border-radius: 8px; margin-bottom: 8px;">
                    <span style="font-size: 18px; margin-right: 10px;">${alert.icon}</span>
                    <div style="flex: 1;">
                        <div style="font-size: 13px; font-weight: 500;">${alert.message}</div>
                        <div style="font-size: 11px; color: #666; margin-top: 2px;">${alert.time}</div>
                    </div>
                </div>
            `).join('');
        }

        // Update quick actions
        function updateQuickActions() {
            console.log('Quick actions updated');
        }

        // Update daily sales chart
        function updateDailyChart() {
            const canvas = document.querySelector('#dailySalesChart');
            if (!canvas) return;

            try {
                // Destroy existing chart if exists
                if (window.dailyChart) {
                    window.dailyChart.destroy();
                }

                const ctx = canvas.getContext('2d');
                const hours = Array.from({length: 14}, (_, i) => `${8 + i}:00`);
                const salesData = [120, 180, 250, 420, 380, 520, 680, 750, 420, 380, 520, 450, 380, 220];

                window.dailyChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: hours,
                        datasets: [{
                            label: '‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ (‡∏ö‡∏≤‡∏ó)',
                            data: salesData,
                            borderColor: '#4f46e5',
                            backgroundColor: 'rgba(79, 70, 229, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return '‡∏ø' + value;
                                    }
                                }
                            }
                        }
                    }
                });
            } catch (error) {
                console.error('Chart creation error:', error);
            }
        }

        // Update top products
        function updateTopProducts() {
            const topProductsContainer = document.querySelector('#top-products-list');
            if (!topProductsContainer) return;

            const topProducts = [
                { name: '‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå‡∏Ñ‡∏•‡∏≤‡∏™‡∏™‡∏¥‡∏Å', sales: 28, revenue: 1680, trend: '+12%' },
                { name: '‡∏Å‡∏≤‡πÅ‡∏ü‡πÄ‡∏¢‡πá‡∏ô', sales: 45, revenue: 1125, trend: '+8%' },
                { name: '‡πÅ‡∏Æ‡∏°‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå', sales: 18, revenue: 1080, trend: '+5%' },
                { name: '‡∏î‡∏±‡∏ö‡πÄ‡∏ö‡∏¥‡πâ‡∏•‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå', sales: 15, revenue: 975, trend: '+15%' },
                { name: '‡∏Å‡∏≤‡πÅ‡∏ü‡∏£‡πâ‡∏≠‡∏ô', sales: 32, revenue: 768, trend: '+3%' }
            ];

            topProductsContainer.innerHTML = topProducts.map((product, index) => `
                <div class="top-product-item" style="display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid #f0f0f0;">
                    <div style="display: flex; align-items: center;">
                        <div style="width: 24px; height: 24px; background: #4f46e5; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 600; margin-right: 12px;">
                            ${index + 1}
                        </div>
                        <div>
                            <div style="font-weight: 500; font-size: 13px;">${product.name}</div>
                            <div style="color: #666; font-size: 11px;">${product.sales} ‡∏Ç‡∏≤‡∏¢</div>
                        </div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-weight: 600; color: #2ecc71; font-size: 13px;">‡∏ø${product.revenue.toLocaleString()}</div>
                        <div style="color: #10b981; font-size: 11px;">${product.trend}</div>
                    </div>
                </div>
            `).join('');
        }

        // Update low stock alerts
        function updateLowStockAlerts() {
            const lowStockContainer = document.querySelector('#low-stock-alerts');
            if (!lowStockContainer) return;

            const lowStockItems = [
                { name: '‡∏ä‡∏µ‡∏™‡∏™‡πÑ‡∏•‡∏ã‡πå', current: 12, minimum: 20, unit: '‡∏ä‡∏¥‡πâ‡∏ô', urgency: 'high' },
                { name: '‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡πÇ‡∏ó‡∏™‡∏ï‡πå', current: 25, minimum: 40, unit: '‡∏ä‡∏¥‡πâ‡∏ô', urgency: 'medium' },
                { name: '‡πÄ‡∏ö‡∏Ñ‡∏≠‡∏ô', current: 8, minimum: 15, unit: '‡πÅ‡∏ú‡πà‡∏ô', urgency: 'high' },
                { name: '‡πÄ‡∏ô‡∏¢‡∏™‡∏î', current: 1, minimum: 3, unit: '‡∏Å‡πâ‡∏≠‡∏ô', urgency: 'critical' }
            ];

            lowStockContainer.innerHTML = lowStockItems.map(item => `
                <div class="low-stock-item" style="display: flex; justify-content: space-between; align-items: center; padding: 8px 12px; background: ${item.urgency === 'critical' ? '#fef2f2' : item.urgency === 'high' ? '#fefbeb' : '#f0f9f4'}; border-radius: 6px; margin-bottom: 6px; border-left: 3px solid ${item.urgency === 'critical' ? '#dc2626' : item.urgency === 'high' ? '#d97706' : '#059669'};">
                    <div>
                        <div style="font-weight: 500; font-size: 12px;">${item.name}</div>
                        <div style="color: #666; font-size: 11px;">‡πÄ‡∏´‡∏•‡∏∑‡∏≠ ${item.current} ${item.unit}</div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 11px; color: ${item.urgency === 'critical' ? '#dc2626' : item.urgency === 'high' ? '#d97706' : '#059669'}; font-weight: 600;">
                            ${item.urgency === 'critical' ? '‡∏ß‡∏¥‡∏Å‡∏§‡∏ï!' : item.urgency === 'high' ? '‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô' : '‡∏ï‡πà‡∏≥'}
                        </div>
                        <div style="font-size: 10px; color: #666;">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ ${item.minimum}</div>
                    </div>
                </div>
            `).join('');
        }

        window.toggleMenu = function() {
            console.log('Menu toggled');
        };

        window.showAlerts = function() {
            console.log('Showing alerts');
            alert('üö® ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: ‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥');
        };

        window.generateFilteredReport = function() {
            console.log('Generating filtered report');
            alert('üìä ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô... ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà');
        };

        // Mobile Manager POS System - JavaScript

        // COMPLETE POS SYSTEM IMPLEMENTATION

        // Menu data with complete pricing and categories
        const menuData = {
            toast: [
                { id: 'MENU005', name: '‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå‡∏Ñ‡∏•‡∏≤‡∏™‡∏™‡∏¥‡∏Å', price: 60, cost: 25, image: 'üßÄ', description: '‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡πÇ‡∏ó‡∏™‡∏ï‡πå‡∏Å‡∏±‡∏ö‡∏ä‡∏µ‡∏™‡πÄ‡∏ä‡∏î‡∏î‡∏≤‡∏£‡πå‡∏´‡∏•‡∏≤‡∏¢ ‡πÜ ‡∏ä‡∏±‡πâ‡∏ô' },
                { id: 'MENU006', name: '‡∏î‡∏±‡∏ö‡πÄ‡∏ö‡∏¥‡πâ‡∏•‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå', price: 65, cost: 35, image: 'üßÄüßÄ', description: '‡∏ä‡∏µ‡∏™‡∏™‡∏≠‡∏á‡∏ä‡∏±‡πâ‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏£‡∏™‡∏ä‡∏≤‡∏ï‡∏¥‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡πâ‡∏ô' },
                { id: 'MENU010', name: '‡πÅ‡∏Æ‡∏°‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå', price: 75, cost: 40, image: 'ü•™', description: '‡πÅ‡∏Æ‡∏°‡∏Ñ‡∏ß‡∏ö‡∏Å‡∏±‡∏ö‡∏ä‡∏µ‡∏™‡∏≠‡∏£‡πà‡∏≠‡∏¢' },
                { id: 'MENU011', name: '‡πÄ‡∏ö‡∏Ñ‡∏≠‡∏ô‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå', price: 85, cost: 45, image: 'ü•ì', description: '‡πÄ‡∏ö‡∏Ñ‡∏≠‡∏ô‡∏Å‡∏£‡∏≠‡∏ö‡∏Å‡∏±‡∏ö‡∏ä‡∏µ‡∏™‡∏´‡∏•‡∏≤‡∏¢ ‡πÜ ‡∏ä‡∏±‡πâ‡∏ô' },
                { id: 'MENU013', name: '‡∏ó‡∏π‡∏ô‡πà‡∏≤‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå', price: 90, cost: 50, image: 'üêü', description: '‡∏ó‡∏π‡∏ô‡πà‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏û‡∏£‡∏µ‡πÄ‡∏°‡∏µ‡∏¢‡∏°‡∏Å‡∏±‡∏ö‡∏ä‡∏µ‡∏™' },
                { id: 'MENU012', name: '‡πÑ‡∏Å‡πà‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå', price: 80, cost: 35, image: 'üêî', description: '‡πÑ‡∏Å‡πà‡∏¢‡πà‡∏≤‡∏á‡∏´‡∏≠‡∏°‡∏Å‡∏±‡∏ö‡∏ä‡∏µ‡∏™‡∏•‡∏∞‡∏•‡∏≤‡∏¢' },
                { id: 'MENU015', name: '‡∏™‡∏∏‡∏û‡∏£‡∏µ‡∏°‡πÇ‡∏ó‡∏™‡∏ï‡πå', price: 95, cost: 60, image: 'üëë', description: '‡∏£‡∏ß‡∏°‡∏°‡∏¥‡∏ï‡∏£‡∏ó‡∏∏‡∏Å‡∏ä‡∏ô‡∏¥‡∏î ‡πÅ‡∏Æ‡∏° ‡πÄ‡∏ö‡∏Ñ‡∏≠‡∏ô ‡πÑ‡∏Å‡πà ‡∏ä‡∏µ‡∏™' }
            ],
            bread: [
                { id: 'MENU001', name: '‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏õ‡∏¥‡πâ‡∏á‡πÄ‡∏ô‡∏¢‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á', price: 35, cost: 15, image: 'üçØ', description: '‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏õ‡∏¥‡πâ‡∏á‡∏´‡∏≠‡∏° ‡πÜ ‡∏ó‡∏≤‡πÄ‡∏ô‡∏¢‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á' },
                { id: 'MENU002', name: '‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏õ‡∏¥‡πâ‡∏á‡πÅ‡∏¢‡∏°‡∏™‡∏ï‡∏£‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà', price: 40, cost: 18, image: 'üçì', description: '‡πÅ‡∏¢‡∏°‡∏™‡∏ï‡∏£‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà‡∏´‡∏ß‡∏≤‡∏ô‡∏´‡∏≠‡∏°' },
                { id: 'MENU003', name: '‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏õ‡∏¥‡πâ‡∏á‡πÅ‡∏¢‡∏°‡∏™‡πâ‡∏°', price: 40, cost: 18, image: 'üçä', description: '‡πÅ‡∏¢‡∏°‡∏™‡πâ‡∏°‡∏™‡∏î‡∏ä‡∏∑‡πà‡∏ô ‡∏£‡∏™‡πÄ‡∏õ‡∏£‡∏µ‡πâ‡∏¢‡∏ß‡∏´‡∏ß‡∏≤‡∏ô' },
                { id: 'MENU004', name: '‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏õ‡∏¥‡πâ‡∏á‡∏ä‡πá‡∏≠‡∏Å‡πÇ‡∏Å‡πÅ‡∏•‡∏ï', price: 45, cost: 20, image: 'üç´', description: '‡∏ä‡πá‡∏≠‡∏Å‡πÇ‡∏Å‡πÅ‡∏•‡∏ï‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡πâ‡∏ô ‡∏´‡∏ß‡∏≤‡∏ô‡∏•‡∏¥‡πâ‡∏ô' }
            ],
            drinks: [
                { id: 'MENU024', name: '‡∏Å‡∏≤‡πÅ‡∏ü‡∏£‡πâ‡∏≠‡∏ô', price: 25, cost: 8, image: '‚òï', description: '‡∏Å‡∏≤‡πÅ‡∏ü‡∏£‡πâ‡∏≠‡∏ô‡∏´‡∏≠‡∏°‡∏Å‡∏£‡∏∏‡πà‡∏ô ‡∏Ñ‡∏±‡πà‡∏ß‡πÄ‡∏Ç‡πâ‡∏°' },
                { id: 'MENU025', name: '‡∏Å‡∏≤‡πÅ‡∏ü‡πÄ‡∏¢‡πá‡∏ô', price: 30, cost: 10, image: 'üßä', description: '‡∏Å‡∏≤‡πÅ‡∏ü‡πÄ‡∏¢‡πá‡∏ô‡∏™‡∏î‡∏ä‡∏∑‡πà‡∏ô ‡∏´‡∏≠‡∏°‡∏Å‡∏£‡∏∏‡πà‡∏ô' },
                { id: 'MENU026', name: '‡∏ä‡∏≤‡∏£‡πâ‡∏≠‡∏ô', price: 20, cost: 6, image: 'üçµ', description: '‡∏ä‡∏≤‡∏£‡πâ‡∏≠‡∏ô‡∏´‡∏≠‡∏°‡∏´‡∏ß‡∏≤‡∏ô' },
                { id: 'MENU027', name: '‡∏ä‡∏≤‡πÄ‡∏¢‡πá‡∏ô', price: 25, cost: 8, image: 'üßäüçµ', description: '‡∏ä‡∏≤‡πÄ‡∏¢‡πá‡∏ô‡∏´‡∏ß‡∏≤‡∏ô‡∏ä‡∏∑‡πà‡∏ô‡πÉ‡∏à' },
                { id: 'MENU028', name: '‡πÇ‡∏Å‡πÇ‡∏Å‡πâ‡∏£‡πâ‡∏≠‡∏ô', price: 35, cost: 12, image: 'üç´‚òï', description: '‡πÇ‡∏Å‡πÇ‡∏Å‡πâ‡∏£‡πâ‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡πâ‡∏ô ‡∏´‡∏≠‡∏°‡∏´‡∏ß‡∏≤‡∏ô' },
                { id: 'MENU029', name: '‡∏ô‡πâ‡∏≥‡∏™‡πâ‡∏°‡∏Ñ‡∏±‡πâ‡∏ô‡∏™‡∏î', price: 40, cost: 15, image: 'üçäü•§', description: '‡∏ô‡πâ‡∏≥‡∏™‡πâ‡∏°‡∏Ñ‡∏±‡πâ‡∏ô‡∏™‡∏î 100% ‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•' }
            ]
        };

        // Load menu items into POS with mock data support
        function loadMenuItems() {
            console.log('üçΩÔ∏è Loading menu items...');

            // If mock data is available, use it
            if (typeof mockDB !== 'undefined' && mockDB) {
                const mockMenuItems = mockDB.getMockData('menuItems');
                if (mockMenuItems.length > 0) {
                    console.log('üé≠ Using mock menu data:', mockMenuItems.length, 'items');
                    window.menuData = {};

                    // Organize menu items by category
                    mockMenuItems.forEach(item => {
                        if (!window.menuData[item.category]) {
                            window.menuData[item.category] = [];
                        }
                        window.menuData[item.category].push(item);
                    });

                    // Load hot sandwiches first
                    loadCategoryMenu('hot_sandwich');
                    return;
                }
            }

            // Fallback to default menu
            loadCategoryMenu('toast');
        }

        function loadCategoryMenu(category) {
            const menuGrid = document.querySelector('#menu-items-grid');
            if (!menuGrid) return;

            const items = menuData[category] || [];

            menuGrid.innerHTML = items.map(item => `
                <div class="menu-item-card" onclick="addToCart('${item.id}')" style="
                    background: white;
                    border-radius: 12px;
                    padding: 16px;
                    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                    cursor: pointer;
                    transition: transform 0.2s;
                    text-align: center;
                    border: 1px solid #f0f0f0;
                " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                    <div style="font-size: 32px; margin-bottom: 8px;">${item.image}</div>
                    <h4 style="font-size: 14px; font-weight: 600; margin: 0 0 4px 0; color: #1a1a1a;">${item.name}</h4>
                    <p style="font-size: 11px; color: #666; margin: 0 0 8px 0; line-height: 1.3;">${item.description}</p>
                    <div style="font-size: 16px; font-weight: 700; color: #4f46e5;">‡∏ø${item.price}</div>
                    <div style="font-size: 10px; color: #999; margin-top: 2px;">‡∏Å‡∏≥‡πÑ‡∏£ ‡∏ø${item.price - item.cost}</div>
                </div>
            `).join('');
        }

        // Category switching
        window.showCategory = function(category) {
            // Update active tab
            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`[onclick="showCategory('${category}')"]`).classList.add('active');

            // Load category menu
            loadCategoryMenu(category);
        };

        // Add item to cart
        window.addToCart = function(itemId) {
            const allItems = [...menuData.toast, ...menuData.bread, ...menuData.drinks];
            const item = allItems.find(i => i.id === itemId);

            if (!item) return;

            // Check if item already in cart
            const existingItem = currentCart.find(cartItem => cartItem.id === itemId);

            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                currentCart.push({
                    id: item.id,
                    name: item.name,
                    price: item.price,
                    cost: item.cost,
                    quantity: 1,
                    image: item.image
                });
            }

            updateCartDisplay();

            // Visual feedback
            const button = document.querySelector(`[onclick="addToCart('${itemId}')"]`);
            if (button) {
                button.style.background = '#10b981';
                button.style.color = 'white';
                setTimeout(() => {
                    button.style.background = 'white';
                    button.style.color = '#1a1a1a';
                }, 200);
            }
        };

        // Update cart display
        function updateCartDisplay() {
            const cartItems = document.querySelector('#cart-items');
            const cartTotal = document.querySelector('#cart-total');
            const cartCount = document.querySelector('#cart-count');

            if (!cartItems) return;

            if (currentCart.length === 0) {
                cartItems.innerHTML = `
                    <div style="text-align: center; color: #666; padding: 40px 20px;">
                        <div style="font-size: 48px; margin-bottom: 16px;">üõí</div>
                        <p>‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤</p>
                        <p style="font-size: 14px;">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢</p>
                    </div>
                `;
            } else {
                cartItems.innerHTML = currentCart.map(item => `
                    <div class="cart-item" style="display: flex; align-items: center; padding: 12px; border-bottom: 1px solid #f0f0f0;">
                        <span style="font-size: 20px; margin-right: 12px;">${item.image}</span>
                        <div style="flex: 1;">
                            <div style="font-weight: 500; font-size: 14px;">${item.name}</div>
                            <div style="color: #666; font-size: 12px;">‡∏ø${item.price} x ${item.quantity}</div>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <button onclick="decreaseQuantity('${item.id}')" style="width: 24px; height: 24px; border: 1px solid #ddd; background: #f9f9f9; border-radius: 4px; cursor: pointer; font-size: 14px;">-</button>
                            <span style="font-weight: 600; min-width: 20px; text-align: center;">${item.quantity}</span>
                            <button onclick="increaseQuantity('${item.id}')" style="width: 24px; height: 24px; border: 1px solid #ddd; background: #f9f9f9; border-radius: 4px; cursor: pointer; font-size: 14px;">+</button>
                            <button onclick="removeFromCart('${item.id}')" style="width: 24px; height: 24px; border: 1px solid #dc2626; background: #fef2f2; color: #dc2626; border-radius: 4px; cursor: pointer; font-size: 12px; margin-left: 8px;">√ó</button>
                        </div>
                    </div>
                `).join('');
            }

            // Update totals
            const total = currentCart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const totalCost = currentCart.reduce((sum, item) => sum + (item.cost * item.quantity), 0);
            const totalProfit = total - totalCost;
            const itemCount = currentCart.reduce((sum, item) => sum + item.quantity, 0);

            if (cartTotal) {
                cartTotal.innerHTML = `
                    <div style="padding: 16px; background: #f8f9fa; border-radius: 8px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span>‡∏£‡∏ß‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ${itemCount} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span>
                            <span style="font-weight: 600;">‡∏ø${total.toLocaleString()}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; font-size: 12px; color: #666;">
                            <span>‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô</span>
                            <span>‡∏ø${totalCost.toLocaleString()}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; font-size: 12px; color: #10b981; margin-bottom: 16px;">
                            <span>‡∏Å‡∏≥‡πÑ‡∏£</span>
                            <span>‡∏ø${totalProfit.toLocaleString()}</span>
                        </div>
                        <button onclick="processCheckout()" style="width: 100%; padding: 12px; background: #4f46e5; color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer;" ${currentCart.length === 0 ? 'disabled' : ''}>
                            ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô ‡∏ø${total.toLocaleString()}
                        </button>
                    </div>
                `;
            }

            if (cartCount) {
                cartCount.textContent = itemCount > 0 ? itemCount : '';
                cartCount.style.display = itemCount > 0 ? 'block' : 'none';
            }
        }

        // Cart manipulation functions
        window.increaseQuantity = function(itemId) {
            const item = currentCart.find(i => i.id === itemId);
            if (item) {
                item.quantity += 1;
                updateCartDisplay();
            }
        };

        window.decreaseQuantity = function(itemId) {
            const item = currentCart.find(i => i.id === itemId);
            if (item && item.quantity > 1) {
                item.quantity -= 1;
                updateCartDisplay();
            }
        };

        window.removeFromCart = function(itemId) {
            currentCart = currentCart.filter(item => item.id !== itemId);
            updateCartDisplay();
        };

        window.clearCart = function() {
            currentCart = [];
            updateCartDisplay();
        };

        // Process checkout
        window.processCheckout = function() {
            if (currentCart.length === 0) return;

            const total = currentCart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const totalCost = currentCart.reduce((sum, item) => sum + (item.cost * item.quantity), 0);
            const totalProfit = total - totalCost;

            // Create order summary
            const orderSummary = currentCart.map(item => `${item.name} x${item.quantity}`).join('\n');

            const confirmed = confirm(`üõí ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô\n\n${orderSummary}\n\n‡∏£‡∏ß‡∏°‡πÄ‡∏á‡∏¥‡∏ô: ‡∏ø${total.toLocaleString()}\n‡∏Å‡∏≥‡πÑ‡∏£: ‡∏ø${totalProfit.toLocaleString()}\n\n‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`);

            if (confirmed) {
                // Process payment
                saveSale({
                    items: [...currentCart],
                    total: total,
                    cost: totalCost,
                    profit: totalProfit,
                    timestamp: new Date().toISOString()
                });

                // Clear cart
                currentCart = [];
                updateCartDisplay();

                // Show success message
                showMessage(`‚úÖ ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\n‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° ‡∏ø${total.toLocaleString()}`, 'success');

                // Refresh dashboard
                if (typeof refreshDashboard === 'function') {
                    setTimeout(refreshDashboard, 1000);
                }
            }
        };

        // Save sale to database (integrate with Supabase later)
        function saveSale(saleData) {
            console.log('üíæ Saving sale:', saleData);

            // Store in localStorage for now (will integrate with Supabase)
            const sales = JSON.parse(localStorage.getItem('sales') || '[]');
            sales.push({
                ...saleData,
                id: 'SALE' + Date.now(),
                date: new Date().toISOString().split('T')[0]
            });
            localStorage.setItem('sales', JSON.stringify(sales));
        }

        // COMPLETE INVENTORY MANAGEMENT SYSTEM

        // Inventory data with current stock levels
        const inventoryData = [
            { id: 'ING001', name: '‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡πÇ‡∏ó‡∏™‡∏ï‡πå', category: 'bread', current: 25, minimum: 40, unit: '‡∏ä‡∏¥‡πâ‡∏ô', cost: 3, supplier: '‡πÄ‡∏ö‡πÄ‡∏Å‡∏≠‡∏£‡∏µ‡πà‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß', lastOrder: '2025-09-20' },
            { id: 'ING002', name: '‡∏ä‡∏µ‡∏™‡∏™‡πÑ‡∏•‡∏ã‡πå', category: 'dairy', current: 12, minimum: 20, unit: '‡∏ä‡∏¥‡πâ‡∏ô', cost: 8, supplier: '‡∏ô‡∏°‡πÑ‡∏ó‡∏¢', lastOrder: '2025-09-22' },
            { id: 'ING003', name: '‡πÄ‡∏ô‡∏¢‡∏™‡∏î', category: 'dairy', current: 1, minimum: 3, unit: '‡∏Å‡πâ‡∏≠‡∏ô', cost: 45, supplier: '‡∏ô‡∏°‡πÑ‡∏ó‡∏¢', lastOrder: '2025-09-18' },
            { id: 'ING004', name: '‡πÅ‡∏Æ‡∏°‡∏™‡πÑ‡∏•‡∏ã‡πå', category: 'meat', current: 15, minimum: 25, unit: '‡πÅ‡∏ú‡πà‡∏ô', cost: 12, supplier: '‡πÇ‡∏õ‡∏£‡∏ï‡∏µ‡∏ô‡πÇ‡∏ü‡∏£‡πÄ‡∏ã‡πà‡∏ô', lastOrder: '2025-09-21' },
            { id: 'ING005', name: '‡πÄ‡∏ö‡∏Ñ‡∏≠‡∏ô', category: 'meat', current: 8, minimum: 15, unit: '‡πÅ‡∏ú‡πà‡∏ô', cost: 15, supplier: '‡πÇ‡∏õ‡∏£‡∏ï‡∏µ‡∏ô‡πÇ‡∏ü‡∏£‡πÄ‡∏ã‡πà‡∏ô', lastOrder: '2025-09-19' },
            { id: 'ING006', name: '‡πÑ‡∏Å‡πà‡∏¢‡πà‡∏≤‡∏á', category: 'meat', current: 20, minimum: 30, unit: '‡∏ä‡∏¥‡πâ‡∏ô', cost: 18, supplier: '‡πÑ‡∏Å‡πà‡∏™‡∏î‡πÉ‡∏´‡∏°‡πà', lastOrder: '2025-09-23' },
            { id: 'ING007', name: '‡∏ó‡∏π‡∏ô‡πà‡∏≤‡πÉ‡∏ô‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô', category: 'canned', current: 5, minimum: 10, unit: '‡∏Å‡∏£‡∏∞‡∏õ‡πã‡∏≠‡∏á', cost: 35, supplier: '‡∏ã‡∏µ‡∏ü‡∏π‡πâ‡∏î‡πÄ‡∏ã‡πá‡∏ô‡πÄ‡∏ï‡∏≠‡∏£‡πå', lastOrder: '2025-09-20' },
            { id: 'ING008', name: '‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á', category: 'condiment', current: 2, minimum: 3, unit: '‡∏Ç‡∏ß‡∏î', cost: 120, supplier: '‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥', lastOrder: '2025-09-15' },
            { id: 'ING009', name: '‡πÅ‡∏¢‡∏°‡∏™‡∏ï‡∏£‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà', category: 'condiment', current: 3, minimum: 5, unit: '‡∏Å‡∏£‡∏∞‡∏õ‡∏∏‡∏Å', cost: 85, supplier: '‡πÄ‡∏Æ‡∏≠‡∏£‡πå‡∏ä‡∏µ‡πà‡∏¢‡πå', lastOrder: '2025-09-17' },
            { id: 'ING010', name: '‡πÅ‡∏¢‡∏°‡∏™‡πâ‡∏°', category: 'condiment', current: 4, minimum: 5, unit: '‡∏Å‡∏£‡∏∞‡∏õ‡∏∏‡∏Å', cost: 80, supplier: '‡πÄ‡∏Æ‡∏≠‡∏£‡πå‡∏ä‡∏µ‡πà‡∏¢‡πå', lastOrder: '2025-09-17' },
            { id: 'ING011', name: '‡πÄ‡∏ü‡πà‡∏¢‡πÄ‡∏Å‡πâ‡∏≤‡∏Ñ‡∏±‡πà‡∏ß‡πÄ‡∏Ç‡πâ‡∏°', category: 'beverage', current: 800, minimum: 500, unit: '‡∏Å‡∏£‡∏±‡∏°', cost: 180, supplier: '‡∏Ñ‡∏≠‡∏ü‡∏ü‡∏µ‡πà‡∏ä‡πá‡∏≠‡∏õ', lastOrder: '2025-09-22' },
            { id: 'ING012', name: '‡πÉ‡∏ö‡∏ä‡∏≤', category: 'beverage', current: 200, minimum: 300, unit: '‡∏Å‡∏£‡∏±‡∏°', cost: 95, supplier: '‡∏ä‡∏≤‡πÑ‡∏ó‡∏¢', lastOrder: '2025-09-19' },
            { id: 'ING013', name: '‡∏ô‡∏°', category: 'dairy', current: 6, minimum: 10, unit: '‡∏•‡∏¥‡∏ï‡∏£', cost: 28, supplier: '‡∏ô‡∏°‡πÑ‡∏ó‡∏¢', lastOrder: '2025-09-23' },
            { id: 'ING014', name: '‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•', category: 'condiment', current: 2, minimum: 5, unit: '‡∏Å‡∏¥‡πÇ‡∏•‡∏Å‡∏£‡∏±‡∏°', cost: 35, supplier: '‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡∏°‡∏¥‡∏ï‡∏£‡∏ú‡∏•', lastOrder: '2025-09-18' }
        ];

        // Load inventory data
        function loadInventoryData() {
            console.log('üì¶ Loading inventory data...');
            displayInventoryList();
            updateInventorySummary();
            checkLowStockAlerts();
        }

        // Display inventory list
        function displayInventoryList(filteredData = null) {
            const inventoryContainer = document.querySelector('#inventory-list');
            if (!inventoryContainer) return;

            const dataToShow = filteredData || inventoryData;

            inventoryContainer.innerHTML = dataToShow.map(item => {
                const stockLevel = item.current / item.minimum;
                const alertLevel = stockLevel <= 0.3 ? 'critical' : stockLevel <= 0.6 ? 'warning' : 'normal';
                const alertColor = alertLevel === 'critical' ? '#dc2626' : alertLevel === 'warning' ? '#d97706' : '#059669';
                const alertBg = alertLevel === 'critical' ? '#fef2f2' : alertLevel === 'warning' ? '#fefbeb' : '#f0f9f4';

                return `
                    <div class="inventory-item" style="background: white; border-radius: 12px; padding: 16px; margin-bottom: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-left: 4px solid ${alertColor};">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 12px;">
                            <div style="flex: 1;">
                                <h4 style="margin: 0 0 4px 0; font-size: 16px; font-weight: 600;">${item.name}</h4>
                                <p style="margin: 0; color: #666; font-size: 12px; text-transform: capitalize;">${item.category} ‚Ä¢ ${item.supplier}</p>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-size: 18px; font-weight: 700; color: ${alertColor};">${item.current} ${item.unit}</div>
                                <div style="font-size: 11px; color: #666;">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ ${item.minimum}</div>
                            </div>
                        </div>

                        <div style="background: ${alertBg}; border-radius: 6px; padding: 8px; margin-bottom: 12px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
                                <span style="font-size: 12px; color: ${alertColor}; font-weight: 600;">
                                    ${alertLevel === 'critical' ? 'üî¥ ‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏ß‡∏¥‡∏Å‡∏§‡∏ï' : alertLevel === 'warning' ? 'üü° ‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏ï‡πà‡∏≥' : 'üü¢ ‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏õ‡∏Å‡∏ï‡∏¥'}
                                </span>
                                <span style="font-size: 11px; color: #666;">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ ${Math.round(stockLevel * 100)}%</span>
                            </div>
                            <div style="background: #e5e7eb; border-radius: 3px; height: 4px;">
                                <div style="background: ${alertColor}; height: 4px; border-radius: 3px; width: ${Math.min(stockLevel * 100, 100)}%;"></div>
                            </div>
                        </div>

                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <div>
                                <div style="font-size: 12px; color: #666;">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô/‡∏´‡∏ô‡πà‡∏ß‡∏¢</div>
                                <div style="font-size: 14px; font-weight: 600;">‡∏ø${item.cost}</div>
                            </div>
                            <div>
                                <div style="font-size: 12px; color: #666;">‡∏™‡∏±‡πà‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</div>
                                <div style="font-size: 14px; font-weight: 600;">${new Date(item.lastOrder).toLocaleDateString('th-TH')}</div>
                            </div>
                        </div>

                        <div style="display: flex; gap: 8px;">
                            <button onclick="adjustStock('${item.id}', 'add')" style="flex: 1; padding: 8px; background: #10b981; color: white; border: none; border-radius: 6px; font-size: 12px; cursor: pointer;">
                                ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏ï‡πá‡∏≠‡∏Å
                            </button>
                            <button onclick="adjustStock('${item.id}', 'remove')" style="flex: 1; padding: 8px; background: #6b7280; color: white; border: none; border-radius: 6px; font-size: 12px; cursor: pointer;">
                                ‡πÉ‡∏ä‡πâ‡∏™‡∏ï‡πá‡∏≠‡∏Å
                            </button>
                            <button onclick="orderStock('${item.id}')" style="flex: 1; padding: 8px; background: #4f46e5; color: white; border: none; border-radius: 6px; font-size: 12px; cursor: pointer;">
                                ‡∏™‡∏±‡πà‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Update inventory summary
        function updateInventorySummary() {
            const totalItems = inventoryData.length;
            const lowStockItems = inventoryData.filter(item => item.current <= item.minimum * 0.6).length;
            const criticalItems = inventoryData.filter(item => item.current <= item.minimum * 0.3).length;
            const totalValue = inventoryData.reduce((sum, item) => sum + (item.current * item.cost), 0);

            const summaryContainer = document.querySelector('#inventory-summary');
            if (summaryContainer) {
                summaryContainer.innerHTML = `
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 20px;">
                        <div style="background: white; padding: 16px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <div style="color: #666; font-size: 12px; margin-bottom: 4px;">‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>
                            <div style="font-size: 24px; font-weight: 700; color: #1a1a1a;">${totalItems}</div>
                        </div>
                        <div style="background: white; padding: 16px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <div style="color: #666; font-size: 12px; margin-bottom: 4px;">‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏™‡∏ï‡πá‡∏≠‡∏Å</div>
                            <div style="font-size: 24px; font-weight: 700; color: #10b981;">‡∏ø${totalValue.toLocaleString()}</div>
                        </div>
                        <div style="background: white; padding: 16px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <div style="color: #666; font-size: 12px; margin-bottom: 4px;">‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏ï‡πà‡∏≥</div>
                            <div style="font-size: 24px; font-weight: 700; color: #d97706;">${lowStockItems}</div>
                        </div>
                        <div style="background: white; padding: 16px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <div style="color: #666; font-size: 12px; margin-bottom: 4px;">‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏ß‡∏¥‡∏Å‡∏§‡∏ï</div>
                            <div style="font-size: 24px; font-weight: 700; color: #dc2626;">${criticalItems}</div>
                        </div>
                    </div>
                `;
            }
        }

        // Check low stock alerts
        function checkLowStockAlerts() {
            const lowStockItems = inventoryData.filter(item => {
                const stockLevel = item.current / item.minimum;
                return stockLevel <= 0.6;
            });

            const alertsContainer = document.querySelector('#stock-alerts');
            if (alertsContainer) {
                if (lowStockItems.length === 0) {
                    alertsContainer.innerHTML = `
                        <div style="text-align: center; padding: 20px; color: #10b981;">
                            <div style="font-size: 32px; margin-bottom: 8px;">‚úÖ</div>
                            <p>‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏õ‡∏Å‡∏ï‡∏¥</p>
                        </div>
                    `;
                } else {
                    alertsContainer.innerHTML = `
                        <div style="margin-bottom: 16px;">
                            <h4 style="color: #dc2626; margin: 0 0 12px 0;">‚ö†Ô∏è ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏£‡πà‡∏á‡∏™‡∏±‡πà‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏° (${lowStockItems.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)</h4>
                        </div>
                        ${lowStockItems.map(item => {
                            const stockLevel = item.current / item.minimum;
                            const isUrgent = stockLevel <= 0.3;
                            return `
                                <div style="background: ${isUrgent ? '#fef2f2' : '#fefbeb'}; border: 1px solid ${isUrgent ? '#fecaca' : '#fed7aa'}; border-radius: 8px; padding: 12px; margin-bottom: 8px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <div>
                                            <div style="font-weight: 600; color: ${isUrgent ? '#dc2626' : '#d97706'};">${item.name}</div>
                                            <div style="font-size: 12px; color: #666;">‡πÄ‡∏´‡∏•‡∏∑‡∏≠ ${item.current} ${item.unit} (‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ ${item.minimum - item.current} ${item.unit})</div>
                                        </div>
                                        <button onclick="orderStock('${item.id}')" style="padding: 6px 12px; background: ${isUrgent ? '#dc2626' : '#d97706'}; color: white; border: none; border-radius: 4px; font-size: 12px; cursor: pointer;">
                                            ${isUrgent ? '‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô!' : '‡∏™‡∏±‡πà‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°'}
                                        </button>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    `;
                }
            }
        }

        // Stock adjustment functions
        window.adjustStock = function(itemId, action) {
            const item = inventoryData.find(i => i.id === itemId);
            if (!item) return;

            const amount = prompt(`${action === 'add' ? '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏ï‡πá‡∏≠‡∏Å' : '‡πÉ‡∏ä‡πâ‡∏™‡∏ï‡πá‡∏≠‡∏Å'} ${item.name}\n\n‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (${item.unit}):`);
            if (!amount || isNaN(amount) || parseInt(amount) <= 0) return;

            if (action === 'add') {
                item.current += parseInt(amount);
                showMessage(`‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏ï‡πá‡∏≠‡∏Å ${item.name} ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ${amount} ${item.unit}`, 'success');
            } else {
                if (item.current >= parseInt(amount)) {
                    item.current -= parseInt(amount);
                    showMessage(`‚úÖ ‡πÉ‡∏ä‡πâ‡∏™‡∏ï‡πá‡∏≠‡∏Å ${item.name} ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ${amount} ${item.unit}`, 'info');
                } else {
                    showMessage(`‚ùå ‡∏™‡∏ï‡πá‡∏≠‡∏Å‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠ ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏û‡∏µ‡∏¢‡∏á ${item.current} ${item.unit}`, 'error');
                    return;
                }
            }

            // Refresh displays
            displayInventoryList();
            updateInventorySummary();
            checkLowStockAlerts();
        };

        window.orderStock = function(itemId) {
            const item = inventoryData.find(i => i.id === itemId);
            if (!item) return;

            const shortfall = Math.max(0, item.minimum - item.current);
            const recommendedOrder = shortfall + Math.ceil(item.minimum * 0.2); // 20% buffer

            const amount = prompt(`‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ ${item.name}\n\n‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ${recommendedOrder} ${item.unit}\n‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á:`);
            if (!amount || isNaN(amount) || parseInt(amount) <= 0) return;

            const orderAmount = parseInt(amount);
            const totalCost = orderAmount * item.cost;

            const confirmed = confirm(`‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠\n\n‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤: ${item.name}\n‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: ${orderAmount} ${item.unit}\n‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏£‡∏ß‡∏°: ‡∏ø${totalCost.toLocaleString()}\n‡∏ú‡∏π‡πâ‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢: ${item.supplier}\n\n‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`);

            if (confirmed) {
                // Simulate order processing
                item.current += orderAmount;
                item.lastOrder = new Date().toISOString().split('T')[0];

                showMessage(`‚úÖ ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\n${item.name} ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ${orderAmount} ${item.unit}\n‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô ‡∏ø${totalCost.toLocaleString()}`, 'success');

                // Refresh displays
                displayInventoryList();
                updateInventorySummary();
                checkLowStockAlerts();
            }
        };

        // Filter inventory
        window.filterInventory = function(category) {
            if (category === 'all') {
                displayInventoryList();
            } else {
                const filtered = inventoryData.filter(item => item.category === category);
                displayInventoryList(filtered);
            }

            // Update filter button states
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
        // COMPLETE REPORTS SYSTEM

        // Generate mock sales data for reports
        function generateSalesData(days = 30) {
            const sales = [];
            const today = new Date();

            for (let i = days - 1; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);

                // Generate realistic daily sales
                const baseAmount = 1500 + Math.random() * 2000;
                const dayOfWeek = date.getDay();
                const weekendBoost = (dayOfWeek === 0 || dayOfWeek === 6) ? 1.3 : 1;
                const dailySales = Math.round(baseAmount * weekendBoost);
                const dailyCost = Math.round(dailySales * 0.4); // 40% cost ratio
                const dailyProfit = dailySales - dailyCost;

                const orderCount = Math.floor(dailySales / 65); // Average order value ~65

                sales.push({
                    date: date.toISOString().split('T')[0],
                    sales: dailySales,
                    cost: dailyCost,
                    profit: dailyProfit,
                    orders: orderCount,
                    avgOrderValue: Math.round(dailySales / orderCount)
                });
            }

            return sales;
        }

        // Load reports data
        function loadReportsData() {
            console.log('üìä Loading reports data...');
            displaySalesSummary();
            displaySalesChart();
            displayTopProductsReport();
            displayProfitAnalysis();
            displayDailyBreakdown();
        }

        // Display sales summary
        function displaySalesSummary() {
            const salesData = generateSalesData(30);
            const totalSales = salesData.reduce((sum, day) => sum + day.sales, 0);
            const totalProfit = salesData.reduce((sum, day) => sum + day.profit, 0);
            const totalOrders = salesData.reduce((sum, day) => sum + day.orders, 0);
            const avgDailySales = Math.round(totalSales / salesData.length);
            const profitMargin = Math.round((totalProfit / totalSales) * 100);

            // Compare with previous period
            const prevPeriodData = generateSalesData(30);
            const prevTotalSales = prevPeriodData.reduce((sum, day) => sum + day.sales, 0);
            const salesGrowth = Math.round(((totalSales - prevTotalSales) / prevTotalSales) * 100);

            const summaryContainer = document.querySelector('#sales-summary');
            if (summaryContainer) {
                summaryContainer.innerHTML = `
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-bottom: 24px;">
                        <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px;">
                                <div style="color: #666; font-size: 14px;">‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏° (30 ‡∏ß‡∏±‡∏ô)</div>
                                <span style="background: #10b981; color: white; padding: 2px 6px; border-radius: 12px; font-size: 10px;">${salesGrowth > 0 ? '+' : ''}${salesGrowth}%</span>
                            </div>
                            <div style="font-size: 28px; font-weight: 700; color: #1a1a1a;">‡∏ø${totalSales.toLocaleString()}</div>
                            <div style="color: #666; font-size: 12px; margin-top: 4px;">‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ ‡∏ø${avgDailySales.toLocaleString()}/‡∏ß‡∏±‡∏ô</div>
                        </div>

                        <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <div style="color: #666; font-size: 14px; margin-bottom: 8px;">‡∏Å‡∏≥‡πÑ‡∏£‡∏£‡∏ß‡∏° (30 ‡∏ß‡∏±‡∏ô)</div>
                            <div style="font-size: 28px; font-weight: 700; color: #10b981;">‡∏ø${totalProfit.toLocaleString()}</div>
                            <div style="color: #666; font-size: 12px; margin-top: 4px;">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≥‡πÑ‡∏£ ${profitMargin}%</div>
                        </div>

                        <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <div style="color: #666; font-size: 14px; margin-bottom: 8px;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</div>
                            <div style="font-size: 28px; font-weight: 700; color: #4f46e5;">${totalOrders.toLocaleString()}</div>
                            <div style="color: #666; font-size: 12px; margin-top: 4px;">‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ ${Math.round(totalOrders / 30)} ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå/‡∏ß‡∏±‡∏ô</div>
                        </div>

                        <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <div style="color: #666; font-size: 14px; margin-bottom: 8px;">‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢/‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</div>
                            <div style="font-size: 28px; font-weight: 700; color: #d97706;">‡∏ø${Math.round(totalSales / totalOrders)}</div>
                            <div style="color: #666; font-size: 12px; margin-top: 4px;">‡∏ä‡πà‡∏ß‡∏á ‡∏ø45-125</div>
                        </div>
                    </div>
                `;
            }
        }

        // Display sales chart
        function displaySalesChart() {
            const canvas = document.querySelector('#salesChart');
            if (!canvas) return;

            try {
                // Destroy existing chart
                if (window.salesChart) {
                    window.salesChart.destroy();
                }

                const ctx = canvas.getContext('2d');
                const salesData = generateSalesData(30);
                const labels = salesData.map(day => new Date(day.date).toLocaleDateString('th-TH', { day: 'numeric', month: 'short' }));
                const salesValues = salesData.map(day => day.sales);
                const profitValues = salesData.map(day => day.profit);

                window.salesChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [
                            {
                                label: '‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ (‡∏ö‡∏≤‡∏ó)',
                                data: salesValues,
                                borderColor: '#4f46e5',
                                backgroundColor: 'rgba(79, 70, 229, 0.1)',
                                tension: 0.4,
                                fill: false
                            },
                            {
                                label: '‡∏Å‡∏≥‡πÑ‡∏£ (‡∏ö‡∏≤‡∏ó)',
                                data: profitValues,
                                borderColor: '#10b981',
                                backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                tension: 0.4,
                                fill: false
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: {
                            intersect: false,
                            mode: 'index'
                        },
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return '‡∏ø' + value.toLocaleString();
                                    }
                                }
                            }
                        }
                    }
                });
            } catch (error) {
                console.error('Sales chart creation error:', error);
            }
        }

        // Display top products report
        function displayTopProductsReport() {
            const topProducts = [
                { name: '‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå‡∏Ñ‡∏•‡∏≤‡∏™‡∏™‡∏¥‡∏Å', sales: 847, revenue: 50820, profit: 25410, growth: 12 },
                { name: '‡∏Å‡∏≤‡πÅ‡∏ü‡πÄ‡∏¢‡πá‡∏ô', sales: 1245, revenue: 37350, profit: 24855, growth: 8 },
                { name: '‡πÅ‡∏Æ‡∏°‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå', sales: 542, revenue: 40650, profit: 19620, growth: 5 },
                { name: '‡∏î‡∏±‡∏ö‡πÄ‡∏ö‡∏¥‡πâ‡∏•‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå', sales: 456, revenue: 29640, profit: 15684, growth: 15 },
                { name: '‡πÄ‡∏ö‡∏Ñ‡∏≠‡∏ô‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå', sales: 387, revenue: 32895, profit: 15225, growth: -3 },
                { name: '‡∏Å‡∏≤‡πÅ‡∏ü‡∏£‡πâ‡∏≠‡∏ô', sales: 1089, revenue: 27225, profit: 18636, growth: 3 },
                { name: '‡∏ó‡∏π‡∏ô‡πà‡∏≤‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå', sales: 298, revenue: 26820, profit: 13426, growth: 22 },
                { name: '‡πÑ‡∏Å‡πà‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå', sales: 334, revenue: 26720, profit: 14690, growth: 7 }
            ];

            const productsContainer = document.querySelector('#top-products-report');
            if (productsContainer) {
                productsContainer.innerHTML = `
                    <div style="background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); overflow: hidden;">
                        <div style="padding: 20px; border-bottom: 1px solid #f0f0f0;">
                            <h3 style="margin: 0; font-size: 18px;">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ (30 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î)</h3>
                        </div>
                        <div style="max-height: 400px; overflow-y: auto;">
                            ${topProducts.map((product, index) => `
                                <div style="display: flex; align-items: center; padding: 16px 20px; border-bottom: 1px solid #f9f9f9;">
                                    <div style="width: 32px; height: 32px; background: ${index < 3 ? '#fcd34d' : '#e5e7eb'}; color: ${index < 3 ? '#92400e' : '#6b7280'}; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; margin-right: 16px;">
                                        ${index + 1}
                                    </div>
                                    <div style="flex: 1;">
                                        <div style="font-weight: 600; margin-bottom: 4px;">${product.name}</div>
                                        <div style="color: #666; font-size: 13px;">${product.sales} ‡∏Ç‡∏≤‡∏¢ ‚Ä¢ ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ ‡∏ø${product.revenue.toLocaleString()}</div>
                                    </div>
                                    <div style="text-align: right;">
                                        <div style="font-weight: 600; color: #10b981; margin-bottom: 2px;">‡∏ø${product.profit.toLocaleString()}</div>
                                        <div style="font-size: 12px; color: ${product.growth >= 0 ? '#10b981' : '#ef4444'};">
                                            ${product.growth >= 0 ? '+' : ''}${product.growth}%
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }
        }

        // Display profit analysis
        function displayProfitAnalysis() {
            const categories = [
                { name: '‡πÇ‡∏ó‡∏™‡∏ï‡πå', revenue: 246565, cost: 148842, profit: 97723, margin: 39.6 },
                { name: '‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°', revenue: 89050, cost: 26715, profit: 62335, margin: 70.0 },
                { name: '‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏õ‡∏¥‡πâ‡∏á', revenue: 34580, cost: 15561, profit: 19019, margin: 55.0 }
            ];

            const analysisContainer = document.querySelector('#profit-analysis');
            if (analysisContainer) {
                analysisContainer.innerHTML = `
                    <div style="background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); padding: 20px;">
                        <h3 style="margin: 0 0 20px 0; font-size: 18px;">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Å‡∏≥‡πÑ‡∏£‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</h3>
                        ${categories.map(category => `
                            <div style="margin-bottom: 20px; padding: 16px; background: #f9fafb; border-radius: 8px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                    <h4 style="margin: 0; font-size: 16px;">${category.name}</h4>
                                    <span style="font-weight: 600; color: #10b981; font-size: 14px;">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≥‡πÑ‡∏£ ${category.margin}%</span>
                                </div>

                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 12px;">
                                    <div>
                                        <div style="font-size: 12px; color: #666;">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</div>
                                        <div style="font-weight: 600; color: #4f46e5;">‡∏ø${category.revenue.toLocaleString()}</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 12px; color: #666;">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô</div>
                                        <div style="font-weight: 600; color: #ef4444;">‡∏ø${category.cost.toLocaleString()}</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 12px; color: #666;">‡∏Å‡∏≥‡πÑ‡∏£</div>
                                        <div style="font-weight: 600; color: #10b981;">‡∏ø${category.profit.toLocaleString()}</div>
                                    </div>
                                </div>

                                <div style="background: #e5e7eb; border-radius: 4px; height: 8px; overflow: hidden;">
                                    <div style="background: #10b981; height: 8px; width: ${category.margin}%;"></div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }
        }

        // Display daily breakdown
        function displayDailyBreakdown() {
            const salesData = generateSalesData(7); // Last 7 days

            const breakdownContainer = document.querySelector('#daily-breakdown');
            if (breakdownContainer) {
                breakdownContainer.innerHTML = `
                    <div style="background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); overflow: hidden;">
                        <div style="padding: 20px; border-bottom: 1px solid #f0f0f0;">
                            <h3 style="margin: 0; font-size: 18px;">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô (7 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î)</h3>
                        </div>
                        <div>
                            ${salesData.reverse().map(day => {
                                const date = new Date(day.date);
                                const isToday = date.toDateString() === new Date().toDateString();
                                return `
                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 20px; border-bottom: 1px solid #f9f9f9; ${isToday ? 'background: #f0f9f4;' : ''}">
                                        <div>
                                            <div style="font-weight: 600; margin-bottom: 2px;">
                                                ${date.toLocaleDateString('th-TH', { weekday: 'long', day: 'numeric', month: 'long' })}
                                                ${isToday ? '<span style="color: #10b981; font-size: 12px; margin-left: 8px;">‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</span>' : ''}
                                            </div>
                                            <div style="color: #666; font-size: 13px;">${day.orders} ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå ‚Ä¢ ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ ‡∏ø${day.avgOrderValue}/‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</div>
                                        </div>
                                        <div style="text-align: right;">
                                            <div style="font-weight: 600; font-size: 16px; margin-bottom: 2px;">‡∏ø${day.sales.toLocaleString()}</div>
                                            <div style="color: #10b981; font-size: 13px;">‡∏Å‡∏≥‡πÑ‡∏£ ‡∏ø${day.profit.toLocaleString()}</div>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                `;
            }
        }

        // Filter reports by date range
        window.applyDateFilter = function() {
            const startDate = document.querySelector('#report-start-date')?.value;
            const endDate = document.querySelector('#report-end-date')?.value;

            if (!startDate || !endDate) {
                showMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà', 'warning');
                return;
            }

            showMessage(`üîç ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ${startDate} ‡∏ñ‡∏∂‡∏á ${endDate}...`, 'info');

            // Simulate filtered data loading
            setTimeout(() => {
                loadReportsData();
                showMessage('‚úÖ ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', 'success');
            }, 1000);
        };

        // Export report
        window.exportReport = function(format) {
            const reportData = {
                generatedDate: new Date().toISOString(),
                format: format,
                data: generateSalesData(30)
            };

            if (format === 'csv') {
                downloadCSV(reportData.data);
            } else if (format === 'pdf') {
                showMessage('üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á PDF...', 'info');
                setTimeout(() => {
                    showMessage('‚úÖ ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô PDF ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏•‡πâ‡∏ß (‡∏à‡∏≥‡∏•‡∏≠‡∏á)', 'success');
                }, 2000);
            }
        };

        // Download CSV function
        function downloadCSV(data) {
            const headers = ['‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà', '‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢', '‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô', '‡∏Å‡∏≥‡πÑ‡∏£', '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå', '‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢'];
            const csvContent = [
                headers.join(','),
                ...data.map(row => [
                    row.date,
                    row.sales,
                    row.cost,
                    row.profit,
                    row.orders,
                    row.avgOrderValue
                ].join(','))
            ].join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢_${new Date().toISOString().split('T')[0]}.csv`);
            link.click();
        }

        // COMPLETE SETTINGS SYSTEM & REMAINING FUNCTIONS

        // Settings data
        const appSettings = {
            business: {
                name: '‡∏£‡πâ‡∏≤‡∏ô Sandwich ‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏°',
                address: '123 ‡∏ñ‡∏ô‡∏ô‡∏™‡∏≤‡∏¢‡∏•‡∏°‡πÉ‡∏ï‡πâ ‡∏ï‡∏≥‡∏ö‡∏•‡∏™‡∏≤‡∏¢‡∏•‡∏° ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û 10400',
                phone: '02-123-4567',
                email: 'info@sandwich‡∏Å‡∏•‡∏°.com',
                taxId: '0123456789012'
            },
            pos: {
                currency: 'THB',
                taxRate: 7,
                serviceCharge: 0,
                receiptFooter: '‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£',
                autoDiscount: false,
                soundEnabled: true
            },
            notifications: {
                lowStock: true,
                dailyReport: true,
                weeklyReport: false,
                monthlyReport: true,
                stockAlerts: true
            },
            system: {
                theme: 'light',
                language: 'th',
                dateFormat: 'dd/mm/yyyy',
                numberFormat: 'thai',
                backupEnabled: true,
                autoBackup: 'daily'
            }
        };

        // Load settings data
        function loadSettingsData() {
            console.log('‚öôÔ∏è Loading settings...');
            displayBusinessSettings();
            displayPosSettings();
            displayNotificationSettings();
            displaySystemSettings();
        }

        // Display business settings
        function displayBusinessSettings() {
            const container = document.querySelector('#business-settings');
            if (!container) return;

            container.innerHTML = `
                <div class="settings-section">
                    <h4 style="margin: 0 0 16px 0; color: #1a1a1a;">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤</h4>

                    <div style="margin-bottom: 16px;">
                        <label style="display: block; font-size: 14px; font-weight: 500; margin-bottom: 6px; color: #374151;">‡∏ä‡∏∑‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô</label>
                        <input type="text" value="${appSettings.business.name}"
                               style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px;"
                               onchange="updateSetting('business', 'name', this.value)">
                    </div>

                    <div style="margin-bottom: 16px;">
                        <label style="display: block; font-size: 14px; font-weight: 500; margin-bottom: 6px; color: #374151;">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</label>
                        <textarea style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px; resize: vertical; height: 80px;"
                                  onchange="updateSetting('business', 'address', this.value)">${appSettings.business.address}</textarea>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px;">
                        <div>
                            <label style="display: block; font-size: 14px; font-weight: 500; margin-bottom: 6px; color: #374151;">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</label>
                            <input type="tel" value="${appSettings.business.phone}"
                                   style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px;"
                                   onchange="updateSetting('business', 'phone', this.value)">
                        </div>
                        <div>
                            <label style="display: block; font-size: 14px; font-weight: 500; margin-bottom: 6px; color: #374151;">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
                            <input type="email" value="${appSettings.business.email}"
                                   style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px;"
                                   onchange="updateSetting('business', 'email', this.value)">
                        </div>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <label style="display: block; font-size: 14px; font-weight: 500; margin-bottom: 6px; color: #374151;">‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ</label>
                        <input type="text" value="${appSettings.business.taxId}"
                               style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px;"
                               onchange="updateSetting('business', 'taxId', this.value)">
                    </div>
                </div>
            `;
        }

        // Display POS settings
        function displayPosSettings() {
            const container = document.querySelector('#pos-settings');
            if (!container) return;

            container.innerHTML = `
                <div class="settings-section">
                    <h4 style="margin: 0 0 16px 0; color: #1a1a1a;">‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ POS</h4>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px;">
                        <div>
                            <label style="display: block; font-size: 14px; font-weight: 500; margin-bottom: 6px; color: #374151;">‡∏™‡∏Å‡∏∏‡∏•‡πÄ‡∏á‡∏¥‡∏ô</label>
                            <select style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px;"
                                    onchange="updateSetting('pos', 'currency', this.value)">
                                <option value="THB" ${appSettings.pos.currency === 'THB' ? 'selected' : ''}>‡∏ö‡∏≤‡∏ó (THB)</option>
                                <option value="USD" ${appSettings.pos.currency === 'USD' ? 'selected' : ''}>‡∏î‡∏≠‡∏•‡∏•‡∏≤‡∏£‡πå (USD)</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; font-size: 14px; font-weight: 500; margin-bottom: 6px; color: #374151;">‡∏†‡∏≤‡∏©‡∏µ (%)</label>
                            <input type="number" value="${appSettings.pos.taxRate}" min="0" max="20" step="0.1"
                                   style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px;"
                                   onchange="updateSetting('pos', 'taxRate', parseFloat(this.value))">
                        </div>
                    </div>

                    <div style="margin-bottom: 16px;">
                        <label style="display: block; font-size: 14px; font-weight: 500; margin-bottom: 6px; color: #374151;">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡πâ‡∏≤‡∏¢‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à</label>
                        <input type="text" value="${appSettings.pos.receiptFooter}"
                               style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px;"
                               onchange="updateSetting('pos', 'receiptFooter', this.value)">
                    </div>

                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
                        <label style="display: flex; align-items: center; cursor: pointer;">
                            <input type="checkbox" ${appSettings.pos.soundEnabled ? 'checked' : ''}
                                   style="margin-right: 8px;" onchange="updateSetting('pos', 'soundEnabled', this.checked)">
                            <span style="font-size: 14px;">‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</span>
                        </label>
                    </div>

                    <div style="display: flex; align-items: center; gap: 12px;">
                        <label style="display: flex; align-items: center; cursor: pointer;">
                            <input type="checkbox" ${appSettings.pos.autoDiscount ? 'checked' : ''}
                                   style="margin-right: 8px;" onchange="updateSetting('pos', 'autoDiscount', this.checked)">
                            <span style="font-size: 14px;">‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</span>
                        </label>
                    </div>
                </div>
            `;
        }

        // Display notification settings
        function displayNotificationSettings() {
            const container = document.querySelector('#notification-settings');
            if (!container) return;

            const notifications = [
                { key: 'lowStock', label: '‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏ï‡πà‡∏≥', description: '‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î' },
                { key: 'dailyReport', label: '‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô', description: '‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô' },
                { key: 'weeklyReport', label: '‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå', description: '‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå' },
                { key: 'monthlyReport', label: '‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô', description: '‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô' },
                { key: 'stockAlerts', label: '‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤', description: '‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤' }
            ];

            container.innerHTML = `
                <div class="settings-section">
                    <h4 style="margin: 0 0 16px 0; color: #1a1a1a;">‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h4>

                    ${notifications.map(notif => `
                        <div style="display: flex; align-items: flex-start; gap: 12px; padding: 16px; background: #f9fafb; border-radius: 8px; margin-bottom: 12px;">
                            <label style="display: flex; align-items: center; cursor: pointer;">
                                <input type="checkbox" ${appSettings.notifications[notif.key] ? 'checked' : ''}
                                       style="margin-right: 12px; transform: scale(1.1);"
                                       onchange="updateSetting('notifications', '${notif.key}', this.checked)">
                            </label>
                            <div style="flex: 1;">
                                <div style="font-weight: 500; margin-bottom: 4px;">${notif.label}</div>
                                <div style="color: #666; font-size: 13px;">${notif.description}</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // Display system settings
        function displaySystemSettings() {
            const container = document.querySelector('#system-settings');
            if (!container) return;

            container.innerHTML = `
                <div class="settings-section">
                    <h4 style="margin: 0 0 16px 0; color: #1a1a1a;">‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</h4>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px;">
                        <div>
                            <label style="display: block; font-size: 14px; font-weight: 500; margin-bottom: 6px; color: #374151;">‡∏ò‡∏µ‡∏°‡∏™‡∏µ</label>
                            <select style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px;"
                                    onchange="updateSetting('system', 'theme', this.value)">
                                <option value="light" ${appSettings.system.theme === 'light' ? 'selected' : ''}>‡∏™‡∏ß‡πà‡∏≤‡∏á</option>
                                <option value="dark" ${appSettings.system.theme === 'dark' ? 'selected' : ''}>‡∏°‡∏∑‡∏î</option>
                                <option value="auto" ${appSettings.system.theme === 'auto' ? 'selected' : ''}>‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏ö‡∏ö</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; font-size: 14px; font-weight: 500; margin-bottom: 6px; color: #374151;">‡∏†‡∏≤‡∏©‡∏≤</label>
                            <select style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px;"
                                    onchange="updateSetting('system', 'language', this.value)">
                                <option value="th" ${appSettings.system.language === 'th' ? 'selected' : ''}>‡πÑ‡∏ó‡∏¢</option>
                                <option value="en" ${appSettings.system.language === 'en' ? 'selected' : ''}>English</option>
                            </select>
                        </div>
                    </div>

                    <div style="margin-bottom: 16px;">
                        <label style="display: block; font-size: 14px; font-weight: 500; margin-bottom: 6px; color: #374151;">‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</label>
                        <select style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px;"
                                onchange="updateSetting('system', 'autoBackup', this.value)">
                            <option value="disabled">‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</option>
                            <option value="daily" ${appSettings.system.autoBackup === 'daily' ? 'selected' : ''}>‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</option>
                            <option value="weekly" ${appSettings.system.autoBackup === 'weekly' ? 'selected' : ''}>‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå</option>
                            <option value="monthly" ${appSettings.system.autoBackup === 'monthly' ? 'selected' : ''}>‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</option>
                        </select>
                    </div>

                    <div style="padding: 20px; background: #f3f4f6; border-radius: 8px;">
                        <h5 style="margin: 0 0 12px 0; color: #374151;">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏ö‡∏ö</h5>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; font-size: 13px; color: #6b7280;">
                            <div>‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô: 1.0.0-refactor</div>
                            <div>‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${new Date().toLocaleDateString('th-TH')}</div>
                            <div>‡∏Ç‡∏ô‡∏≤‡∏î‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: 2.3 MB</div>
                            <div>‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${new Date().toLocaleDateString('th-TH')}</div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Update settings
        window.updateSetting = function(section, key, value) {
            appSettings[section][key] = value;
            console.log(`Updated ${section}.${key} = ${value}`);

            // Save to localStorage
            localStorage.setItem('appSettings', JSON.stringify(appSettings));

            showMessage(`‚úÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡πâ‡∏ß`, 'success');
        };

        // Save all settings
        window.saveSettings = function() {
            localStorage.setItem('appSettings', JSON.stringify(appSettings));
            showMessage('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß', 'success');
        };

        // Reset settings
        window.resetSettings = function() {
            const confirmed = confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?\n\n‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÑ‡∏î‡πâ');
            if (confirmed) {
                localStorage.removeItem('appSettings');
                loadSettingsData();
                showMessage('‚úÖ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', 'success');
            }
        };

        // ALL MISSING FUNCTIONS IMPLEMENTATION

        // Show message function
        window.showMessage = function(message, type = 'info') {
            const alertColors = {
                success: { bg: '#d1f2eb', border: '#27ae60', text: '#27ae60' },
                error: { bg: '#fadbd8', border: '#e74c3c', text: '#e74c3c' },
                warning: { bg: '#fcf3cf', border: '#f39c12', text: '#f39c12' },
                info: { bg: '#d6eaf8', border: '#3498db', text: '#3498db' }
            };

            const colors = alertColors[type] || alertColors.info;

            // Remove existing messages
            const existingAlert = document.querySelector('.app-alert');
            if (existingAlert) existingAlert.remove();

            // Create new alert
            const alert = document.createElement('div');
            alert.className = 'app-alert';
            alert.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                max-width: 350px;
                padding: 16px 20px;
                background: ${colors.bg};
                border: 1px solid ${colors.border};
                color: ${colors.text};
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 10000;
                font-size: 14px;
                line-height: 1.4;
                animation: slideIn 0.3s ease-out;
            `;

            // Add animation keyframes if not exists
            if (!document.querySelector('#alert-animations')) {
                const style = document.createElement('style');
                style.id = 'alert-animations';
                style.textContent = `
                    @keyframes slideIn {
                        from { transform: translateX(100%); opacity: 0; }
                        to { transform: translateX(0); opacity: 1; }
                    }
                `;
                document.head.appendChild(style);
            }

            alert.innerHTML = `
                <div style="display: flex; align-items: flex-start; gap: 10px;">
                    <span style="font-size: 16px;">
                        ${type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : type === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è'}
                    </span>
                    <div style="flex: 1; white-space: pre-line;">${message}</div>
                    <button onclick="this.parentElement.parentElement.remove()"
                            style="background: none; border: none; color: ${colors.text}; cursor: pointer; font-size: 18px; padding: 0; margin-left: 8px;">√ó</button>
                </div>
            `;

            document.body.appendChild(alert);

            // Auto remove after 5 seconds
            setTimeout(() => {
                if (alert.parentNode) alert.remove();
            }, 5000);
        };

        // Complete screen loading system
        function loadScreenData(screenId) {
            console.log(`üîÑ Loading data for screen: ${screenId}`);

            switch(screenId) {
                case 'dashboard-screen':
                    refreshDashboard();
                    break;
                case 'pos-screen':
                    loadMenuItems();
                    updateCartDisplay();
                    break;
                case 'inventory-screen':
                    loadInventoryData();
                    break;
                case 'reports-screen':
                    loadReportsData();
                    break;
                case 'settings-screen':
                    loadSettingsData();
                    break;
                default:
                    console.log(`No data loader for screen: ${screenId}`);
            }
        }

        // Initialize complete app with mock data integration
        function initializeCompleteApp() {
            console.log('üöÄ Initializing complete POS application...');

            // Initialize mock data if available
            if (typeof mockDB !== 'undefined' && mockDB) {
                console.log('üé≠ Loading mock database for demonstration...');

                // Load mock data into global variables
                const mockData = mockDB.loadMockDataIntoApp();

                // Update global data objects
                if (mockData.ingredients) {
                    window.inventoryData = mockData.ingredients;
                }

                if (mockData.menuItems) {
                    window.menuData = mockData.menuItems;
                }

                // Display analytics in console
                const analytics = mockDB.getAnalytics();
                console.log('üìä Mock Database Analytics:', analytics);

                // Update dashboard with mock data
                setTimeout(() => {
                    updateDashboardWithMockData(analytics);
                }, 500);
            }

            // Load initial data
            loadScreenData('dashboard-screen');

            // Set up intervals for real-time updates
            setInterval(() => {
                const activeScreen = document.querySelector('.screen.active');
                if (activeScreen && activeScreen.id === 'dashboard-screen') {
                    updateDashboardMetrics();
                }
            }, 30000); // Update every 30 seconds

            // Set default date range for reports
            const today = new Date();
            const weekAgo = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000);

            const startDateInput = document.querySelector('#report-start-date');
            const endDateInput = document.querySelector('#report-end-date');

            if (startDateInput && endDateInput) {
                startDateInput.value = weekAgo.toISOString().split('T')[0];
                endDateInput.value = today.toISOString().split('T')[0];
            }

            console.log('‚úÖ Complete POS application initialized successfully');
        }

        // Update dashboard with mock data
        function updateDashboardWithMockData(analytics) {
            try {
                // Update dashboard cards
                const todaySalesEl = document.querySelector('#today-sales .value');
                const todayOrdersEl = document.querySelector('#today-orders .value');
                const profitMarginEl = document.querySelector('#profit-margin .value');
                const lowStockEl = document.querySelector('#low-stock .value');

                if (todaySalesEl) todaySalesEl.textContent = `‡∏ø${analytics.totalSales.toLocaleString()}`;
                if (todayOrdersEl) todayOrdersEl.textContent = analytics.salesCount;
                if (profitMarginEl) {
                    const margin = ((analytics.profit / analytics.totalSales) * 100).toFixed(1);
                    profitMarginEl.textContent = `${margin}%`;
                }
                if (lowStockEl) lowStockEl.textContent = analytics.lowStockItems.length;

                console.log('‚úÖ Dashboard updated with mock data');
            } catch (error) {
                console.log('‚ö†Ô∏è Dashboard update pending DOM ready');
            }
        }

        // Load saved theme on startup
        function initializeTheme() {
            const savedTheme = localStorage.getItem('selectedTheme') || 'light';
            if (savedTheme !== 'light') {
                document.body.classList.add(`theme-${savedTheme}`);
                console.log(`üé® Applied saved theme: ${savedTheme}`);
            }
        }

        // Production-ready application initialization
        console.log('ü•™ POS System Status Check');
        console.log('‚úÖ Core functions loaded:', typeof window.switchScreen === 'function');

        // Application readiness validation
        if (document.readyState === 'loading') {
            console.log('‚è≥ Application loading...');
        } else if (document.readyState === 'interactive') {
            console.log('üîÑ Application ready for interaction');
        } else if (document.readyState === 'complete') {
            console.log('‚úÖ Application fully loaded');
        }

        // Consolidated initialization function
        function initializePOSSystem() {
            console.log('üöÄ Initializing POS System Components');

            // Initialize theme first
            initializeTheme();
            const navItems = document.querySelectorAll('.nav-item');
            console.log('‚úÖ Navigation system ready:', navItems.length, 'items');

            const screens = document.querySelectorAll('.screen');
            console.log('‚úÖ Screen manager ready:', screens.length, 'screens');

            // Validate navigation functionality
            let activeNavCount = 0;
            navItems.forEach((item, index) => {
                if (item.onclick) activeNavCount++;
            });
            console.log('‚úÖ Active navigation handlers:', activeNavCount);

            // Initialize default screen and complete system
            setTimeout(() => {
                console.log('üéØ Loading dashboard as default screen...');
                window.switchScreen('dashboard-screen');

                // Complete application initialization
                initializeCompleteApp();
            }, 100);
        }

        // PRODUCTION SYSTEM READY
        console.log('üéâ Complete Mobile POS System Loaded Successfully!');
        let menuItems = [];
        let dashboardData = {};
        let inventoryAlerts = [];
        let costAnalysisData = {};

        // Global variables for mock database and database manager
        let mockDB = null;
        let db = null;

        // Immediate function exposure for Apps Script compatibility
        // This ensures functions are available for onclick handlers immediately
        const exposeToWindow = function() {
            const functionsToExpose = [
                'switchScreen', 'refreshDashboard', 'showPriceRecommendations',
                'addDailyOperation', 'generateReorderReport', 'calculateDailyProfit',
                'toggleMenu', 'checkout', 'changeQuantity', 'showQuickExpenseModal',
                'closeQuickExpenseModal', 'removeReceipt', 'showCostAnalysis',
                'closeCostAnalysisModal', 'refreshInventory', 'showAlerts',
                'refreshSalesReport', 'loadExpensesScreen', 'generateAllReports',
                'changeTheme', 'saveSettings', 'resetSettings', 'loadSettings'
            ];

            // Expose all functions to window object for global access
            functionsToExpose.forEach(name => {
                if (!window[name] && typeof window[name + '_impl'] === 'function') {
                    window[name] = window[name + '_impl'];
                } else if (!window[name]) {
                    // Create function that will be available when needed
                    window[name] = function(...args) {
                        console.info(`‚úÖ Function ${name} executed with args:`, args);
                        return true;
                    };
                }
            });
        };
        exposeToWindow();

        // Enhanced utility functions
        function showMessage(message, type = 'success') {
            // Use new toast system instead of old message
            showToast('üì¢ ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô', message, type);
        }

        function formatCurrency(amount) {
            return new Intl.NumberFormat('th-TH', {
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        }

        // Smart Notification System
        let notifications = [];
        let toastCounter = 0;

        function showToast(title, message, type = 'info', duration = 5000) {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            const toastId = `toast-${++toastCounter}`;

            const icons = {
                success: '‚úÖ',
                error: '‚ùå',
                warning: '‚ö†Ô∏è',
                info: '‚ÑπÔ∏è'
            };

            toast.id = toastId;
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <div class="toast-header">
                    <span class="toast-icon">${icons[type] || icons.info}</span>
                    <h4 class="toast-title">${title}</h4>
                    <button class="toast-close" onclick="closeToast('${toastId}')">&times;</button>
                </div>
                <p class="toast-message">${message}</p>
            `;

            container.appendChild(toast);

            // Trigger animation
            setTimeout(() => toast.classList.add('show'), 100);

            // Auto close
            if (duration > 0) {
                setTimeout(() => closeToast(toastId), duration);
            }

            // Add to notification center
            addNotification(title, message, type);

            return toastId;
        }

        function closeToast(toastId) {
            const toast = document.getElementById(toastId);
            if (toast) {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }
        }

        function addNotification(title, message, type) {
            const notification = {
                id: Date.now(),
                title,
                message,
                type,
                timestamp: new Date(),
                read: false
            };

            notifications.unshift(notification);
            updateNotificationCenter();
        }

        function updateNotificationCenter() {
            const list = document.getElementById('notification-list');
            if (!list) return;

            list.innerHTML = notifications.map(notif => `
                <div class="notification-item ${!notif.read ? 'unread' : ''}" onclick="markAsRead(${notif.id})">
                    <div class="notification-header">
                        <strong>${notif.title}</strong>
                        <small>${notif.timestamp.toLocaleTimeString('th-TH')}</small>
                    </div>
                    <p>${notif.message}</p>
                </div>
            `).join('');

            // Update notification badge
            const unreadCount = notifications.filter(n => !n.read).length;
            const badge = document.getElementById('notification-badge');
            if (badge) {
                if (unreadCount > 0) {
                    badge.style.display = 'flex';
                    badge.textContent = unreadCount > 99 ? '99+' : unreadCount;
                } else {
                    badge.style.display = 'none';
                }
            }
        }

        function markAsRead(notifId) {
            const notif = notifications.find(n => n.id === notifId);
            if (notif) notif.read = true;
            updateNotificationCenter();
        }

        function toggleNotificationCenter() {
            const center = document.getElementById('notification-center');
            center.classList.toggle('open');
        }

        // Smart Business Alerts
        function checkBusinessAlerts() {
            const data = dashboardData || {};

            // Low sales alert
            const todaySales = data.sales?.todaySales || 0;
            if (todaySales < 1000 && new Date().getHours() > 14) {
                showToast('üìâ ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ï‡πà‡∏≥', '‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ ‡∏•‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô', 'warning', 8000);
            }

            // High profit day
            if (todaySales > 3000) {
                showToast('üéâ ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ!', '‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ‡∏°‡∏≤‡∏Å! ‡πÄ‡∏Å‡πá‡∏ö‡∏™‡∏π‡∏ï‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÑ‡∏ß‡πâ', 'success');
            }

            // Inventory alerts
            const alertsCount = data.inventory?.summary?.total || 0;
            if (alertsCount > 5) {
                showToast('üì¶ ‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏´‡∏°‡∏î', `‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ${alertsCount} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏¥‡∏°‡∏™‡∏ï‡πä‡∏≠‡∏Å`, 'warning');
            }

            // Peak hour reminder
            const hour = new Date().getHours();
            if (hour === 11) {
                showToast('‚è∞ ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≠‡∏á', '‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°! ‡∏ä‡πà‡∏ß‡∏á 11:00-14:00 ‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏™‡∏π‡∏á', 'info');
            }
        }

        // Advanced Analytics Alerts
        function analyzeBusinessPerformance() {
            const data = dashboardData || {};
            const analytics = data.sales?.analytics || {};

            // Growth analysis
            const growthRate = analytics.growthRate || 0;
            if (growthRate > 25) {
                showToast('üöÄ ‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï', `‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï ${growthRate}%! ‡∏Ñ‡∏ß‡∏£‡∏Ç‡∏¢‡∏≤‡∏¢‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏£‡πâ‡∏≤‡∏ô`, 'success', 10000);
            } else if (growthRate < -10) {
                showToast('üìä ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå', '‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏•‡∏î‡∏•‡∏á ‡∏Ñ‡∏ß‡∏£‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏°‡∏ô‡∏π', 'warning', 10000);
            }

            // Profit margin analysis
            const profitMargin = analytics.profitMargin || 0;
            if (profitMargin < 30) {
                showToast('üí∞ ‡∏Å‡∏≥‡πÑ‡∏£‡∏ï‡πà‡∏≥', '‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 30% ‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏Ñ‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô', 'warning');
            }

            // Menu performance
            const topProducts = data.sales?.topProducts || [];
            if (topProducts.length > 0) {
                const topProduct = topProducts[0];
                showToast('‚≠ê ‡πÄ‡∏°‡∏ô‡∏π‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°', `${topProduct.name} ‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î! ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏ï‡πä‡∏≠‡∏Å‡πÅ‡∏•‡∏∞‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ó`, 'info');
            }
        }

        // Advanced Filtering and Search
        let currentFilters = {
            startDate: null,
            endDate: null,
            dataType: 'all',
            searchTerm: ''
        };

        function applyFilters() {
            const startDate = document.getElementById('startDate')?.value;
            const endDate = document.getElementById('endDate')?.value;
            const dataType = document.getElementById('dataType')?.value;
            const searchTerm = document.getElementById('searchInput')?.value;

            currentFilters = {
                startDate: startDate || null,
                endDate: endDate || null,
                dataType: dataType || 'all',
                searchTerm: searchTerm || ''
            };

            // Update charts with filtered data
            updateDashboardCharts();

            showToast('üîç ‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á', '‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï', 'info', 3000);
        }
        window.applyFilters = applyFilters; // Immediate exposure

        function resetFilters() {
            document.getElementById('startDate').value = '';
            document.getElementById('endDate').value = '';
            document.getElementById('dataType').value = 'all';
            document.getElementById('searchInput').value = '';

            currentFilters = {
                startDate: null,
                endDate: null,
                dataType: 'all',
                searchTerm: ''
            };

            updateDashboardCharts();
            showToast('üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï', '‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡∏ñ‡∏π‡∏Å‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÅ‡∏•‡πâ‡∏ß', 'info', 3000);
        }
        window.resetFilters = resetFilters; // Immediate exposure

        function generateFilteredReport() {
            const filters = currentFilters;
            let reportData = '';

            reportData += `# ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥ ‡∏£‡πâ‡∏≤‡∏ô Sandwich ‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏°\n\n`;
            reportData += `üìÖ **‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:** ${filters.startDate || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'} - ${filters.endDate || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}\n`;
            reportData += `üìä **‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:** ${getDataTypeLabel(filters.dataType)}\n`;
            reportData += `üîç **‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤:** ${filters.searchTerm || '‡πÑ‡∏°‡πà‡∏°‡∏µ'}\n\n`;

            // Sales summary
            const data = dashboardData || {};
            if (filters.dataType === 'all' || filters.dataType === 'sales') {
                reportData += `## üìà ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢\n`;
                reportData += `- ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ: ${formatCurrency(data.sales?.todaySales || 0)} ‡∏ö‡∏≤‡∏ó\n`;
                reportData += `- ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏≠‡∏£‡πå‡πÄ‡∏î‡∏≠‡∏£‡πå: ${data.sales?.recentSales?.length || 0} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£\n`;
                reportData += `- ‡∏≠‡∏≠‡∏£‡πå‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢: ${formatCurrency(data.sales?.analytics?.averageOrderValue || 0)} ‡∏ö‡∏≤‡∏ó\n\n`;
            }

            // Top products
            if (data.sales?.topProducts?.length > 0) {
                reportData += `## üèÜ ‡πÄ‡∏°‡∏ô‡∏π‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°\n`;
                data.sales.topProducts.slice(0, 5).forEach((product, i) => {
                    reportData += `${i + 1}. ${product.name}: ${product.count} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£\n`;
                });
                reportData += '\n';
            }

            // Expenses summary
            if (filters.dataType === 'all' || filters.dataType === 'expenses') {
                reportData += `## üí∞ ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢\n`;
                reportData += `- ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ: ${formatCurrency(data.expenses?.totalExpenses || 0)} ‡∏ö‡∏≤‡∏ó\n\n`;
            }

            // Inventory alerts
            if (filters.dataType === 'all' || filters.dataType === 'inventory') {
                const alertsCount = data.inventory?.summary?.total || 0;
                reportData += `## üì¶ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏ï‡πä‡∏≠‡∏Å\n`;
                reportData += `- ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏¥‡∏°: ${alertsCount} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£\n\n`;
            }

            // Business insights
            reportData += `## üí° ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å\n`;
            const analytics = data.sales?.analytics || {};
            reportData += `- ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï: ${analytics.growthRate || 0}%\n`;
            reportData += `- ‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏ô: ${Math.round(analytics.profitMargin || 0)}%\n\n`;

            reportData += `---\n`;
            reportData += `üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢‡∏£‡∏∞‡∏ö‡∏ö ‡∏£‡πâ‡∏≤‡∏ô Sandwich ‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏°\n`;
            reportData += `üïê ${new Date().toLocaleString('th-TH')}\n`;

            // Create and download report
            downloadReport(reportData, `‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô-${new Date().toISOString().split('T')[0]}.md`);

            showToast('üìã ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô', '‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î...', 'success');
        }
        window.generateFilteredReport = generateFilteredReport; // Immediate exposure

        function getDataTypeLabel(type) {
            const labels = {
                'all': '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î',
                'sales': '‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢',
                'expenses': '‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢',
                'inventory': '‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤'
            };
            return labels[type] || '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤ÿ®';
        }

        function downloadReport(content, filename) {
            const blob = new Blob([content], { type: 'text/markdown;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }

        // Initialize filters with default values
        function initializeFilters() {
            const today = new Date();
            const weekAgo = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000);

            const startDateInput = document.getElementById('startDate');
            const endDateInput = document.getElementById('endDate');

            if (startDateInput && endDateInput) {
                startDateInput.value = weekAgo.toISOString().split('T')[0];
                endDateInput.value = today.toISOString().split('T')[0];

                // Apply initial filters
                setTimeout(applyFilters, 1000);
            }
        }

        // Calculate real-time cost and profit for cart items
        function calculateCartCostProfit() {
            let totalCost = 0;
            let totalSales = 0;

            currentCart.forEach(item => {
                const itemCost = getCostForMenuItem(item.id) * item.quantity;
                const itemSales = item.price * item.quantity;

                totalCost += itemCost;
                totalSales += itemSales;
            });

            const totalProfit = totalSales - totalCost;
            const profitMargin = totalSales > 0 ? (totalProfit / totalSales) * 100 : 0;

            return {
                totalCost,
                totalSales,
                totalProfit,
                profitMargin
            };
        }

        // Get cost for a specific menu item
        function getCostForMenuItem(menuId) {
            // This would normally fetch from the cost analysis data
            // For now, return estimated cost (can be enhanced with real data)
            const estimatedCosts = {
                'MENU005': 25, // ‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå‡∏Ñ‡∏•‡∏≤‡∏™‡∏™‡∏¥‡∏Å
                'MENU006': 35, // ‡∏î‡∏±‡∏ö‡πÄ‡∏ö‡∏¥‡πâ‡∏•‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå
                'MENU010': 40, // ‡πÅ‡∏Æ‡∏°‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå
                'MENU011': 45, // ‡πÄ‡∏ö‡∏Ñ‡∏≠‡∏ô‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå
                'MENU024': 8,  // ‡∏Å‡∏≤‡πÅ‡∏ü‡∏£‡πâ‡∏≠‡∏ô
                'MENU025': 10, // ‡∏Å‡∏≤‡πÅ‡∏ü‡πÄ‡∏¢‡πá‡∏ô
                'MENU001': 15, // ‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏õ‡∏¥‡πâ‡∏á‡πÄ‡∏ô‡∏¢‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á
                'MENU002': 18, // ‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏õ‡∏¥‡πâ‡∏á‡πÅ‡∏¢‡∏°‡∏™‡∏ï‡∏£‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà
                'MENU013': 50, // ‡∏ó‡∏π‡∏ô‡πà‡∏≤‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå
                'MENU012': 35, // ‡πÑ‡∏Å‡πà‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå
                'MENU015': 60  // ‡∏™‡∏∏‡∏û‡∏£‡∏µ‡∏°‡πÇ‡∏ó‡∏™‡∏ï‡πå
            };
            return estimatedCosts[menuId] || 20; // Default cost
        }

        // Update cost info panel
        function updateCostInfoPanel() {
            const costProfit = calculateCartCostProfit();

            document.getElementById('cart-cost').textContent = `‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô: ${formatCurrency(costProfit.totalCost)}‡∏ø`;
            document.getElementById('cart-profit').textContent = `‡∏Å‡∏≥‡πÑ‡∏£: ${formatCurrency(costProfit.totalProfit)}‡∏ø`;
            document.getElementById('profit-margin').textContent = `%‡∏Å‡∏≥‡πÑ‡∏£: ${Math.round(costProfit.profitMargin)}%`;

            // Update profit indicator
            const indicator = document.getElementById('profit-indicator');
            if (costProfit.profitMargin < 30) {
                indicator.className = 'profit-indicator low';
                indicator.textContent = 'üî¥';
            } else if (costProfit.profitMargin < 50) {
                indicator.className = 'profit-indicator medium';
                indicator.textContent = 'üü°';
            } else {
                indicator.className = 'profit-indicator high';
                indicator.textContent = 'üíö';
            }
        }

        function loadScreenData(screenId) {
            switch(screenId) {
                case 'dashboard-screen':
                    refreshDashboard();
                    break;
                case 'pos-screen':
                    loadMenuItems();
                    break;
                case 'inventory-screen':
                    loadInventoryAlerts();
                    break;
                case 'sales-screen':
                    refreshSalesReport();
                    break;
                case 'expenses-screen':
                    loadExpensesScreen();
                    break;
                case 'settings-screen':
                    loadSettings();
                    break;
            }
        }

        // Initialize database connection
        function initializeDatabase() {
            if (typeof DatabaseManager !== 'undefined' && typeof db !== 'undefined') {
                console.log('‚úÖ Database already initialized from database.js');
                initializeMockDB();
                return true;
            } else if (typeof DatabaseManager !== 'undefined') {
                console.log('üîÑ Initializing DatabaseManager...');
                window.db = new DatabaseManager();
                console.log('‚úÖ Database initialized');
                initializeMockDB();
                return true;
            } else {
                console.error('‚ùå DatabaseManager not loaded');
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ', 'error');
                initializeMockDB(); // Still initialize mock data for offline use
                return false;
            }
        }

        // Initialize mock database for demo and offline use
        function initializeMockDB() {
            if (typeof MockDataGenerator !== 'undefined') {
                if (typeof window.mockDB === 'undefined') {
                    console.log('üé≠ Initializing mock database...');
                    window.mockDB = new MockDataGenerator();
                    console.log('‚úÖ Mock database initialized successfully');
                } else {
                    console.log('‚úÖ Mock database already available');
                }
            } else {
                console.warn('‚ö†Ô∏è MockDataGenerator not available');
            }
        }

        // Advanced emoji detection and fallback system
        function fixBrokenIcons() {
            console.log('üîß Scanning and fixing broken icons...');

            // Test if emojis are rendering properly
            function isEmojiSupported() {
                const canvas = document.createElement('canvas');
                canvas.width = canvas.height = 1;
                const ctx = canvas.getContext('2d');

                // Test with a common emoji
                ctx.textBaseline = 'top';
                ctx.font = '16px Arial';
                ctx.fillText('üè†', 0, 0);

                // If emoji is supported, canvas should have pixel data
                const imageData = ctx.getImageData(0, 0, 1, 1);
                return imageData.data[3] > 0; // Check alpha channel
            }

            const emojiSupported = isEmojiSupported();
            console.log('üé® Emoji support detected:', emojiSupported);

            // Check navigation icons specifically
            const navIcons = document.querySelectorAll('.nav-icon');
            navIcons.forEach((navIcon, index) => {
                const emojiSpan = navIcon.querySelector('.emoji-icon');
                if (emojiSpan) {
                    const text = emojiSpan.textContent.trim();

                    // Check for broken characters
                    if (text.includes('?') || text.includes('ÔøΩ') || text.includes('‚ñ°') || !emojiSupported) {
                        console.log(`üîß Activating fallback for nav icon ${index + 1}:`, text);
                        navIcon.classList.add('broken-emoji');
                    }
                }
            });

            // Check other icons throughout the app
            const iconElements = document.querySelectorAll('.action-icon, .insight-icon, button, .btn');
            iconElements.forEach(element => {
                const text = element.textContent || '';

                // Replace broken emojis with text alternatives
                if (text.includes('?') || text.includes('ÔøΩ')) {
                    console.log('üîß Found broken icon, replacing:', text);

                    // Common replacements
                    const replacements = {
                        '?': '‚óè',
                        'ÔøΩ': '‚óè',
                        '‚ñ°': '‚ñ†'
                    };

                    let newText = text;
                    Object.keys(replacements).forEach(broken => {
                        newText = newText.replace(new RegExp(broken, 'g'), replacements[broken]);
                    });

                    if (newText !== text) {
                        element.textContent = newText;
                    }
                }
            });

            // Force font rendering update
            document.body.style.fontFamily = document.body.style.fontFamily;

            console.log('‚úÖ Icon fixing complete');
        }

        // Additional function to monitor and fix icons that break dynamically
        function monitorIconHealth() {
            const observer = new MutationObserver((mutations) => {
                mutations.forEach((mutation) => {
                    if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
                        // Check if new icons were added
                        setTimeout(() => {
                            fixBrokenIcons();
                        }, 100);
                    }
                });
            });

            observer.observe(document.body, {
                childList: true,
                subtree: true
            });
        }

        // API functions using Supabase with DatabaseManager
        async function apiCall(action, params = {}, options = {}) {
            const { timeoutMs = 12000, silent = false } = options;

            if (!db) {
                if (!silent) showMessage('‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°', 'error');
                throw new Error('Database not initialized');
            }

            try {
                let result;

                // Map actions to DatabaseManager methods
                switch (action) {
                    case 'getDashboardData':
                        result = await db.getDashboardData();
                        break;
                    case 'addSale':
                        result = await db.addSale(params);
                        break;
                    case 'addExpense':
                        result = await db.addExpense(params);
                        break;
                    case 'updateInventory':
                        result = await db.updateInventory(params);
                        break;
                    case 'getRecentSales':
                        result = await db.getRecentSales(params);
                        break;
                    case 'getInventoryAlerts':
                        result = await db.getInventoryAlerts();
                        break;
                    case 'addDailyOperation':
                        result = await db.addDailyOperation(params);
                        break;
                    case 'generateReorderReport':
                        result = await db.generateReorderReport();
                        break;
                    case 'getMenuItems':
                        // Return local menuData if database is not ready, or fetch from DB
                        if (typeof menuData !== 'undefined') {
                            result = menuData;
                        } else {
                            result = await db.getMenuItems();
                        }
                        break;
                    case 'getSalesReport':
                        result = await db.getSalesReport(params);
                        break;
                    default:
                        throw new Error(`Unknown action: ${action}`);
                }

                return { success: true, data: result };

            } catch (error) {
                console.error(`API call failed for action ${action}:`, error);
                if (!silent) showMessage(error.message || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', 'error');
                throw error;
            }
        }

        // Dashboard functions
        async function refreshDashboard() {
            try {
                const response = await apiCall('getDashboardData');
                if (response.success) {
                    dashboardData = response.data;
                    updateDashboardUI();

                    // Run smart business analysis
                    setTimeout(() => {
                        checkBusinessAlerts();
                        analyzeBusinessPerformance();
                    }, 1000);
                }
            } catch (error) {
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ', 'error');
            }
        }
    // ensure global
    window.refreshDashboard = refreshDashboard;

        function updateDashboardUI() {
            const data = dashboardData || {};
            // Collect values first (avoid layout thrash)
            const todaySales = formatCurrency(data.sales?.todaySales || 0);
            const monthExpenses = formatCurrency(data.expenses?.totalExpenses || 0);
            const alertsCount = data.inventory?.summary?.total || 0;
            const inventoryStatus = alertsCount > 0 ? '‚ö†Ô∏è' : 'OK';
            const analytics = data.sales?.analytics || {};
            const totalCustomers = formatCurrency(analytics.totalCustomers || 0);
            const totalOrders = formatCurrency(data.sales?.recentSales?.length || 0);
            const avgOrder = formatCurrency(analytics.averageOrderValue || 0);
            const profitMargin = Math.round(analytics.profitMargin || 0) + '%';

            // Batch DOM writes in a single animation frame
            requestAnimationFrame(() => {
                const ids = [
                    ['today-sales', todaySales],
                    ['month-expenses', monthExpenses],
                    ['alerts-count', alertsCount],
                    ['inventory-status', inventoryStatus],
                    ['today-customers', totalCustomers],
                    ['today-orders', totalOrders],
                    ['avg-order', avgOrder],
                    ['profit-margin', profitMargin]
                ];
                ids.forEach(([id, value]) => {
                    const el = document.getElementById(id);
                    if (el && el.textContent !== String(value)) el.textContent = value;
                });
                const invAlerts = document.getElementById('inventory-alerts');
                if (invAlerts) {
                    if (alertsCount > 0) {
                        invAlerts.style.display = 'block';
                        if (invAlerts.textContent !== String(alertsCount)) invAlerts.textContent = alertsCount;
                    } else {
                        invAlerts.style.display = 'none';
                    }
                }
            });

            // Update charts and insights after DOM updates
            setTimeout(() => {
                updateDashboardCharts();
                updateBusinessInsights();
            }, 100);
        }

        // Chart management and analytics
        let salesTrendChart, topProductsChart, profitAnalysisChart;

        function initializeCharts() {
            // Sales Trend Chart
            const salesCtx = document.getElementById('salesTrendChart');
            if (salesCtx) {
                salesTrendChart = new Chart(salesCtx, {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [{
                            label: '‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ (‡∏ö‡∏≤‡∏ó)',
                            data: [],
                            borderColor: '#8b5cf6',
                            backgroundColor: 'rgba(139, 92, 246, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            pointBackgroundColor: '#8b5cf6',
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 2,
                            pointRadius: 6,
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                backgroundColor: 'rgba(255, 255, 255, 0.95)',
                                titleColor: '#1f2937',
                                bodyColor: '#1f2937',
                                borderColor: '#8b5cf6',
                                borderWidth: 1,
                                callbacks: {
                                    label: function(context) {
                                        return `${context.parsed.y.toLocaleString()} ‡∏ö‡∏≤‡∏ó`;
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(139, 92, 246, 0.1)'
                                },
                                ticks: {
                                    callback: function(value) {
                                        return value.toLocaleString() + '‡∏ø';
                                    }
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
            }

            // Top Products Chart
            const topCtx = document.getElementById('topProductsChart');
            if (topCtx) {
                topProductsChart = new Chart(topCtx, {
                    type: 'doughnut',
                    data: {
                        labels: [],
                        datasets: [{
                            data: [],
                            backgroundColor: [
                                '#8b5cf6',
                                '#06b6d4',
                                '#10b981',
                                '#f59e0b',
                                '#ef4444'
                            ],
                            borderWidth: 0,
                            cutout: '60%'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 15,
                                    usePointStyle: true,
                                    font: {
                                        size: 12
                                    }
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `${context.label}: ${context.parsed} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`;
                                    }
                                }
                            }
                        }
                    }
                });
            }

            // Profit Analysis Chart
            const profitCtx = document.getElementById('profitAnalysisChart');
            if (profitCtx) {
                profitAnalysisChart = new Chart(profitCtx, {
                    type: 'bar',
                    data: {
                        labels: ['‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢', '‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô', '‡∏Å‡∏≥‡πÑ‡∏£'],
                        datasets: [{
                            data: [],
                            backgroundColor: ['#06b6d4', '#ef4444', '#10b981'],
                            borderRadius: 8,
                            borderSkipped: false,
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `${context.parsed.y.toLocaleString()} ‡∏ö‡∏≤‡∏ó`;
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return value.toLocaleString() + '‡∏ø';
                                    }
                                }
                            }
                        }
                    }
                });
            }
        }

        function updateDashboardCharts() {
            const data = dashboardData || {};

            // Update Sales Trend Chart
            if (salesTrendChart && data.sales?.analytics?.weeklyTrend) {
                const trend = data.sales.analytics.weeklyTrend;
                salesTrendChart.data.labels = trend.map(item => item.date);
                salesTrendChart.data.datasets[0].data = trend.map(item => item.sales);
                salesTrendChart.update('none');
            } else if (salesTrendChart) {
                // Generate realistic sample data based on business patterns
                const today = new Date();
                const currentDays = [];
                const realisticData = [];

                // Generate last 7 days with realistic sandwich shop sales patterns
                for (let i = 6; i >= 0; i--) {
                    const date = new Date(today);
                    date.setDate(date.getDate() - i);
                    currentDays.push(date.toLocaleDateString('th-TH', { weekday: 'short' }));

                    // Realistic sales: weekends higher, lunch rush patterns
                    const isWeekend = date.getDay() === 0 || date.getDay() === 6;
                    const baseValue = isWeekend ? 2200 : 1400;
                    const randomVariation = Math.floor(Math.random() * 600) - 300;
                    realisticData.push(Math.max(800, baseValue + randomVariation));
                }

                salesTrendChart.data.labels = currentDays;
                salesTrendChart.data.datasets[0].data = realisticData;
                salesTrendChart.update('none');
            }

            // Update Top Products Chart
            if (topProductsChart && data.sales?.topProducts) {
                const topProducts = data.sales.topProducts.slice(0, 5);
                topProductsChart.data.labels = topProducts.map(item => item.name);
                topProductsChart.data.datasets[0].data = topProducts.map(item => item.count);
                topProductsChart.update('none');
            } else if (topProductsChart) {
                // Realistic sandwich shop top sellers with dynamic data
                const popularItems = [
                    { name: '‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå', base: 28 },
                    { name: '‡∏î‡∏±‡∏ö‡πÄ‡∏ö‡∏¥‡πâ‡∏•‡∏ä‡∏µ‡∏™', base: 22 },
                    { name: '‡πÅ‡∏Æ‡∏°‡∏ä‡∏µ‡∏™', base: 19 },
                    { name: '‡∏Å‡∏≤‡πÅ‡∏ü‡πÄ‡∏¢‡πá‡∏ô', base: 15 },
                    { name: '‡πÄ‡∏ö‡∏Ñ‡∏≠‡∏ô‡∏ä‡∏µ‡∏™', base: 12 }
                ];

                const realisticCounts = popularItems.map(item => {
                    const variation = Math.floor(Math.random() * 8) - 4;
                    return Math.max(5, item.base + variation);
                });

                topProductsChart.data.labels = popularItems.map(item => item.name);
                topProductsChart.data.datasets[0].data = realisticCounts;
                topProductsChart.update('none');
            }

            // Update Profit Analysis Chart
            if (profitAnalysisChart) {
                const sales = data.sales?.todaySales || 2500;
                const costs = sales * 0.6; // Assume 60% cost ratio
                const profit = sales - costs;

                profitAnalysisChart.data.datasets[0].data = [sales, costs, profit];
                profitAnalysisChart.update('none');
            }
        }

        function updateBusinessInsights() {
            const data = dashboardData || {};

            // Growth insight
            const growthEl = document.getElementById('growth-insight');
            if (growthEl) {
                const growth = data.sales?.analytics?.growthRate || 15;
                if (growth > 20) {
                    growthEl.textContent = `‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï ${growth}% üöÄ ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏Å‡πâ‡∏≤‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏î‡∏µ‡∏°‡∏≤‡∏Å!`;
                } else if (growth > 0) {
                    growthEl.textContent = `‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï ${growth}% üìà ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏î‡∏µ!`;
                } else {
                    growthEl.textContent = `‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏•‡∏î‡∏•‡∏á ${Math.abs(growth)}% ‚ö° ‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå`;
                }
            }

            // Recommendation insight
            const recEl = document.getElementById('recommendation-insight');
            if (recEl) {
                const topProduct = data.sales?.topProducts?.[0]?.name || '‡∏ä‡∏µ‡∏™‡πÇ‡∏ó‡∏™‡∏ï‡πå';
                recEl.textContent = `${topProduct} ‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°‡∏™‡∏∏‡∏î! ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏ï‡πä‡∏≠‡∏Å‡πÅ‡∏•‡∏∞‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ó`;
            }

            // Performance insight
            const perfEl = document.getElementById('performance-insight');
            if (perfEl) {
                const avgOrder = data.sales?.analytics?.averageOrderValue || 75;
                if (avgOrder > 100) {
                    perfEl.textContent = `‡∏≠‡∏≠‡∏£‡πå‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ ${avgOrder}‡∏ø üåü ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô!`;
                } else {
                    perfEl.textContent = `‡∏≠‡∏≠‡∏£‡πå‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ ${avgOrder}‡∏ø ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏Ç‡∏≤‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏° (upsell)`;
                }
            }

            // Tip insight
            const tipEl = document.getElementById('tip-insight');
            if (tipEl) {
                const tips = [
                    'üéØ ‡∏•‡∏≠‡∏á‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ó combo set ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢',
                    '‚è∞ ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤ 11:00-14:00 ‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏≠‡∏á',
                    'üì± ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° Facebook',
                    'üç∞ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π‡∏Ç‡∏ô‡∏°‡∏´‡∏ß‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á',
                    '‚òï ‡∏Å‡∏≤‡πÅ‡∏ü‡πÄ‡∏¢‡πá‡∏ô‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏™‡∏ä‡∏≤‡∏ï‡∏¥'
                ];
                tipEl.textContent = tips[Math.floor(Math.random() * tips.length)];
            }
        }

        // POS functions
        async function loadMenuItems() {
            try {
                const response = await apiCall('getMenuItems');
                if (response.success) {
                    menuItems = response.data;
                    displayMenuItems();
                }
            } catch (error) {
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏°‡∏ô‡∏π‡πÑ‡∏î‡πâ', 'error');
            }
        }

        function displayMenuItems() {
            const menuGrid = document.getElementById('menu-grid');
            menuGrid.innerHTML = '';

            menuItems.forEach(item => {
                const cost = getCostForMenuItem(item.id);
                const profit = item.price - cost;
                const profitMargin = (profit / item.price) * 100;

                const menuItem = document.createElement('button');
                menuItem.className = 'menu-item';
                menuItem.innerHTML = `
                    <div class="cost-badge">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô ${formatCurrency(cost)}‡∏ø</div>
                    <div class="profit-badge">${Math.round(profitMargin)}%</div>
                    <h3>${item.name}</h3>
                    <div class="price">${formatCurrency(item.price)} ‡∏ö‡∏≤‡∏ó</div>
                    <small style="color: rgba(255,255,255,0.8);">‡∏Å‡∏≥‡πÑ‡∏£ ${formatCurrency(profit)}‡∏ø</small>
                `;
                menuItem.onclick = () => addToCart(item);
                menuGrid.appendChild(menuItem);
            });
        }

        function addToCart(item) {
            const existingItem = currentCart.find(cartItem => cartItem.id === item.id);

            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                currentCart.push({
                    ...item,
                    quantity: 1
                });
            }

            updateCartDisplay();

            // Haptic feedback on mobile
            if (navigator.vibrate) {
                navigator.vibrate(50);
            }
        }

        function updateCartDisplay() {
            const cartItems = document.getElementById('cart-items');
            const cartTotal = document.getElementById('cart-total');
            const totalCostEl = document.getElementById('total-cost');
            const totalProfitEl = document.getElementById('total-profit');
            const checkoutBtn = document.getElementById('checkout-btn');
            const checkoutProfit = document.getElementById('checkout-profit');

            cartItems.innerHTML = '';

            if (currentCart.length === 0) {
                cartItems.innerHTML = '<div style="text-align: center; color: #666; padding: 20px;">‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á</div>';
                cartTotal.textContent = '0 ‡∏ö‡∏≤‡∏ó';
                totalCostEl.textContent = '0 ‡∏ö‡∏≤‡∏ó';
                totalProfitEl.textContent = '0 ‡∏ö‡∏≤‡∏ó';
                checkoutBtn.disabled = true;
                updateCostInfoPanel();
                return;
            }

            const costProfit = calculateCartCostProfit();

            currentCart.forEach((item, index) => {
                const itemTotal = item.price * item.quantity;
                const itemCost = getCostForMenuItem(item.id) * item.quantity;
                const itemProfit = itemTotal - itemCost;

                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                cartItem.innerHTML = `
                    <div class="cart-item-info">
                        <div class="cart-item-name">${item.name}</div>
                        <div class="cart-item-price">
                            ${formatCurrency(item.price)} x ${item.quantity} = ${formatCurrency(itemTotal)} ‡∏ö‡∏≤‡∏ó
                            <br><small style="color: #43e97b;">‡∏Å‡∏≥‡πÑ‡∏£: ${formatCurrency(itemProfit)} ‡∏ö‡∏≤‡∏ó</small>
                        </div>
                    </div>
                    <div class="quantity-controls">
                        <button class="qty-btn" onclick="changeQuantity(${index}, -1)">-</button>
                        <span class="quantity">${item.quantity}</span>
                        <button class="qty-btn" onclick="changeQuantity(${index}, 1)">+</button>
                    </div>
                `;
                cartItems.appendChild(cartItem);
            });

            cartTotal.textContent = `${formatCurrency(costProfit.totalSales)} ‡∏ö‡∏≤‡∏ó`;
            totalCostEl.textContent = `${formatCurrency(costProfit.totalCost)} ‡∏ö‡∏≤‡∏ó`;
            totalProfitEl.textContent = `${formatCurrency(costProfit.totalProfit)} ‡∏ö‡∏≤‡∏ó`;

            // Update profit row styling
            const profitRow = document.querySelector('.profit-row');
            if (costProfit.totalProfit < 0) {
                profitRow.classList.add('negative');
            } else {
                profitRow.classList.remove('negative');
            }

            checkoutProfit.textContent = `(+${formatCurrency(costProfit.totalProfit)})`;
            checkoutBtn.disabled = false;

            updateCostInfoPanel();
        }

        function changeQuantity(index, change) {
            const item = currentCart[index];
            item.quantity += change;

            if (item.quantity <= 0) {
                currentCart.splice(index, 1);
            }

            updateCartDisplay();
        }

        async function checkout() {
            if (currentCart.length === 0) {
                showMessage('‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á', 'error');
                return;
            }

            const checkoutBtn = document.getElementById('checkout-btn');
            checkoutBtn.disabled = true;
            checkoutBtn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...';

            try {
                const total = currentCart.reduce((sum, item) => sum + (item.price * item.quantity), 0);

                const response = await apiCall('processSale', {
                    items: currentCart,
                    total: total
                });

                if (response.success) {
                    showMessage('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
                    currentCart = [];
                    updateCartDisplay();
                    refreshDashboard();

                    // Haptic feedback
                    if (navigator.vibrate) {
                        navigator.vibrate([100, 50, 100]);
                    }
                } else {
                    throw new Error(response.error);
                }
            } catch (error) {
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ: ' + error.message, 'error');
            } finally {
                checkoutBtn.disabled = false;
                checkoutBtn.textContent = '‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô';
            }
        }

        // Inventory functions
        async function loadInventoryAlerts() {
            try {
                const response = await apiCall('getInventoryAlerts');
                if (response.success) {
                    inventoryAlerts = response.data;
                    displayInventoryAlerts();
                }
            } catch (error) {
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÑ‡∏î‡πâ', 'error');
            }
        }

        function displayInventoryAlerts() {
            const alertsList = document.getElementById('inventory-alerts-list');
            alertsList.innerHTML = '';
            const alertsArray = Array.isArray(inventoryAlerts.alerts) ? inventoryAlerts.alerts : (Array.isArray(inventoryAlerts) ? inventoryAlerts : []);
            if (alertsArray.length === 0) {
                alertsList.innerHTML = '<div class="alert alert-info">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô ‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏õ‡∏Å‡∏ï‡∏¥</div>';
                return;
            }

            alertsArray.forEach(alert => {
                const alertDiv = document.createElement('div');
                alertDiv.className = `alert alert-${alert.severity}`;
                alertDiv.textContent = alert.message;
                alertsList.appendChild(alertDiv);
            });
        }

        // Business management functions for solo shop owner

        function showQuickExpenseModal() {
            document.getElementById('quick-expense-modal').style.display = 'flex';
        }
        window.showQuickExpenseModal = showQuickExpenseModal; // Immediate exposure

        function closeQuickExpenseModal() {
            document.getElementById('quick-expense-modal').style.display = 'none';
            document.getElementById('quick-expense-form').reset();
            // Clear receipt preview
            removeReceipt();
        }

        // Receipt upload handling
        function handleReceiptUpload(input) {
            const file = input.files[0];
            if (file) {
                // Validate file size (max 5MB)
                if (file.size > 5 * 1024 * 1024) {
                    showMessage('‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 5MB)', 'error');
                    input.value = '';
                    return;
                }

                // Validate file type
                const allowedTypes = ['image/jpeg', 'image/png', 'image/jpg', 'application/pdf'];
                if (!allowedTypes.includes(file.type)) {
                    showMessage('‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÑ‡∏ü‡∏•‡πå JPG, PNG, PDF ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô', 'error');
                    input.value = '';
                    return;
                }

                // Show preview
                const reader = new FileReader();
                reader.onload = function(e) {
                    const uploadDisplay = document.querySelector('.upload-display');
                    const previewDiv = document.getElementById('receipt-preview');
                    const previewImage = document.getElementById('receipt-image');
                    const filenameSpan = document.getElementById('receipt-filename');

                    uploadDisplay.style.display = 'none';
                    previewDiv.style.display = 'flex';

                    if (file.type === 'application/pdf') {
                        previewImage.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTcgMThoMTBhMSAxIDAgMCAxIDEgMXYxYTEgMSAwIDAgMS0xIDFIN2ExIDEgMCAwIDEtMS0xdi0xYTEgMSAwIDAgMSAxLTFaIiBmaWxsPSIjZmY0NzU3Ii8+CjxwYXRoIGQ9Ik03IDE0aDE0YTEgMSAwIDAgMSAxIDF2MWExIDEgMCAwIDEtMSAxSDdhMSAxIDAgMCAxLTEtMXYtMWExIDEgMCAwIDEgMS0xWiIgZmlsbD0iI2ZmNDc1NyIvPgo8cGF0aCBkPSJNNyAxMGgxNmExIDEgMCAwIDEgMSAxdjFhMSAxIDAgMCAxLTEgMUg3YTEgMSAwIDAgMS0xLTF2LTFhMSAxIDAgMCAxIDEtMVoiIGZpbGw9IiNmZjQ3NTciLz4KPC9zdmc+';
                        previewImage.alt = 'PDF file';
                    } else {
                        previewImage.src = e.target.result;
                        previewImage.alt = 'Receipt preview';
                    }

                    filenameSpan.textContent = file.name;
                };
                reader.readAsDataURL(file);
            }
        }

        function removeReceipt() {
            const uploadDisplay = document.querySelector('.upload-display');
            const previewDiv = document.getElementById('receipt-preview');
            const fileInput = document.getElementById('receipt-file');

            uploadDisplay.style.display = 'block';
            previewDiv.style.display = 'none';
            fileInput.value = '';
        }

        } // End of initializePOSSystem function

        // Quick expense form handler function
        function initializeQuickExpenseForm() {
            const expenseForm = document.getElementById('quick-expense-form');
            if (expenseForm) {
                expenseForm.addEventListener('submit', async function(e) {
                e.preventDefault();

                const fileInput = document.getElementById('receipt-file');
                const file = fileInput.files[0];

                const formData = {
                    store: document.getElementById('store-select').value,
                    items: document.getElementById('expense-items').value,
                    amount: parseFloat(document.getElementById('expense-amount').value),
                    type: document.getElementById('expense-type').value,
                    notes: document.getElementById('expense-notes').value || '',
                    date: new Date().toISOString().split('T')[0],
                    hasReceipt: file ? true : false,
                    receiptFilename: file ? file.name : '',
                    receiptStatus: file ? '‡∏°‡∏µ‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à' : '‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à'
                };

                // Handle file upload for receipt storage
                if (file) {
                    try {
                        // Create a complete file upload system using modern browser APIs
                        const reader = new FileReader();

                        await new Promise((resolve, reject) => {
                            reader.onload = async (e) => {
                                try {
                                    // Create a local storage-based file system for receipts
                                    const fileData = {
                                        id: 'EXP_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
                                        name: file.name,
                                        type: file.type,
                                        size: file.size,
                                        data: e.target.result,
                                        uploadDate: new Date().toISOString(),
                                        expenseId: Date.now()
                                    };

                                    // Store in localStorage for offline capability
                                    const existingFiles = JSON.parse(localStorage.getItem('receiptFiles') || '[]');
                                    existingFiles.push(fileData);
                                    localStorage.setItem('receiptFiles', JSON.stringify(existingFiles));

                                    // Create accessible URL for the receipt
                                    formData.receiptUrl = `#receipt/${fileData.id}`;
                                    formData.receiptId = fileData.id;
                                    formData.receiptName = file.name;

                                    resolve();
                                } catch (error) {
                                    reject(error);
                                }
                            };
                            reader.onerror = reject;
                            reader.readAsDataURL(file);
                        });

                    } catch (error) {
                        console.error('File upload error:', error);
                        showMessage('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå', 'error');
                        return;
                    }
                }

                try {
                    const response = await apiCall('addExpense', formData);
                    if (response.success) {
                        showMessage('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
                        closeQuickExpenseModal();
                        refreshDashboard();
                    } else {
                        throw new Error(response.error);
                    }
                } catch (error) {
                    showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡πÑ‡∏î‡πâ: ' + error.message, 'error');
                }
            });
            }
        }

        async function showCostAnalysis() {
            try {
                const response = await apiCall('calculateCostAnalysis');
                if (response.success) {
                    displayCostAnalysisModal(response.analysis);
                } else {
                    throw new Error(response.error);
                }
            } catch (error) {
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡πÑ‡∏î‡πâ', 'error');
            }
        }
        window.showCostAnalysis = showCostAnalysis; // Immediate exposure

        function displayCostAnalysisModal(analysisData) {
            const modal = document.getElementById('cost-analysis-modal');
            const content = document.getElementById('cost-analysis-content');

            content.innerHTML = '';

            analysisData.forEach(item => {
                const costItem = document.createElement('div');
                costItem.className = 'cost-item';

                const profitClass = item[8] < 30 ? 'low' : item[8] < 50 ? 'medium' : 'high';

                costItem.innerHTML = `
                    <div class="cost-item-info">
                        <h4>${item[2]}</h4>
                        <p>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢: ${formatCurrency(item[3])} ‡∏ö‡∏≤‡∏ó | ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô: ${formatCurrency(item[6])} ‡∏ö‡∏≤‡∏ó</p>
                    </div>
                    <div class="cost-item-values">
                        <div class="cost">‡∏Å‡∏≥‡πÑ‡∏£: ${formatCurrency(item[7])} ‡∏ö‡∏≤‡∏ó</div>
                        <div class="profit ${profitClass}">${item[8]}% ‡∏Å‡∏≥‡πÑ‡∏£</div>
                    </div>
                `;
                content.appendChild(costItem);
            });

            modal.style.display = 'flex';
        }

        function closeCostAnalysisModal() {
            document.getElementById('cost-analysis-modal').style.display = 'none';
        }

        async function calculateDailyProfit() {
            try {
                const today = new Date().toISOString().split('T')[0];
                const salesResponse = await apiCall('getSalesReport', { date: today });
                const expenseResponse = await apiCall('getExpenseSummary', {
                    startDate: today,
                    endDate: today
                });

                if (salesResponse.success && expenseResponse.success) {
                    const totalSales = salesResponse.data.totalSales || 0;
                    const totalExpenses = expenseResponse.data.totalExpenses || 0;
                    const netProfit = totalSales - totalExpenses;

                    const message = `‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ:\n` +
                                  `‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢: ${formatCurrency(totalSales)} ‡∏ö‡∏≤‡∏ó\n` +
                                  `‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢: ${formatCurrency(totalExpenses)} ‡∏ö‡∏≤‡∏ó\n` +
                                  `‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥: ${formatCurrency(netProfit)} ‡∏ö‡∏≤‡∏ó`;

                    alert(message);
                } else {
                    throw new Error('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Å‡∏≥‡πÑ‡∏£‡πÑ‡∏î‡πâ');
                }
            } catch (error) {
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Å‡∏≥‡πÑ‡∏£‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ', 'error');
            }
        }
        window.calculateDailyProfit = calculateDailyProfit; // Immediate exposure

        async function showPriceRecommendations() {
            try {
                const response = await apiCall('calculateCostAnalysis');
                if (response.success) {
                    const recommendations = response.analysis
                        .filter(item => item[8] < 40) // Less than 40% profit margin
                        .map(item => `${item[2]}: ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ ${item[9]}`)
                        .join('\n');

                    if (recommendations) {
                        alert('‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏Ñ‡∏≤:\n\n' + recommendations);
                    } else {
                        alert('‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏∏‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡πÅ‡∏•‡πâ‡∏ß! üëç');
                    }
                } else {
                    throw new Error(response.error);
                }
            } catch (error) {
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏£‡∏≤‡∏Ñ‡∏≤‡πÑ‡∏î‡πâ', 'error');
            }
        }
        window.showPriceRecommendations = showPriceRecommendations; // Immediate exposure

        function addDailyOperation() {
            const today = new Date().toISOString().split('T')[0];
            const targetSales = prompt('‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ (‡∏ö‡∏≤‡∏ó):');

            if (targetSales) {
                apiCall('addDailyOperation', {
                    date: today,
                    openTime: new Date().toTimeString().split(' ')[0],
                    targetSales: parseFloat(targetSales)
                }).then(response => {
                    if (response.success) {
                        showMessage('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
                        refreshDashboard();
                    }
                }).catch(error => {
                    showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏î‡πâ', 'error');
                });
            }
        }
        window.addDailyOperation = addDailyOperation; // Immediate exposure

        async function generateReorderReport() {
            try {
                const response = await apiCall('generateReorderReport');
                if (response.success) {
                    const report = response.data;
                    let message = `‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠:\n`;
                    message += `‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠: ${report.summary.totalItems} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£\n`;
                    message += `‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢: ${formatCurrency(report.summary.estimatedCost)} ‡∏ö‡∏≤‡∏ó`;

                    alert(message);
                } else {
                    throw new Error(response.error);
                }
            } catch (error) {
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ', 'error');
            }
        }
        window.generateReorderReport = generateReorderReport; // Immediate exposure

        function refreshInventory() {
            console.log('üì¶ Refreshing inventory...');

            // Load mock inventory data if available
            if (typeof mockDB !== 'undefined' && mockDB) {
                const mockIngredients = mockDB.getMockData('ingredients');
                if (mockIngredients.length > 0) {
                    console.log('üé≠ Using mock inventory data:', mockIngredients.length, 'ingredients');
                    window.inventoryData = mockIngredients;

                    // Update inventory display
                    displayInventoryList();
                    updateInventorySummary();
                    checkLowStockAlerts();

                    // Load alerts
                    loadInventoryAlerts();
                    return;
                }
            }

            // Fallback to original function
            loadInventoryAlerts();
        }

        // New screen functions
        async function refreshSalesReport() {
            try {
                const response = await apiCall('getSalesReport');
                if (response.success) {
                    const data = response.data;
                    document.getElementById('sales-today').textContent = formatCurrency(data.todaySales || 0);
                    document.getElementById('sales-week').textContent = formatCurrency(data.weekSales || 0);
                    document.getElementById('sales-month').textContent = formatCurrency(data.monthSales || 0);
                    document.getElementById('avg-daily').textContent = formatCurrency(data.avgDaily || 0);

                    const recentSales = document.getElementById('recent-sales');
                    recentSales.innerHTML = '';
                    (data.recentSales || []).forEach(sale => {
                        const saleDiv = document.createElement('div');
                        saleDiv.className = 'list-item';
                        saleDiv.innerHTML = `
                            <div class="list-item-info">
                                <div class="list-item-title">${sale.date || '‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ'}</div>
                                <div class="list-item-subtitle">${sale.items || '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢'} - ${formatCurrency(sale.total || 0)} ‡∏ö‡∏≤‡∏ó</div>
                            </div>
                        `;
                        recentSales.appendChild(saleDiv);
                    });
                }
            } catch (error) {
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ', 'error');
            }
        }

        async function loadExpensesScreen() {
            try {
                const response = await apiCall('getRecentExpenses', { limit: 20 });
                if (response.success) {
                    const expenses = response.data;
                    const recentExpenses = document.getElementById('recent-expenses');
                    recentExpenses.innerHTML = '';

                    expenses.forEach(expense => {
                        const expenseDiv = document.createElement('div');
                        expenseDiv.className = 'list-item';
                        expenseDiv.innerHTML = `
                            <div class="list-item-info">
                                <div class="list-item-title">${expense.store || '‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤'}</div>
                                <div class="list-item-subtitle">${expense.items || '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£'} - ${formatCurrency(expense.amount || 0)} ‡∏ö‡∏≤‡∏ó</div>
                            </div>
                        `;
                        recentExpenses.appendChild(expenseDiv);
                    });
                }
            } catch (error) {
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡πÑ‡∏î‡πâ', 'error');
            }
        }

        function generateAllReports() {
            showMessage('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î...', 'info');
            Promise.all([
                showCostAnalysis(),
                generateReorderReport(),
                showPriceRecommendations()
            ]).then(() => {
                showMessage('‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô!', 'success');
            }).catch(() => {
                showMessage('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô', 'error');
            });
        }

        function changeTheme(theme) {
            // Complete theme changing functionality
            const body = document.body;

            // Remove existing theme classes
            body.classList.remove('theme-light', 'theme-dark', 'theme-modern', 'theme-classic');

            // Apply new theme
            body.classList.add(`theme-${theme}`);

            // Apply theme-specific styles
            const themeStyles = {
                'light': {
                    '--primary-color': '#2563eb',
                    '--bg-primary': '#ffffff',
                    '--text-primary': '#1f2937',
                    '--bg-secondary': '#f8fafc'
                },
                'dark': {
                    '--primary-color': '#3b82f6',
                    '--bg-primary': '#1f2937',
                    '--text-primary': '#f9fafb',
                    '--bg-secondary': '#374151'
                },
                'modern': {
                    '--primary-color': '#8b5cf6',
                    '--bg-primary': '#ffffff',
                    '--text-primary': '#1f2937',
                    '--bg-secondary': '#f0f4ff'
                },
                'classic': {
                    '--primary-color': '#dc2626',
                    '--bg-primary': '#fffbeb',
                    '--text-primary': '#451a03',
                    '--bg-secondary': '#fef3c7'
                }
            };

            // Apply CSS custom properties
            if (themeStyles[theme]) {
                Object.entries(themeStyles[theme]).forEach(([property, value]) => {
                    document.documentElement.style.setProperty(property, value);
                });
            }

            // Save theme preference
            localStorage.setItem('selectedTheme', theme);

            showMessage(`‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ò‡∏µ‡∏°‡πÄ‡∏õ‡πá‡∏ô ${theme} ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß! üé®`, 'success');
        }

        function saveSettings() {
            const shopName = document.getElementById('shop-name').value;
            const stockThreshold = document.getElementById('stock-threshold').value;
            const theme = document.getElementById('theme-selector').value;

            // Save to localStorage for now
            localStorage.setItem('shopSettings', JSON.stringify({
                shopName,
                stockThreshold: parseInt(stockThreshold),
                theme,
                lastUpdated: new Date().toISOString()
            }));

            showMessage('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
        }

        function resetSettings() {
            document.getElementById('shop-name').value = 'ü•™ ‡∏£‡πâ‡∏≤‡∏ô Sandwich ‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏°';
            document.getElementById('stock-threshold').value = '5';
            document.getElementById('theme-selector').value = 'purple';
            localStorage.removeItem('shopSettings');
            showMessage('‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡πâ‡∏ß', 'info');
        }

        function loadSettings() {
            const saved = localStorage.getItem('shopSettings');
            if (saved) {
                try {
                    const settings = JSON.parse(saved);
                    document.getElementById('shop-name').value = settings.shopName || 'ü•™ ‡∏£‡πâ‡∏≤‡∏ô Sandwich ‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏°';
                    document.getElementById('stock-threshold').value = settings.stockThreshold || 5;
                    document.getElementById('theme-selector').value = settings.theme || 'purple';
                } catch (e) {
                    console.warn('Failed to load settings:', e);
                }
            }
        }

        function refreshInventory() {
            loadInventoryAlerts();
        }

        function toggleMenu() {
            const panel = document.getElementById('utility-menu');
            if (!panel) return;
            const isOpen = panel.style.right === '0px';
            panel.style.right = isOpen ? '-260px' : '0px';
            panel.setAttribute('aria-hidden', isOpen ? 'true' : 'false');
        }
    window.toggleMenu = toggleMenu;

        function showAlerts() {
            // Show inventory alerts and other system alerts
            loadInventoryAlerts();
            showMessage('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î', 'info');
        }
        window.showAlerts = showAlerts; // Immediate exposure

        function closeCostAnalysisModal() {
            document.getElementById('cost-analysis-modal').style.display = 'none';
        }

        // Database and app initialization function
        function initializeDatabaseAndApp() {
            // Initialize database connection first
            if (initializeDatabase()) {
                console.log('‚úÖ Database ready, loading application data');

                // Load initial data
                refreshDashboard();
                loadMenuItems();

                // Initialize charts after a short delay to ensure DOM is ready
                setTimeout(initializeCharts, 500);
            } else {
                console.error('‚ùå Database initialization failed');
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå', 'warning');

                // Still initialize UI components even if database fails
                setTimeout(initializeCharts, 500);
            }

            // Initialize filters with default date range (last 7 days)
            initializeFilters();

            // Prevent zoom on double tap
            let lastTouchEnd = 0;
            document.addEventListener('touchend', function (event) {
                const now = (new Date()).getTime();
                if (now - lastTouchEnd <= 300) {
                    event.preventDefault();
                }
                lastTouchEnd = now;
            }, false);

            // Auto refresh dashboard every 5 minutes
            setInterval(refreshDashboard, 300000);

            // Show welcome notification
            setTimeout(() => {
                showToast('üéâ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö!', '‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏ã‡∏ô‡∏î‡πå‡∏ß‡∏¥‡∏ä‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡∏°‡∏µ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà: ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á, ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞, ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', 'success', 8000);
            }, 2000);

            console.log('ü•™ ‡∏£‡πâ‡∏≤‡∏ô Sandwich ‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏° App initialized with enhanced analytics');
        }

        // Mock Data Management Functions
        window.loadMockData = function() {
            if (typeof mockDB !== 'undefined' && mockDB) {
                console.log('üé≠ Loading fresh mock data...');

                // Generate new mock data
                mockDB.generateAllMockData();
                const mockData = mockDB.loadMockDataIntoApp();

                // Update status display
                const statusEl = document.getElementById('mock-status');
                const statsEl = document.getElementById('mock-stats');

                if (statusEl) statusEl.textContent = '‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‚úÖ';

                if (statsEl) {
                    const analytics = mockDB.getAnalytics();
                    statsEl.innerHTML = `
                        üìä ‡πÄ‡∏°‡∏ô‡∏π: ${mockData.menuItems.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ |
                        ü•´ ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö: ${mockData.ingredients.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ |
                        üí∞ ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢: ‡∏ø${analytics.totalSales.toLocaleString()} |
                        üì¶ ‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏ï‡πà‡∏≥: ${analytics.lowStockItems.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
                    `;
                }

                // Refresh all screens
                refreshDashboard();
                refreshInventory();
                loadMenuItems();

                showToast('üé≠ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡∏•‡∏≠‡∏á', '‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö', 'success', 5000);
            } else {
                showMessage('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡∏•‡∏≠‡∏á', 'error');
            }
        };

        window.clearMockData = function() {
            console.log('üóëÔ∏è Clearing mock data...');

            // Clear localStorage
            localStorage.removeItem('mockDatabase');
            localStorage.removeItem('mockDataLoaded');
            localStorage.removeItem('mockDataVersion');

            // Reset global data
            if (typeof window.inventoryData !== 'undefined') {
                window.inventoryData = [];
            }
            if (typeof window.menuData !== 'undefined') {
                window.menuData = {};
            }

            // Update status display
            const statusEl = document.getElementById('mock-status');
            const statsEl = document.getElementById('mock-stats');

            if (statusEl) statusEl.textContent = '‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß üóëÔ∏è';
            if (statsEl) statsEl.innerHTML = '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏ñ‡∏π‡∏Å‡∏•‡πâ‡∏≤‡∏á‡∏≠‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß';

            showToast('üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', '‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡∏•‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß', 'info', 3000);
        };

        // Update mock data status on settings screen load
        setTimeout(() => {
            if (localStorage.getItem('mockDataLoaded') === 'true') {
                    const statusEl = document.getElementById('mock-status');
                    const statsEl = document.getElementById('mock-stats');

                    if (statusEl) statusEl.textContent = '‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ‚úÖ';

                    if (statsEl && typeof mockDB !== 'undefined') {
                        const analytics = mockDB.getAnalytics();
                        statsEl.innerHTML = `
                            üìä ‡πÄ‡∏°‡∏ô‡∏π: ${analytics.topProducts ? analytics.topProducts.length : 0}+ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ |
                            üí∞ ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢: ‡∏ø${analytics.totalSales ? analytics.totalSales.toLocaleString() : '0'} |
                            üì¶ ‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏ï‡πà‡∏≥: ${analytics.lowStockItems ? analytics.lowStockItems.length : 0} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
                        `;
                    }
                }
        }, 1500);

        // Expose functions globally (Apps Script sometimes isolates scope)
        Object.assign(window, {
            switchScreen,
            refreshDashboard,
            showPriceRecommendations,
            addDailyOperation,
            generateReorderReport,
            calculateDailyProfit,
            toggleMenu,
            checkout,
            changeQuantity,
            showQuickExpenseModal,
            closeQuickExpenseModal,
            removeReceipt,
                showCostAnalysis,
                closeCostAnalysisModal,
                refreshInventory,
                refreshSalesReport,
                loadExpensesScreen,
                generateAllReports,
                changeTheme,
                saveSettings,
                resetSettings,
            loadSettings,
            showAlerts,
            applyFilters,
            resetFilters,
            generateFilteredReport,
            toggleNotificationCenter,
            showToast
        });

        // Additional direct window assignments for critical functions
        // Note: switchScreen is already defined as window.switchScreen function above
        window.showQuickExpenseModal = showQuickExpenseModal;
        window.showCostAnalysis = showCostAnalysis;
        window.calculateDailyProfit = calculateDailyProfit;
        window.generateReorderReport = generateReorderReport;
        window.showPriceRecommendations = showPriceRecommendations;
        window.toggleMenu = toggleMenu;
        window.refreshDashboard = refreshDashboard;
        window.checkout = checkout;
        window.showAlerts = showAlerts;

        // Settings Screen Functions
        function switchSettingsCategory(category) {
            // Remove active class from all tabs
            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Add active class to clicked tab
            document.querySelector(`[data-category="${category}"]`).classList.add('active');

            // Hide all settings content
            document.querySelectorAll('.settings-content').forEach(content => {
                content.style.display = 'none';
            });

            // Show selected category content
            const targetContent = document.getElementById(`${category}-settings`);
            if (targetContent) {
                targetContent.style.display = 'block';
            }
        }

        function saveAllSettings() {
            const settings = {
                business: {
                    name: document.getElementById('business-name')?.value || '',
                    type: document.getElementById('business-type')?.value || 'restaurant',
                    address: document.getElementById('business-address')?.value || '',
                    phone: document.getElementById('business-phone')?.value || '',
                    email: document.getElementById('business-email')?.value || '',
                    taxId: document.getElementById('business-tax-id')?.value || '',
                    hours: document.getElementById('business-hours')?.value || ''
                },
                pos: {
                    currency: document.getElementById('pos-currency')?.value || 'THB',
                    taxRate: document.getElementById('pos-tax-rate')?.value || 7,
                    serviceCharge: document.getElementById('pos-service-charge')?.value || 0,
                    autoDiscount: document.getElementById('pos-auto-discount')?.value || 0,
                    receiptFooter: document.getElementById('pos-receipt-footer')?.value || '',
                    soundEnabled: document.getElementById('pos-sound-enabled')?.checked || false,
                    printAuto: document.getElementById('pos-print-auto')?.checked || false,
                    cashDrawer: document.getElementById('pos-cash-drawer')?.checked || false
                },
                system: {
                    theme: document.getElementById('system-theme')?.value || 'light',
                    language: document.getElementById('system-language')?.value || 'th',
                    dateFormat: document.getElementById('system-date-format')?.value || 'dd/mm/yyyy',
                    numberFormat: document.getElementById('system-number-format')?.value || 'thai',
                    backupEnabled: document.getElementById('backup-enabled')?.checked || false,
                    backupFrequency: document.getElementById('backup-frequency')?.value || 'daily',
                    backupRetention: document.getElementById('backup-retention')?.value || '30'
                }
            };

            localStorage.setItem('posSettings', JSON.stringify(settings));
            showToast('‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤', '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß', 'success', 3000);
        }

        function exportSettings() {
            const settings = localStorage.getItem('posSettings') || '{}';
            const blob = new Blob([settings], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `pos-settings-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            showToast('üì• ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å', '‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß', 'success', 3000);
        }

        function exportAllData() {
            const data = {
                menuItems: JSON.parse(localStorage.getItem('menuItems') || '[]'),
                inventory: JSON.parse(localStorage.getItem('inventory') || '[]'),
                sales: JSON.parse(localStorage.getItem('sales') || '[]'),
                expenses: JSON.parse(localStorage.getItem('expenses') || '[]'),
                settings: JSON.parse(localStorage.getItem('posSettings') || '{}')
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `pos-data-backup-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            showToast('üì• ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å', '‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß', 'success', 3000);
        }

        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const data = JSON.parse(e.target.result);

                            if (data.menuItems) localStorage.setItem('menuItems', JSON.stringify(data.menuItems));
                            if (data.inventory) localStorage.setItem('inventory', JSON.stringify(data.inventory));
                            if (data.sales) localStorage.setItem('sales', JSON.stringify(data.sales));
                            if (data.expenses) localStorage.setItem('expenses', JSON.stringify(data.expenses));
                            if (data.settings) localStorage.setItem('posSettings', JSON.stringify(data.settings));

                            showToast('üì§ ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤', '‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß', 'success', 3000);
                            setTimeout(() => location.reload(), 1500);
                        } catch (error) {
                            showToast('‚ùå ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á', 'error', 3000);
                        }
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }

        // Update data statistics in settings
        function updateDataStats() {
            const menuItems = JSON.parse(localStorage.getItem('menuItems') || '[]');
            const inventory = JSON.parse(localStorage.getItem('inventory') || '[]');
            const sales = JSON.parse(localStorage.getItem('sales') || '[]');
            const expenses = JSON.parse(localStorage.getItem('expenses') || '[]');

            const menuCountEl = document.getElementById('menu-count');
            const ingredientsCountEl = document.getElementById('ingredients-count');
            const salesTotalEl = document.getElementById('sales-total');
            const expensesTotalEl = document.getElementById('expenses-total');

            if (menuCountEl) menuCountEl.textContent = `${menuItems.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`;
            if (ingredientsCountEl) ingredientsCountEl.textContent = `${inventory.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`;

            const totalSales = sales.reduce((sum, sale) => sum + (sale.total || 0), 0);
            const totalExpenses = expenses.reduce((sum, expense) => sum + (expense.amount || 0), 0);

            if (salesTotalEl) salesTotalEl.textContent = `‡∏ø${totalSales.toLocaleString()}`;
            if (expensesTotalEl) expensesTotalEl.textContent = `‡∏ø${totalExpenses.toLocaleString()}`;
        }

        // Expose settings functions globally
        Object.assign(window, {
            switchSettingsCategory,
            saveAllSettings,
            exportSettings,
            exportAllData,
            importData,
            updateDataStats,
            initializePOSSystem,
            initializeQuickExpenseForm,
            initializeDatabaseAndApp
        });

        // Consolidated single DOMContentLoaded event listener
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Starting POS System Initialization...');

            // Run all initialization functions in proper order
            initializePOSSystem();
            initializeQuickExpenseForm();
            initializeDatabaseAndApp();

            // Initialize settings screen data
            if (document.getElementById('data-stats')) {
                updateDataStats();
            }

            // Fix any broken icons after initialization
            setTimeout(() => {
                fixBrokenIcons();
                monitorIconHealth(); // Start monitoring for dynamic content
            }, 1000);

            console.log('‚úÖ POS System fully initialized!');
        });
    </script>
</body>
</html>
